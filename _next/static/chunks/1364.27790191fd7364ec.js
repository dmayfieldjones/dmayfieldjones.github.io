"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1364],{81364:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n.L$});var n=a(79742)},79742:(e,t,a)=>{a.d(t,{L$:()=>h,qe:()=>E});var n=a(12115),i=a(47204),o=a(55089),r=a(93929),l=a(78443),s=a(37725),c=a(67072),d=a(2848),m=a(79201),p=a(17386);let f=(0,a(97771).makeStyles)()({block:{display:"block"}});function w({checked:e,disabled:t,label:a,onChange:i}){let{classes:o}=f();return n.createElement(m.A,{disabled:t,className:o.block,control:n.createElement(p.A,{checked:e,onChange:i}),label:a})}var v=a(31448),u=a(54262);function g({feature:e,assembly:t}){var a;let n=null===(a=e.get("ALT"))||void 0===a?void 0:a[0],i=n?(0,v.h)(n):void 0,o=e.get("start"),r=e.get("refName"),l=e=>t.getCanonicalRefName(e)||e;if("<TRA>"===n){let t=e.get("INFO");return{pos:o,refName:l(r),mateRefName:l(t.CHR2[0]),matePos:t.END[0]-1}}if(null==i?void 0:i.MatePosition){let e=i.MatePosition.split(":");return{pos:o,refName:l(r),mateRefName:l(e[0]),matePos:+e[1]-1}}if(!e.get("mate"))return{pos:o,refName:l(r),mateRefName:l(r),matePos:e.get("end")};{let t=e.get("mate");return{pos:o,refName:l(r),mateRefName:l(t.refName),matePos:t.start}}}async function k({stableViewId:e,feature:t,assemblyName:a,session:n,tracks:i,windowSize:o=0}){var r;let{snap:l,coverage:s}=function({feature:e,session:t,assemblyName:a}){let{assemblyManager:n}=t,i=n.get(a);if(!i)throw Error(`assembly ${a} not found`);if(!i.regions)throw Error(`assembly ${a} regions not loaded`);let o=g({feature:e,assembly:i}),{refName:r,mateRefName:l}=o,s=i.regions.find(e=>e.refName===r),c=i.regions.find(e=>e.refName===l);return{coverage:o,snap:{type:"BreakpointSplitView",views:[{type:"LinearGenomeView",displayedRegions:(0,u.gatherOverlaps)([{...s,assemblyName:a},{...c,assemblyName:a}])}],displayName:`${e.get("name")||e.get("id")||"breakend"} split detail`}}}({feature:t,assemblyName:a,session:n}),{refName:c,pos:m,mateRefName:p,matePos:f}=s,w=n.views.find(t=>t.id===e);w?(null===(r=w.views[0])||void 0===r||r.setDisplayedRegions(l.views[0].displayedRegions),w.setDisplayName(l.displayName)):w=n.addView("BreakpointSplitView",{...l,views:[{...l.views[0],tracks:i?(0,d.getSnapshot)(i).map(({id:e,displays:t,...a})=>({...a,displays:t.map(({id:e,...t})=>t)})):[]}]});let v=w.views[0];await (0,u.when)(()=>v.initialized);let k=v.bpToPx({coord:Math.max(0,m-o),refName:c}),y=v.bpToPx({coord:f+o,refName:p});k&&y?v.moveTo({...k,offset:k.offsetPx},{...y,offset:y.offsetPx}):(0,u.getSession)(v).notify("Unable to navigate to breakpoint")}function y(e){return e.map(({id:e,displays:t,...a})=>({...a,displays:t.map(({id:e,...t})=>t)}))}let h=(0,c.observer)(function({session:e,handleClose:t,feature:a,assemblyName:c,stableViewId:m,view:p}){let[f,v]=(0,n.useState)(!0),[u,k]=(0,n.useState)(!0);return n.createElement(i.Dialog,{open:!0,onClose:t,title:"Multi-level breakpoint split view options"},n.createElement(o.A,null,n.createElement("div",null,"Launch multi-level breakpoint split view"),p?n.createElement(n.Fragment,null,n.createElement(w,{checked:f,label:"Copy tracks into the new view",onChange:e=>{v(e.target.checked)}}),f?n.createElement(w,{checked:u,disabled:!f,label:"Mirror the copied tracks (only available if copying tracks and using two level)",onChange:e=>{k(e.target.checked)}}):null):null),n.createElement(r.A,null,n.createElement(l.A,{onClick:()=>{(async()=>{try{let{assemblyManager:t}=e,n=await t.waitForAssembly(c);if(!n)throw Error(`assembly ${c} not found`);let{refName:i,pos:o,mateRefName:r,matePos:l}=g({feature:a,assembly:n}),f=p?(0,d.getSnapshot)(p.tracks):[],w=e.views.find(e=>e.id===m),v=`${a.get("name")||a.get("id")||"breakend"} split detail`;w||(w=e.addView("BreakpointSplitView",{id:m,type:"BreakpointSplitView",displayName:v,views:[{type:"LinearGenomeView",hideHeader:!0,tracks:y(f)},{type:"LinearGenomeView",hideHeader:!0,tracks:y(u?[...f].reverse():f)}]})),w.setDisplayName(v);let k=n.regions.find(e=>e.refName===i),h=n.regions.find(e=>e.refName===r);if(!k||!h)throw Error("can't find regions");await Promise.all([w.views[0].navToLocations([{refName:i,start:k.start,end:o,assemblyName:c},{refName:i,start:o+1,end:k.end,assemblyName:c}]),w.views[1].navToLocations([{refName:r,start:h.start,end:l,assemblyName:c},{refName:r,start:l+1,end:h.end,assemblyName:c}])]),await (0,s.when)(()=>w.views[1].initialized&&w.views[0].initialized),w.views[1].zoomTo(10),w.views[0].zoomTo(10),w.views[1].centerAt(l,r),w.views[0].centerAt(o,i)}catch(t){console.error(t),e.notifyError(`${t}`,t)}})(),t()},variant:"contained",color:"primary",autoFocus:!0},"OK"),n.createElement(l.A,{color:"secondary",variant:"contained",onClick:()=>{t()}},"Cancel")))});var b=a(19293);let E=(0,c.observer)(function({session:e,handleClose:t,feature:a,stableViewId:s,assemblyName:c,view:d}){let[m,p]=(0,n.useState)(!0),[f,v]=(0,u.useLocalStorage)("breakpointWindowSize","5000");return n.createElement(i.Dialog,{open:!0,onClose:t,title:"Single-level breakpoint split view options"},n.createElement(o.A,null,d?n.createElement(w,{checked:m,label:"Copy tracks into the new view",onChange:e=>{p(e.target.checked)}}):null,n.createElement(b.A,{label:"Window size (bp)",value:f,onChange:e=>{v(e.target.value)}})),n.createElement(r.A,null,n.createElement(l.A,{onClick:()=>{(async()=>{try{let{assemblyManager:t}=e;if(!await t.waitForAssembly(c))throw Error(`assembly ${c} not found`);await k({feature:a,assemblyName:c,session:e,stableViewId:s,tracks:null==d?void 0:d.tracks,windowSize:+f||0})}catch(t){console.error(t),e.notifyError(`${t}`,t)}})(),t()},variant:"contained",color:"primary",autoFocus:!0},"OK"),n.createElement(l.A,{color:"secondary",variant:"contained",onClick:()=>{t()}},"Cancel")))})}}]);
//# sourceMappingURL=1364.27790191fd7364ec.js.map