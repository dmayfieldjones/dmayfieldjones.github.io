"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2201],{22201:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h});var n=a(91682),s=a(53394),i=a(92766),r=a(31177),l=a(80587),d=a(72471),o=a(61550),f=a(93818),c=a(89476);class h extends i.BaseFeatureDataAdapter{constructor(e,t,a){super(e,t,a);let i=(0,s.readConfObject)(e,"gffGzLocation"),l=(0,s.readConfObject)(e,["index","indexType"]),d=(0,s.readConfObject)(e,["index","location"]),o=(0,s.readConfObject)(e,"dontRedispatch");this.dontRedispatch=o||["chromosome","contig","region"],this.gff=new n.wD({filehandle:(0,r.openLocation)(i,this.pluginManager),csiFilehandle:"CSI"===l?(0,r.openLocation)(d,this.pluginManager):void 0,tbiFilehandle:"CSI"!==l?(0,r.openLocation)(d,this.pluginManager):void 0,chunkCacheSize:0x3200000,renameRefSeqs:e=>e})}async getRefNames(e={}){return this.gff.getReferenceSequenceNames(e)}async getHeader(){return this.gff.getHeader()}getFeatures(e,t={}){return(0,d.ObservableCreate)(async a=>{let n=await this.gff.getMetadata();await this.getFeaturesHelper(e,t,n,a,!0)},t.stopToken)}async getFeaturesHelper(e,t,a,n,s,i=e){var r,d;try{let h=[];if(await this.gff.getLines(e.refName,e.start,e.end,(e,t)=>{h.push(this.parseLine(a.columnNumbers,e,t))}),s&&h.length){let s=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;for(let e of h){let t=e.fields[2];if(!this.dontRedispatch.includes(t)){let t=e.start-1;t<s&&(s=t),e.end>i&&(i=e.end)}}if(i>e.end||s<e.start){await this.getFeaturesHelper({...e,start:s,end:i},t,a,n,!1,e);return}}let u=h.map(e=>(e.fields[8]&&"."!==e.fields[8]?e.fields[8].includes("_lineHash")||(e.fields[8]+=`;_lineHash=${e.lineHash}`):e.fields[8]=`_lineHash=${e.lineHash}`,e.fields.join("	"))).join("\n");for(let e of(0,f.g)(u))for(let t of e){let e=new o.default({data:(0,c.d)(t),id:`${this.id}-offset-${null===(d=null===(r=t.attributes)||void 0===r?void 0:r._lineHash)||void 0===d?void 0:d[0]}`});(0,l.doesIntersect2)(e.get("start"),e.get("end"),i.start,i.end)&&n.next(e)}n.complete()}catch(e){n.error(e)}}parseLine(e,t,a){let n=t.split("	");return{start:+n[e.start-1],end:+n[e.end-1],lineHash:a,fields:n}}freeResources(){}}}}]);
//# sourceMappingURL=2201.a747c8baa1304b5c.js.map