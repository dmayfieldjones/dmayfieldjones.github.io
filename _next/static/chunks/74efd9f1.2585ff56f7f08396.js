"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[633],{51539:(e,t,r)=>{r.r(t),r.d(t,{addDisposer:()=>Q,addMiddleware:()=>eE,applyAction:()=>ej,applyPatch:()=>A,applySnapshot:()=>N,cast:()=>er,castFlowReturn:()=>tS,castToReferenceSnapshot:()=>ei,castToSnapshot:()=>en,clone:()=>Z,createActionTrackingMiddleware:()=>em,createActionTrackingMiddleware2:()=>eP,decorate:()=>eN,destroy:()=>K,detach:()=>B,escapeJsonPath:()=>tT,flow:()=>t_,getChildType:()=>j,getEnv:()=>X,getIdentifier:()=>$,getLivelinessChecking:()=>b,getMembers:()=>et,getNodeId:()=>ea,getParent:()=>x,getParentOfType:()=>z,getPath:()=>F,getPathParts:()=>M,getPropertyMembers:()=>ee,getRelativePath:()=>J,getRoot:()=>R,getRunningActionContext:()=>eD,getSnapshot:()=>V,getType:()=>O,hasParent:()=>D,hasParentOfType:()=>k,isActionContextChildOf:()=>ek,isActionContextThisOrChildOf:()=>ez,isAlive:()=>q,isArrayType:()=>tU,isFrozenType:()=>ry,isIdentifierType:()=>rC,isLateType:()=>rf,isLiteralType:()=>t9,isMapType:()=>tR,isModelType:()=>tZ,isOptionalType:()=>ru,isPrimitiveType:()=>t6,isProtected:()=>E,isReferenceType:()=>rj,isRefinementType:()=>re,isRoot:()=>H,isStateTreeNode:()=>eZ,isType:()=>ey,isUnionType:()=>rn,isValidReference:()=>G,joinJsonPath:()=>tE,onAction:()=>eS,onPatch:()=>_,onSnapshot:()=>S,process:()=>e3,protect:()=>T,recordActions:()=>e_,recordPatches:()=>I,resolveIdentifier:()=>U,resolvePath:()=>L,setLivelinessChecking:()=>f,setLivelynessChecking:()=>d,splitJsonPath:()=>tN,t:()=>rV,toGenerator:()=>tI,toGeneratorFunction:()=>tA,tryReference:()=>W,tryResolve:()=>Y,typecheck:()=>e$,types:()=>rV,unescapeJsonPath:()=>tC,unprotect:()=>C,walk:()=>function e(t,r){eB(t,1),tw(r,2);var n=eK(t);n.getChildren().forEach(function(t){eZ(t.storedValue)&&e(t.storedValue,r)}),r(n.storedValue)}});var n,i,a,o,u,l,s=r(29543),c=r(49509),p="warn";function f(e){p=e}function b(){return p}function d(e){p=e}!function(e){e.afterCreate="afterCreate",e.afterAttach="afterAttach",e.afterCreationFinalization="afterCreationFinalization",e.beforeDetach="beforeDetach",e.beforeDestroy="beforeDestroy"}(n||(n={}));var h=function(e,t){return(h=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function y(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var v=function(){return(v=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function g(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){var l=[a,u];if(r)throw TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&l[0]?n.return:l[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,l[1])).done)return i;switch(n=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){o.label=l[1];break}if(6===l[0]&&o.label<i[1]){o.label=i[1],i=l;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(l);break}i[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],n=0}finally{r=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function P(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}function O(e){return eB(e,1),eK(e).type}function j(e,t){return eB(e,1),eK(e).getChildType(t)}function _(e,t){return eB(e,1),tw(t,2),eK(e).onPatch(t)}function S(e,t){return eB(e,1),tw(t,2),eK(e).onSnapshot(t)}function A(e,t){eB(e,1),tm(t,function(e){return"object"==typeof e},"object or array",2),eK(e).applyPatches(tn(t))}function I(e,t){eB(e,1);var r,n={patches:[],inversePatches:[]},i={},a={get recording(){return!!r},get patches(){return i.patches||(i.patches=n.patches.slice()),i.patches},get reversedInversePatches(){return i.reversedInversePatches||(i.reversedInversePatches=n.inversePatches.slice().reverse()),i.reversedInversePatches},get inversePatches(){return i.inversePatches||(i.inversePatches=n.inversePatches.slice()),i.inversePatches},stop:function(){r&&(r(),r=void 0)},resume:function(){r||(r=_(e,function(e,r){(!t||t(e,r,eD()))&&(n.patches.push(e),n.inversePatches.push(r),i.patches=void 0,i.inversePatches=void 0,i.reversedInversePatches=void 0)}))},replay:function(t){A(t||e,n.patches)},undo:function(t){A(t||e,n.inversePatches.slice().reverse())}};return a.resume(),a}function T(e){eB(e,1);var t=eK(e);if(!t.isRoot)throw e7("`protect` can only be invoked on root nodes");t.isProtectionEnabled=!0}function C(e){eB(e,1);var t=eK(e);if(!t.isRoot)throw e7("`unprotect` can only be invoked on root nodes");t.isProtectionEnabled=!1}function E(e){return eK(e).isProtected}function N(e,t){return eB(e,1),eK(e).applySnapshot(t)}function V(e,t){void 0===t&&(t=!0),eB(e,1);var r=eK(e);return t?r.snapshot:tu(r.type.getSnapshot(r,!1))}function D(e,t){void 0===t&&(t=1),eB(e,1),tP(t,2,0);for(var r=eK(e).parent;r;){if(0==--t)return!0;r=r.parent}return!1}function x(e,t){void 0===t&&(t=1),eB(e,1),tP(t,2,0);for(var r=t,n=eK(e).parent;n;){if(0==--r)return n.storedValue;n=n.parent}throw e7("Failed to find the parent of "+eK(e)+" at depth "+t)}function k(e,t){eB(e,1),ev(t,2);for(var r=eK(e).parent;r;){if(t.is(r.storedValue))return!0;r=r.parent}return!1}function z(e,t){eB(e,1),ev(t,2);for(var r=eK(e).parent;r;){if(t.is(r.storedValue))return r.storedValue;r=r.parent}throw e7("Failed to find the parent of "+eK(e)+" of a given type")}function R(e){return eB(e,1),eK(e).root.storedValue}function F(e){return eB(e,1),eK(e).path}function M(e){return eB(e,1),tN(eK(e).path)}function H(e){return eB(e,1),eK(e).isRoot}function L(e,t){eB(e,1),tO(t,2);var r=e1(eK(e),t);return r?r.value:void 0}function U(e,t,r){ev(e,1),eB(t,2),n=3,tm(r,rE,"string or number (identifier)",3);var n,i=eK(t).root.identifierCache.resolve(e,""+r);return null==i?void 0:i.value}function $(e){return eB(e,1),eK(e).identifier}function W(e,t){void 0===t&&(t=!0);try{var r=e();if(null==r)return;if(eZ(r))if(!t)return r;else return q(r)?r:void 0;throw e7("The reference to be checked is not one of node, null or undefined")}catch(e){if(e instanceof rg)return;throw e}}function G(e,t){void 0===t&&(t=!0);try{var r=e();if(null==r)return!1;if(eZ(r))return!t||q(r);throw e7("The reference to be checked is not one of node, null or undefined")}catch(e){if(e instanceof rg)return!1;throw e}}function Y(e,t){eB(e,1),tO(t,2);var r=e1(eK(e),t,!1);if(void 0!==r)try{return r.value}catch(e){return}}function J(e,t){return eB(e,1),eB(t,2),e0(eK(e),eK(t))}function Z(e,t){void 0===t&&(t=!0),eB(e,1);var r=eK(e);return r.type.create(r.snapshot,!0===t?r.root.environment:!1===t?void 0:t)}function B(e){return eB(e,1),eK(e).detach(),e}function K(e){eB(e,1);var t=eK(e);t.isRoot?t.die():t.parent.removeChild(t.subpath)}function q(e){return eB(e,1),eK(e).observableIsAlive}function Q(e,t){return eB(e,1),tw(t,2),eK(e).addDisposer(t),t}function X(e){eB(e,1);var t=eK(e).root.environment;return t||e8}function ee(e){var t;return tm(t=eZ(e)?O(e):e,function(e){return tZ(e)},"model type or model instance",1),{name:t.name,properties:v({},t.properties)}}function et(e){var t=eK(e).type,r=v(v({},ee(t)),{actions:[],volatile:[],views:[],flowActions:[]});return Object.getOwnPropertyNames(e).forEach(function(t){if(!(t in r.properties)){var n=Object.getOwnPropertyDescriptor(e,t);if(n.get)return void((0,s.isComputedProp)(e,t)?r.views.push(t):r.volatile.push(t));!0===n.value._isFlowAction&&r.flowActions.push(t),!0===n.value._isMSTAction?r.actions.push(t):(0,s.isObservableProp)(e,t)?r.volatile.push(t):r.views.push(t)}}),r}function er(e){return e}function en(e){return e}function ei(e){return e}function ea(e){return eB(e,1),eK(e).nodeId}var eo=function(){function e(e,t,r,n){Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"environment",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_escapedSubpath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_subpath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_subpathUponDeath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pathUponDeath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"storedValue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"aliveAtom",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_state",{enumerable:!0,configurable:!0,writable:!0,value:u.INITIALIZING}),Object.defineProperty(this,"_hookSubscribers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pathAtom",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.environment=n,this.baseSetParent(t,r)}return Object.defineProperty(e.prototype,"subpath",{get:function(){return this._subpath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subpathUponDeath",{get:function(){return this._subpathUponDeath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pathUponDeath",{get:function(){return this._pathUponDeath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.type.getValue(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){var t=this.isAlive;this._state=e;var r=this.isAlive;this.aliveAtom&&t!==r&&this.aliveAtom.reportChanged()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fireInternalHook",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this._hookSubscribers&&this._hookSubscribers.emit(e,this,e)}}),Object.defineProperty(e.prototype,"registerHook",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return this._hookSubscribers||(this._hookSubscribers=new tb),this._hookSubscribers.register(e,t)}}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"getReconciliationType",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.type}}),Object.defineProperty(e.prototype,"baseSetParent",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){this._parent=e,this._subpath=t,this._escapedSubpath=void 0,this.pathAtom&&this.pathAtom.reportChanged()}}),Object.defineProperty(e.prototype,"path",{get:function(){return this.getEscapedPath(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"getEscapedPath",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(e&&(this.pathAtom||(this.pathAtom=(0,s.createAtom)("path")),this.pathAtom.reportObserved()),this.parent)?(void 0===this._escapedSubpath&&(this._escapedSubpath=this._subpath?tT(this._subpath):""),this.parent.getEscapedPath(e)+"/"+this._escapedSubpath):""}}),Object.defineProperty(e.prototype,"isRoot",{get:function(){return null===this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAlive",{get:function(){return this.state!==u.DEAD},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDetaching",{get:function(){return this.state===u.DETACHING},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"observableIsAlive",{get:function(){return this.aliveAtom||(this.aliveAtom=(0,s.createAtom)("alive")),this.aliveAtom.reportObserved(),this.isAlive},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseFinalizeCreation",{enumerable:!1,configurable:!0,writable:!0,value:function(e){0;if(this.state===u.CREATED){if(this.parent){if(this.parent.state!==u.FINALIZED)return;this.fireHook(n.afterAttach)}this.state=u.FINALIZED,e&&e()}}}),Object.defineProperty(e.prototype,"baseFinalizeDeath",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._hookSubscribers&&this._hookSubscribers.clearAll(),this._subpathUponDeath=this._subpath,this._pathUponDeath=this.getEscapedPath(!1),this.baseSetParent(null,""),this.state=u.DEAD}}),Object.defineProperty(e.prototype,"baseAboutToDie",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.fireHook(n.beforeDestroy)}}),e}(),eu=function(e){function t(t,r,n,i,a){var o=e.call(this,t,r,n,i)||this;try{o.storedValue=t.createNewInstance(a)}catch(e){throw o.state=u.DEAD,e}return o.state=u.CREATED,o.finalizeCreation(),o}return y(t,e),Object.defineProperty(t.prototype,"root",{get:function(){if(!this.parent)throw e7("This scalar node is not part of a tree");return this.parent.root},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"setParent",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this.parent!==e,n=this.subpath!==t;if(r||n){0;this.environment=void 0,this.baseSetParent(this.parent,t)}}}),Object.defineProperty(t.prototype,"snapshot",{get:function(){return tu(this.getSnapshot())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.type.getSnapshot(this)}}),Object.defineProperty(t.prototype,"toString",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=(this.isAlive?this.path:this.pathUponDeath)||"<root>";return this.type.name+"@"+e+(this.isAlive?"":" [dead]")}}),Object.defineProperty(t.prototype,"die",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.isAlive&&this.state!==u.DETACHING&&(this.aboutToDie(),this.finalizeDeath())}}),Object.defineProperty(t.prototype,"finalizeCreation",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.baseFinalizeCreation()}}),Object.defineProperty(t.prototype,"aboutToDie",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.baseAboutToDie()}}),Object.defineProperty(t.prototype,"finalizeDeath",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.baseFinalizeDeath()}}),Object.defineProperty(t.prototype,"fireHook",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.fireInternalHook(e)}}),t}(eo);eu.prototype.die=(0,s.action)(eu.prototype.die);var el=1,es={onError:function(e){throw e}},ec=function(e){function t(t,r,n,i,a){var o=e.call(this,t,r,n,i)||this;if(Object.defineProperty(o,"nodeId",{enumerable:!0,configurable:!0,writable:!0,value:++el}),Object.defineProperty(o,"identifierAttribute",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"identifier",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"unnormalizedIdentifier",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"identifierCache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"isProtectionEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(o,"middlewares",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"hasSnapshotPostProcessor",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(o,"_applyPatches",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"_applySnapshot",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"_autoUnbox",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(o,"_isRunningAction",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(o,"_hasSnapshotReaction",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(o,"_observableInstanceState",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(o,"_childNodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"_initialSnapshot",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"_cachedInitialSnapshot",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"_cachedInitialSnapshotCreated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(o,"_snapshotComputed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"_snapshotUponDeath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"_internalEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),o._snapshotComputed=(0,s.computed)(function(){return tu(o.getSnapshot())}),o.unbox=o.unbox.bind(o),o._initialSnapshot=tu(a),o.identifierAttribute=t.identifierAttribute,r||(o.identifierCache=new eG),o._childNodes=t.initializeChildNodes(o,o._initialSnapshot),o.identifier=null,o.unnormalizedIdentifier=null,o.identifierAttribute&&o._initialSnapshot){var u=o._initialSnapshot[o.identifierAttribute];if(void 0===u){var l=o._childNodes[o.identifierAttribute];l&&(u=l.value)}if("string"!=typeof u&&"number"!=typeof u)throw e7("Instance identifier '"+o.identifierAttribute+"' for type '"+o.type.name+"' must be a string or a number");o.identifier=""+u,o.unnormalizedIdentifier=u}return r?r.root.identifierCache.addNodeToCache(o):o.identifierCache.addNodeToCache(o),o}return y(t,e),Object.defineProperty(t.prototype,"applyPatches",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.createObservableInstanceIfNeeded(),this._applyPatches(e)}}),Object.defineProperty(t.prototype,"applySnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.createObservableInstanceIfNeeded(),this._applySnapshot(e)}}),Object.defineProperty(t.prototype,"createObservableInstanceIfNeeded",{enumerable:!1,configurable:!0,writable:!0,value:function(e){void 0===e&&(e=!0),0===this._observableInstanceState&&this.createObservableInstance(e)}}),Object.defineProperty(t.prototype,"createObservableInstance",{enumerable:!1,configurable:!0,writable:!0,value:function(e){void 0===e&&(e=!0),0;this._observableInstanceState=1;for(var t,r,i,a,o=[],l=this.parent;l&&0===l._observableInstanceState;)o.unshift(l),l=l.parent;try{for(var s=m(o),c=s.next();!c.done;c=s.next()){var p=c.value;p.createObservableInstanceIfNeeded(!1)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}var f=this.type;try{this.storedValue=f.createNewInstance(this._childNodes),this.preboot(),this._isRunningAction=!0,f.finalizeNewInstance(this,this.storedValue)}catch(e){throw this.state=u.DEAD,e}finally{this._isRunningAction=!1}if(this._observableInstanceState=2,this._snapshotComputed.trackAndCompute(),this.isRoot&&this._addSnapshotReaction(),this._childNodes=e8,this.state=u.CREATED,e){this.fireHook(n.afterCreate),this.finalizeCreation();try{for(var b=m(o.reverse()),d=b.next();!d.done;d=b.next()){var p=d.value;p.fireHook(n.afterCreate),p.finalizeCreation()}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=b.return)&&a.call(b)}finally{if(i)throw i.error}}}}}),Object.defineProperty(t.prototype,"root",{get:function(){var e=this.parent;return e?e.root:this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clearParent",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.parent){this.fireHook(n.beforeDetach);var e=this.state;this.state=u.DETACHING;var t=this.root,r=t.environment,i=t.identifierCache.splitCache(this);try{this.parent.removeChild(this.subpath),this.baseSetParent(null,""),this.environment=r,this.identifierCache=i}finally{this.state=e}}}}),Object.defineProperty(t.prototype,"setParent",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=e!==this.parent,i=t!==this.subpath;if(r||i){0;r?(this.environment=void 0,e.root.identifierCache.mergeCache(this),this.baseSetParent(e,t),this.fireHook(n.afterAttach)):i&&this.baseSetParent(this.parent,t)}}}),Object.defineProperty(t.prototype,"fireHook",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;this.fireInternalHook(e);var r=this.storedValue&&"object"==typeof this.storedValue&&this.storedValue[e];"function"==typeof r&&(s._allowStateChangesInsideComputed?(0,s._allowStateChangesInsideComputed)(function(){r.apply(t.storedValue)}):r.apply(this.storedValue))}}),Object.defineProperty(t.prototype,"snapshot",{get:function(){return this.hasSnapshotPostProcessor&&this.createObservableInstanceIfNeeded(),this._snapshotComputed.get()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.isAlive?2===this._observableInstanceState?this._getActualSnapshot():this._getCachedInitialSnapshot():this._snapshotUponDeath}}),Object.defineProperty(t.prototype,"_getActualSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.type.getSnapshot(this)}}),Object.defineProperty(t.prototype,"_getCachedInitialSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(!this._cachedInitialSnapshotCreated){var e=this.type,t=this._childNodes,r=this._initialSnapshot;this._cachedInitialSnapshot=e.processInitialSnapshot(t,r),this._cachedInitialSnapshotCreated=!0}return this._cachedInitialSnapshot}}),Object.defineProperty(t.prototype,"isRunningAction",{enumerable:!1,configurable:!0,writable:!0,value:function(){return!!this._isRunningAction||!this.isRoot&&this.parent.isRunningAction()}}),Object.defineProperty(t.prototype,"assertAlive",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=p;if(!this.isAlive&&"ignore"!==t){var r=this._getAssertAliveError(e);switch(t){case"error":throw e7(r);case"warn":tv(r)}}}}),Object.defineProperty(t.prototype,"_getAssertAliveError",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.getEscapedPath(!1)||this.pathUponDeath||"",r=e.subpath&&tT(e.subpath)||"",n=e.actionContext||o;n&&"action"!==n.type&&n.parentActionEvent&&(n=n.parentActionEvent);var i="";return n&&null!=n.name&&(i=(n&&n.context&&F(n.context)||t)+"."+n.name+"()"),"You are trying to read or write to an object that is no longer part of a state tree. (Object type: '"+this.type.name+"', Path upon death: '"+t+"', Subpath: '"+r+"', Action: '"+i+"'). Either detach nodes first, or don't use objects after removing / replacing them in the tree."}}),Object.defineProperty(t.prototype,"getChildNode",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.assertAlive({subpath:e}),this._autoUnbox=!1;try{return 2===this._observableInstanceState?this.type.getChildNode(this,e):this._childNodes[e]}finally{this._autoUnbox=!0}}}),Object.defineProperty(t.prototype,"getChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.assertAlive(e8),this._autoUnbox=!1;try{return 2===this._observableInstanceState?this.type.getChildren(this):e4(this._childNodes)}finally{this._autoUnbox=!0}}}),Object.defineProperty(t.prototype,"getChildType",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.type.getChildType(e)}}),Object.defineProperty(t.prototype,"isProtected",{get:function(){return this.root.isProtectionEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"assertWritable",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(this.assertAlive(e),!this.isRunningAction()&&this.isProtected)throw e7("Cannot modify '"+this+"', the object is protected and can only be modified by using an action.")}}),Object.defineProperty(t.prototype,"removeChild",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.type.removeChild(this,e)}}),Object.defineProperty(t.prototype,"unbox",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e?(this.assertAlive({subpath:e.subpath||e.subpathUponDeath}),this._autoUnbox?e.value:e):e}}),Object.defineProperty(t.prototype,"toString",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=(this.isAlive?this.path:this.pathUponDeath)||"<root>",t=this.identifier?"(id: "+this.identifier+")":"";return this.type.name+"@"+e+t+(this.isAlive?"":" [dead]")}}),Object.defineProperty(t.prototype,"finalizeCreation",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;this.baseFinalizeCreation(function(){var t,r;try{for(var i=m(e.getChildren()),a=i.next();!a.done;a=i.next())a.value.finalizeCreation()}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.fireInternalHook(n.afterCreationFinalization)})}}),Object.defineProperty(t.prototype,"detach",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(!this.isAlive)throw e7("Error while detaching, node is not alive.");this.clearParent()}}),Object.defineProperty(t.prototype,"preboot",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;this._applyPatches=eC(this.storedValue,"@APPLY_PATCHES",function(t){t.forEach(function(t){if(!t.path)return void e.type.applySnapshot(e,t.value);var r=tN(t.path);e2(e,r.slice(0,-1)).applyPatchLocally(r[r.length-1],t)})}),this._applySnapshot=eC(this.storedValue,"@APPLY_SNAPSHOT",function(t){if(t!==e.snapshot)return e.type.applySnapshot(e,t)}),tp(this.storedValue,"$treenode",this),tp(this.storedValue,"toJSON",eQ)}}),Object.defineProperty(t.prototype,"die",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.isAlive&&this.state!==u.DETACHING&&(this.aboutToDie(),this.finalizeDeath())}}),Object.defineProperty(t.prototype,"aboutToDie",{enumerable:!1,configurable:!0,writable:!0,value:function(){0!==this._observableInstanceState&&(this.getChildren().forEach(function(e){e.aboutToDie()}),this.baseAboutToDie(),this._internalEventsEmit("dispose"),this._internalEventsClear("dispose"))}}),Object.defineProperty(t.prototype,"finalizeDeath",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.getChildren().forEach(function(e){e.finalizeDeath()}),this.root.identifierCache.notifyDied(this);var e=this.snapshot;this._snapshotUponDeath=e,this._internalEventsClearAll(),this.baseFinalizeDeath()}}),Object.defineProperty(t.prototype,"onSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._addSnapshotReaction(),this._internalEventsRegister("snapshot",e)}}),Object.defineProperty(t.prototype,"emitSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this._internalEventsEmit("snapshot",e)}}),Object.defineProperty(t.prototype,"onPatch",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._internalEventsRegister("patch",e)}}),Object.defineProperty(t.prototype,"emitPatch",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(this._internalEventsHasSubscribers("patch")){var r=w(function(e){if(!("oldValue"in e))throw e7("Patches without `oldValue` field cannot be inversed");return[function(e){switch(e.op){case"add":return{op:"add",path:e.path,value:e.value};case"remove":return{op:"remove",path:e.path};case"replace":return{op:"replace",path:e.path,value:e.value}}}(e),function(e){switch(e.op){case"add":return{op:"remove",path:e.path};case"remove":return{op:"add",path:e.path,value:e.oldValue};case"replace":return{op:"replace",path:e.path,value:e.oldValue}}}(e)]}(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++){var i=t[n];for(var a in i)e[a]=i[a]}return e}({},e,{path:t.path.substr(this.path.length)+"/"+e.path})),2),n=r[0],i=r[1];this._internalEventsEmit("patch",n,i)}this.parent&&this.parent.emitPatch(e,t)}}),Object.defineProperty(t.prototype,"hasDisposer",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._internalEventsHas("dispose",e)}}),Object.defineProperty(t.prototype,"addDisposer",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(!this.hasDisposer(e))return void this._internalEventsRegister("dispose",e,!0);throw e7("cannot add a disposer when it is already registered for execution")}}),Object.defineProperty(t.prototype,"removeDisposer",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(!this._internalEventsHas("dispose",e))throw e7("cannot remove a disposer which was never registered for execution");this._internalEventsUnregister("dispose",e)}}),Object.defineProperty(t.prototype,"removeMiddleware",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(this.middlewares){var t=this.middlewares.indexOf(e);t>=0&&this.middlewares.splice(t,1)}}}),Object.defineProperty(t.prototype,"addMiddleWare",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this;void 0===t&&(t=!0);var n={handler:e,includeHooks:t};return this.middlewares?this.middlewares.push(n):this.middlewares=[n],function(){r.removeMiddleware(n)}}}),Object.defineProperty(t.prototype,"applyPatchLocally",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){this.assertWritable({subpath:e}),this.createObservableInstanceIfNeeded(),this.type.applyPatchLocally(this,e,t)}}),Object.defineProperty(t.prototype,"_addSnapshotReaction",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;if(!this._hasSnapshotReaction){var t=(0,s.reaction)(function(){return e.snapshot},function(t){return e.emitSnapshot(t)},es);this.addDisposer(t),this._hasSnapshotReaction=!0}}}),Object.defineProperty(t.prototype,"_internalEventsHasSubscribers",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return!!this._internalEvents&&this._internalEvents.hasSubscribers(e)}}),Object.defineProperty(t.prototype,"_internalEventsRegister",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){return void 0===r&&(r=!1),this._internalEvents||(this._internalEvents=new tb),this._internalEvents.register(e,t,r)}}),Object.defineProperty(t.prototype,"_internalEventsHas",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return!!this._internalEvents&&this._internalEvents.has(e,t)}}),Object.defineProperty(t.prototype,"_internalEventsUnregister",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){this._internalEvents&&this._internalEvents.unregister(e,t)}}),Object.defineProperty(t.prototype,"_internalEventsEmit",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this._internalEvents&&(t=this._internalEvents).emit.apply(t,P([e],r))}}),Object.defineProperty(t.prototype,"_internalEventsClear",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this._internalEvents&&this._internalEvents.clear(e)}}),Object.defineProperty(t.prototype,"_internalEventsClearAll",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._internalEvents&&this._internalEvents.clearAll()}}),t}(eo);ec.prototype.createObservableInstance=(0,s.action)(ec.prototype.createObservableInstance),ec.prototype.detach=(0,s.action)(ec.prototype.detach),ec.prototype.die=(0,s.action)(ec.prototype.die),function(e){e[e.String=1]="String",e[e.Number=2]="Number",e[e.Boolean=4]="Boolean",e[e.Date=8]="Date",e[e.Literal=16]="Literal",e[e.Array=32]="Array",e[e.Map=64]="Map",e[e.Object=128]="Object",e[e.Frozen=256]="Frozen",e[e.Optional=512]="Optional",e[e.Reference=1024]="Reference",e[e.Identifier=2048]="Identifier",e[e.Late=4096]="Late",e[e.Refinement=8192]="Refinement",e[e.Union=16384]="Union",e[e.Null=32768]="Null",e[e.Undefined=65536]="Undefined",e[e.Integer=131072]="Integer",e[e.Custom=262144]="Custom",e[e.SnapshotProcessor=524288]="SnapshotProcessor",e[e.Lazy=1048576]="Lazy",e[e.Finite=2097152]="Finite",e[e.Float=4194304]="Float"}(a||(a={}));var ep="cannotDetermine",ef=Symbol("$type"),eb=function(){function e(e){Object.defineProperty(this,i,{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"C",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"S",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"T",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"N",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isType",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e}return Object.defineProperty(e.prototype,"create",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return eU(this,e),this.instantiate(null,"",t,e).value}}),Object.defineProperty(e.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){throw e7("unimplemented method")}}),Object.defineProperty(e.prototype,"isAssignableFrom",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e===this}}),Object.defineProperty(e.prototype,"validate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(eq(e)){var r=O(e);return this.isAssignableFrom(r)?e5:eH(t,e)}return this.isValidSnapshot(e,t)}}),Object.defineProperty(e.prototype,"is",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return 0===this.validate(e,[{path:"",type:this}]).length}}),Object.defineProperty(e.prototype,"Type",{get:function(){throw e7("Factory.Type should not be actually called. It is just a Type signature that can be used at compile time with Typescript, by using `typeof type.Type`")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"TypeWithoutSTN",{get:function(){throw e7("Factory.TypeWithoutSTN should not be actually called. It is just a Type signature that can be used at compile time with Typescript, by using `typeof type.TypeWithoutSTN`")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SnapshotType",{get:function(){throw e7("Factory.SnapshotType should not be actually called. It is just a Type signature that can be used at compile time with Typescript, by using `typeof type.SnapshotType`")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CreationType",{get:function(){throw e7("Factory.CreationType should not be actually called. It is just a Type signature that can be used at compile time with Typescript, by using `typeof type.CreationType`")},enumerable:!1,configurable:!0}),e}();i=ef,eb.prototype.create=(0,s.action)(eb.prototype.create);var ed=function(e){function t(t){var r=e.call(this,t)||this;return Object.defineProperty(r,"identifierAttribute",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r}return y(t,e),Object.defineProperty(t.prototype,"create",{enumerable:!1,configurable:!0,writable:!0,value:function(t,r){return void 0===t&&(t=this.getDefaultSnapshot()),e.prototype.create.call(this,t,r)}}),Object.defineProperty(t.prototype,"getValue",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e.createObservableInstanceIfNeeded(),e.storedValue}}),Object.defineProperty(t.prototype,"isMatchingSnapshotId",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return!e.identifierAttribute||e.identifier===""+t[e.identifierAttribute]}}),Object.defineProperty(t.prototype,"tryToReconcileNode",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return!e.isDetaching&&(!!(e.snapshot===t||eZ(t)&&eK(t)===e)||!!(e.type===this&&ta(t)&&!eZ(t)&&this.isMatchingSnapshotId(e,t))&&(e.applySnapshot(t),!0))}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){if(this.tryToReconcileNode(e,t))return e.setParent(r,n),e;if(e.die(),eZ(t)&&this.isAssignableFrom(O(t))){var i=eK(t);return i.setParent(r,n),i}return this.instantiate(r,n,void 0,t)}}),Object.defineProperty(t.prototype,"getSubTypes",{enumerable:!1,configurable:!0,writable:!0,value:function(){return null}}),t}(eb);ed.prototype.create=(0,s.action)(ed.prototype.create);var eh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),Object.defineProperty(t.prototype,"createNewInstance",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e}}),Object.defineProperty(t.prototype,"getValue",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e.storedValue}}),Object.defineProperty(t.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e.storedValue}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){if(!e.isDetaching&&e.type===this&&e.storedValue===t)return e;var i=this.instantiate(r,n,void 0,t);return e.die(),i}}),Object.defineProperty(t.prototype,"getSubTypes",{enumerable:!1,configurable:!0,writable:!0,value:function(){return null}}),t}(eb);function ey(e){return"object"==typeof e&&e&&!0===e.isType}function ev(e,t){tm(e,ey,"mobx-state-tree type",t)}var eg=new Map;function em(e){return function(t,r,n){switch(t.type){case"action":if(e.filter&&!0!==e.filter(t))return r(t);var i=e.onStart(t);e.onResume(t,i),eg.set(t.id,{call:t,context:i,async:!1});try{var a=r(t);return e.onSuspend(t,i),!1===eg.get(t.id).async&&(eg.delete(t.id),e.onSuccess(t,i,a)),a}catch(r){throw eg.delete(t.id),e.onFail(t,i,r),r}case"flow_spawn":var o=eg.get(t.rootId);return o.async=!0,r(t);case"flow_resume":case"flow_resume_error":var o=eg.get(t.rootId);e.onResume(t,o.context);try{return r(t)}finally{e.onSuspend(t,o.context)}case"flow_throw":var o=eg.get(t.rootId);return eg.delete(t.rootId),e.onFail(t,o.context,t.args[0]),r(t);case"flow_return":var o=eg.get(t.rootId);return eg.delete(t.rootId),e.onSuccess(t,o.context,t.args[0]),r(t)}}}var ew=function(){function e(e,t){Object.defineProperty(this,"hooks",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"call",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"flowsPending",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"running",{enumerable:!0,configurable:!0,writable:!0,value:!0}),e&&e.onStart(t)}return Object.defineProperty(e.prototype,"finish",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.running&&(this.running=!1,this.hooks&&this.hooks.onFinish(this.call,e))}}),Object.defineProperty(e.prototype,"incFlowsPending",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.flowsPending++}}),Object.defineProperty(e.prototype,"decFlowsPending",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.flowsPending--}}),Object.defineProperty(e.prototype,"hasFlowsPending",{get:function(){return this.flowsPending>0},enumerable:!1,configurable:!0}),e}();function eP(e){var t=new Map;return function(r,n){var i=r.parentActionEvent?t.get(r.parentActionEvent.id):void 0;if("action"===r.type){var a=v(v({},r),{env:i&&i.call.env,parentCall:i&&i.call}),o=new ew(!e.filter||e.filter(a)?e:void 0,a);t.set(r.id,o);var u=void 0;try{u=n(r)}catch(e){throw t.delete(r.id),o.finish(e),e}return o.hasFlowsPending||(t.delete(r.id),o.finish()),u}if(!i)return n(r);switch(r.type){case"flow_spawn":return i.incFlowsPending(),n(r);case"flow_resume":case"flow_resume_error":return n(r);case"flow_throw":var l=r.args[0];try{return n(r)}finally{i.decFlowsPending(),i.hasFlowsPending||(t.delete(r.parentActionEvent.id),i.finish(l))}case"flow_return":try{return n(r)}finally{i.decFlowsPending(),i.hasFlowsPending||(t.delete(r.parentActionEvent.id),i.finish())}}}}function eO(e){return{$MST_UNSERIALIZABLE:!0,type:e}}function ej(e,t){eB(e,1),tm(t,function(e){return"object"==typeof e},"object or array",2),(0,s.runInAction)(function(){tn(t).forEach(function(t){var r=e,n=t,i=Y(r,n.path||"");if(!i)throw e7("Invalid action path: "+(n.path||""));var a=eK(i);if("@APPLY_PATCHES"===n.name)return A.call(null,i,n.args[0]);if("@APPLY_SNAPSHOT"===n.name)return N.call(null,i,n.args[0]);if("function"!=typeof i[n.name])throw e7("Action '"+n.name+"' does not exist in '"+a.path+"'");return i[n.name].apply(i,n.args?n.args.map(function(e){return e&&"object"==typeof e&&"$MST_DATE"in e?new Date(e.$MST_DATE):e}):[])})})}function e_(e,t){eB(e,1);var r,n=[],i=function(e){(!t||t(e,eD()))&&n.push(e)},a={actions:n,get recording(){return!!r},stop:function(){r&&(r(),r=void 0)},resume:function(){r||(r=eS(e,i))},replay:function(e){ej(e,n)}};return a.resume(),a}function eS(e,t,r){return void 0===r&&(r=!1),eB(e,1),eE(e,function(n,i){if("action"!==n.type||n.id!==n.rootId)return i(n);var a=eK(n.context),o={name:n.name,path:e0(eK(e),a),args:n.args.map(function(e,t){if(n.name,e instanceof Date)return{$MST_DATE:e.getTime()};if(to(e))return e;if(eZ(e))return eO("[MSTNode: "+O(e).name+"]");if("function"==typeof e)return eO("[function]");if("object"==typeof e&&!ti(e)&&!tr(e))return eO("[object "+(e&&e.constructor&&e.constructor.name||"Complex Object")+"]");try{return JSON.stringify(e),e}catch(e){return eO(""+e)}})};if(!r)return t(o),i(n);var u=i(n);return t(o),u})}var eA=1;function eI(e,t){var r=eK(e.context);"action"===e.type&&r.assertAlive({actionContext:e});var i=r._isRunningAction;r._isRunningAction=!0;var a=o;o=e;try{var u=r,l=e,c=t,p=new eV(u,c);if(p.isEmpty)return(0,s.action)(c).apply(null,l.args);var f=null;return function e(t){var r=p.getNextMiddleware(),i=r&&r.handler;if(!i)return(0,s.action)(c).apply(null,t.args);if(!r.includeHooks&&n[t.name])return e(t);var a=!1,o=!1;if(i(t,function(t,r){a=!0,f=e(t),r&&(f=r(f))},function(e){o=!0,f=e}),function(){return!1}())if(a||o){if(a&&o){var u=eK(t.tree);throw e7("The next() and abort() callback within the middleware "+i.name+' for the action: "'+t.name+'" on the node: '+u.type.name+" were invoked.")}}else{var u=eK(t.tree);throw e7("Neither the next() nor the abort() callback within the middleware "+i.name+' for the action: "'+t.name+'" on the node: '+u.type.name+" was invoked.")}return f}(l)}finally{o=a,r._isRunningAction=i}}function eT(e){if(e)return"action"===e.type?e:e.parentActionEvent}function eC(e,t,r){var n=function(){var n=eA++,i=o,a=eT(i);return eI({type:"action",name:t,id:n,args:td(arguments),context:e,tree:R(e),rootId:i?i.rootId:n,parentId:i?i.id:0,allParentIds:i?P(i.allParentIds,[i.id]):[],parentEvent:i,parentActionEvent:a},r)};return n._isMSTAction=!0,n._isFlowAction=r._isFlowAction,n}function eE(e,t,r){void 0===r&&(r=!0);var n=eK(e);return n.addMiddleWare(t,r)}function eN(e,t,r){void 0===r&&(r=!0);var n={handler:e,includeHooks:r};return t.$mst_middleware=t.$mst_middleware||[],t.$mst_middleware.push(n),t}var eV=function(){function e(e,t){Object.defineProperty(this,"arrayIndex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"inArrayIndex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"middlewares",{enumerable:!0,configurable:!0,writable:!0,value:[]}),t.$mst_middleware&&this.middlewares.push(t.$mst_middleware);for(var r=e;r;)r.middlewares&&this.middlewares.push(r.middlewares),r=r.parent}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.middlewares.length<=0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"getNextMiddleware",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.middlewares[this.arrayIndex];if(e){var t=e[this.inArrayIndex++];return t||(this.arrayIndex++,this.inArrayIndex=0,this.getNextMiddleware())}}}),e}();function eD(){for(var e=o;e&&"action"!==e.type;)e=e.parentActionEvent;return e}function ex(e,t,r){for(var n="number"==typeof t?t:t.id,i=r?e:e.parentActionEvent;i;){if(i.id===n)return!0;i=i.parentActionEvent}return!1}function ek(e,t){return ex(e,t,!1)}function ez(e,t){return ex(e,t,!0)}function eR(e){return"function"==typeof e?"<function"+(e.name?" "+e.name:"")+">":eZ(e)?"<"+e+">":"`"+function(e){try{return JSON.stringify(e)}catch(e){return"<Unserializable: "+e+">"}}(e)+"`"}function eF(e){var t=e.value,r=e.context[e.context.length-1].type,n=e.context.map(function(e){return e.path}).filter(function(e){return e.length>0}).join("/"),i=n.length>0?'at path "/'+n+'" ':"",a=eZ(t)?"value of type "+eK(t).type.name+":":to(t)?"value":"snapshot",o=r&&eZ(t)&&r.is(eK(t).snapshot);return""+i+a+" "+eR(t)+" is not assignable "+(r?"to type: `"+r.name+"`":"")+(e.message?" ("+e.message+")":"")+(r?t6(r)||to(t)?".":", expected an instance of `"+r.name+"` or a snapshot like `"+r.describe()+"` instead."+(o?" (Note that a snapshot of the provided value is compatible with the targeted type)":""):".")}function eM(e,t,r){return e.concat([{path:t,type:r}])}function eH(e,t,r){return[{context:e,value:t,message:r}]}function eL(e){return e.reduce(function(e,t){return e.concat(t)},[])}function eU(e,t){((function(){return!1})()||void 0!==c&&c.env&&"true"===c.env.ENABLE_TYPE_CHECK)&&e$(e,t)}function e$(e,t){var r=e.validate(t,[{path:"",type:e}]);if(r.length>0)throw e7(function(e,t,r){if(0!==r.length){var n;return"Error while converting "+((n=eR(t)).length<280?n:n.substring(0,272)+"......"+n.substring(n.length-8))+" to `"+e.name+"`:\n\n    "+r.map(eF).join("\n    ")}}(e,t,r))}var eW=0,eG=function(){function e(){Object.defineProperty(this,"cacheId",{enumerable:!0,configurable:!0,writable:!0,value:eW++}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:s.observable.map()}),Object.defineProperty(this,"lastCacheModificationPerId",{enumerable:!0,configurable:!0,writable:!0,value:s.observable.map()})}return Object.defineProperty(e.prototype,"updateLastCacheModificationPerId",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.lastCacheModificationPerId.get(e);this.lastCacheModificationPerId.set(e,void 0===t?1:t+1)}}),Object.defineProperty(e.prototype,"getLastCacheModificationPerId",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.lastCacheModificationPerId.get(e)||0;return this.cacheId+"-"+t}}),Object.defineProperty(e.prototype,"addNodeToCache",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(void 0===t&&(t=!0),e.identifierAttribute){var r=e.identifier;this.cache.has(r)||this.cache.set(r,s.observable.array([],e9));var n=this.cache.get(r);if(-1!==n.indexOf(e))throw e7("Already registered");n.push(e),t&&this.updateLastCacheModificationPerId(r)}}}),Object.defineProperty(e.prototype,"mergeCache",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;(0,s.values)(e.identifierCache.cache).forEach(function(e){return e.forEach(function(e){t.addNodeToCache(e)})})}}),Object.defineProperty(e.prototype,"notifyDied",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(e.identifierAttribute){var t=e.identifier,r=this.cache.get(t);r&&(r.remove(e),r.length||this.cache.delete(t),this.updateLastCacheModificationPerId(e.identifier))}}}),Object.defineProperty(e.prototype,"splitCache",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var r=this,n=new e,i=t.path+"/";return(0,s.entries)(this.cache).forEach(function(e){for(var a=w(e,2),o=a[0],u=a[1],l=!1,s=u.length-1;s>=0;s--){var c=u[s];(c===t||0===c.path.indexOf(i))&&(n.addNodeToCache(c,!1),u.splice(s,1),u.length||r.cache.delete(o),l=!0)}l&&r.updateLastCacheModificationPerId(o)}),n}}),Object.defineProperty(e.prototype,"has",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this.cache.get(t);return!!r&&r.some(function(t){return e.isAssignableFrom(t.type)})}}),Object.defineProperty(e.prototype,"resolve",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this.cache.get(t);if(!r)return null;var n=r.filter(function(t){return e.isAssignableFrom(t.type)});switch(n.length){case 0:return null;case 1:return n[0];default:throw e7("Cannot resolve a reference to type '"+e.name+"' with id: '"+t+"' unambigously, there are multiple candidates: "+n.map(function(e){return e.path}).join(", "))}}}),e}();function eY(e,t,r,n,i){var a=eq(i);if(a){if(a.parent)throw e7("Cannot add an object to a state tree if it is already part of the same or another state tree. Tried to assign an object to '"+(t?t.path:"")+"/"+r+"', but it lives already at '"+a.path+"'");return t&&a.setParent(t,r),a}return new ec(e,t,r,n,i)}function eJ(e,t,r,n,i){return new eu(e,t,r,n,i)}function eZ(e){return!!(e&&e.$treenode)}function eB(e,t){tm(e,eZ,"mobx-state-tree node",t)}function eK(e){if(!eZ(e))throw e7("Value "+e+" is no MST Node");return e.$treenode}function eq(e){return e&&e.$treenode||null}function eQ(){return eK(this).snapshot}!function(e){e[e.INITIALIZING=0]="INITIALIZING",e[e.CREATED=1]="CREATED",e[e.FINALIZED=2]="FINALIZED",e[e.DETACHING=3]="DETACHING",e[e.DEAD=4]="DEAD"}(u||(u={}));var eX=function(e){return".."};function e0(e,t){if(e.root!==t.root)throw e7("Cannot calculate relative path: objects '"+e+"' and '"+t+"' are not part of the same object tree");for(var r=tN(e.path),n=tN(t.path),i=0;i<r.length&&r[i]===n[i];i++);return r.slice(i).map(eX).join("/")+tE(n.slice(i))}function e1(e,t,r){return void 0===r&&(r=!0),e2(e,tN(t),r)}function e2(e,t,r){void 0===r&&(r=!0);var n=e;try{for(var i=0;i<t.length;i++){var a=t[i];if(".."===a){if(n=n.parent)continue}else if("."===a)continue;else if(n){if(n instanceof eu){var o=n.value;eZ(o)&&(n=eK(o))}if(n instanceof ec&&n.getChildType(a)&&(n=n.getChildNode(a)))continue}throw e7("Could not resolve '"+a+"' in path '"+(tE(t.slice(0,i))||"/")+"' while resolving '"+tE(t)+"'")}}catch(e){if(!r)return;throw e}return n}function e4(e){if(!e)return e5;var t=Object.keys(e);if(!t.length)return e5;var r=Array(t.length);return t.forEach(function(t,n){r[n]=e[t]}),r}function e3(e){return ty("process","`process()` has been renamed to `flow()`. See https://github.com/mobxjs/mobx-state-tree/issues/399 for more information. Note that the middleware event types starting with `process` now start with `flow`."),t_(e)}var e6=Object.toString(),e5=Object.freeze([]),e8=Object.freeze({}),e9=(0,s._getGlobalState)().useProxies?{deep:!1}:{deep:!1,proxy:!1};function e7(e){return void 0===e&&(e="Illegal state"),Error("[mobx-state-tree] "+e)}function te(e){return e}Object.freeze(e9);var tt=Number.isInteger;function tr(e){return Array.isArray(e)||(0,s.isObservableArray)(e)}function tn(e){return e?tr(e)?e:[e]:e5}function ti(e){if(null===e||"object"!=typeof e)return!1;var t,r=Object.getPrototypeOf(e);return null==r||(null==(t=r.constructor)?void 0:t.toString())===e6}function ta(e){return null!==e&&"object"==typeof e&&!(e instanceof Date)&&!(e instanceof RegExp)}function to(e,t){return void 0===t&&(t=!0),null==e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||t&&e instanceof Date}function tu(e){return e}function tl(e){return e}function ts(e){return"function"!=typeof e}function tc(e,t,r){(0,s.isObservableObject)(e)?(0,s.defineProperty)(e,t,r):Object.defineProperty(e,t,r)}function tp(e,t,r){tc(e,t,{enumerable:!1,writable:!1,configurable:!0,value:r})}var tf=function(){function e(){Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]})}return Object.defineProperty(e.prototype,"hasSubscribers",{get:function(){return this.handlers.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this;return void 0===t&&(t=!1),t?this.handlers.unshift(e):this.handlers.push(e),function(){r.unregister(e)}}}),Object.defineProperty(e.prototype,"has",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.handlers.indexOf(e)>=0}}),Object.defineProperty(e.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.handlers.indexOf(e);t>=0&&this.handlers.splice(t,1)}}),Object.defineProperty(e.prototype,"clear",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.handlers.length=0}}),Object.defineProperty(e.prototype,"emit",{enumerable:!1,configurable:!0,writable:!0,value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.handlers.slice().forEach(function(t){return t.apply(void 0,P(e))})}}),e}(),tb=function(){function e(){Object.defineProperty(this,"eventHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}return Object.defineProperty(e.prototype,"hasSubscribers",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.eventHandlers&&this.eventHandlers[e];return!!t&&t.hasSubscribers}}),Object.defineProperty(e.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){void 0===r&&(r=!1),this.eventHandlers||(this.eventHandlers={});var n=this.eventHandlers[e];return n||(n=this.eventHandlers[e]=new tf),n.register(t,r)}}),Object.defineProperty(e.prototype,"has",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this.eventHandlers&&this.eventHandlers[e];return!!r&&r.has(t)}}),Object.defineProperty(e.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this.eventHandlers&&this.eventHandlers[e];r&&r.unregister(t)}}),Object.defineProperty(e.prototype,"clear",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.eventHandlers&&delete this.eventHandlers[e]}}),Object.defineProperty(e.prototype,"clearAll",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.eventHandlers=void 0}}),Object.defineProperty(e.prototype,"emit",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.eventHandlers&&this.eventHandlers[e];n&&n.emit.apply(n,P(t))}}),e}();function td(e){for(var t=Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}function th(e,t){return 0===e.indexOf(t)}var ty=function(e,t){};function tv(e){console.warn(Error("[mobx-state-tree] "+e))}function tg(){return!1}function tm(e,t,r,n){}function tw(e,t){tm(e,function(e){return"function"==typeof e},"function",t)}function tP(e,t,r,n){tm(e,function(e){return"number"==typeof e},"number",t),void 0!==r&&tm(e,function(e){return e>=r},"number greater than "+r,t),void 0!==n&&tm(e,function(e){return e<=n},"number lesser than "+n,t)}function tO(e,t,r){void 0===r&&(r=!0),tm(e,function(e){return"string"==typeof e},"string",t),r||tm(e,function(e){return""!==e},"not empty string",t)}function tj(e){"function"==typeof queueMicrotask?queueMicrotask(e):"function"==typeof setImmediate?setImmediate(e):setTimeout(e,1)}function t_(e){var t,r,n;return t=e.name,r=e,(n=function(){var e=eA++,i=o;if(!i)throw e7("a mst flow must always have a parent context");var a=eT(i);if(!a)throw e7("a mst flow must always have a parent action context");var u={name:t,id:e,tree:i.tree,context:i.context,parentId:i.id,allParentIds:P(i.allParentIds,[i.id]),rootId:i.rootId,parentEvent:i,parentActionEvent:a},l=arguments;function s(e,t,r){return e.$mst_middleware=n.$mst_middleware,eI(v(v({},u),{type:t,args:[r]}),e)}return new Promise(function(e,t){var i,a=function(){i=r.apply(null,arguments),o(void 0)};function o(e){var r;try{var n=s(function(e){r=i.next(e)},"flow_resume",e);n instanceof Error&&(r=i.throw(n))}catch(e){tj(function(){s(function(r){t(e)},"flow_throw",e)});return}p(r)}function c(e){var r;try{s(function(e){r=i.throw(e)},"flow_resume_error",e)}catch(e){tj(function(){s(function(r){t(e)},"flow_throw",e)});return}p(r)}function p(t){if(t.done)return void tj(function(){s(function(t){e(t)},"flow_return",t.value)});if(!t.value||"function"!=typeof t.value.then)throw e7("Only promises can be yielded to `async`, got: "+t);return t.value.then(o,c)}a.$mst_middleware=n.$mst_middleware,eI(v(v({},u),{type:"flow_spawn",args:td(l)}),a)})})._isFlowAction=!0,n}function tS(e){return e}function tA(e){return function(){var t,r=[];for(t=0;t<arguments.length;t++)r[t]=arguments[t];return g(this,function(t){switch(t.label){case 0:return[4,e.apply(void 0,P(r))];case 1:return[2,t.sent()]}})}}function tI(e){return g(this,function(t){switch(t.label){case 0:return[4,e];case 1:return[2,t.sent()]}})}function tT(e){return!0==("number"==typeof e)?""+e:-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function tC(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function tE(e){if(0===e.length)return"";var t=function(e){return e.map(tT).join("/")};return"."===e[0]||".."===e[0]?t(e):"/"+t(e)}function tN(e){var t=e.split("/").map(tC);if(!(""===e||"."===e||".."===e||th(e,"/")||th(e,"./")||th(e,"../")))throw e7("a json path must be either rooted, empty or relative, but got '"+e+"'");return""===t[0]&&t.shift(),t}ty.ids={};var tV=Symbol("$preProcessorFailed"),tD=function(e){function t(t,r,n){var i=e.call(this,n||t.name)||this;return Object.defineProperty(i,"_subtype",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(i,"_processors",{enumerable:!0,configurable:!0,writable:!0,value:r}),i}return y(t,e),Object.defineProperty(t.prototype,"flags",{get:function(){return this._subtype.flags|a.SnapshotProcessor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return"snapshotProcessor("+this._subtype.describe()+")"}}),Object.defineProperty(t.prototype,"preProcessSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._processors.preProcessor?this._processors.preProcessor.call(null,e):e}}),Object.defineProperty(t.prototype,"preProcessSnapshotSafe",{enumerable:!1,configurable:!0,writable:!0,value:function(e){try{return this.preProcessSnapshot(e)}catch(e){return tV}}}),Object.defineProperty(t.prototype,"postProcessSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return this._processors.postProcessor?this._processors.postProcessor.call(null,e,t.storedValue):e}}),Object.defineProperty(t.prototype,"_fixNode",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;(function(e,t){for(var r,n,i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];try{for(var o=m(i),u=o.next();!u.done;u=o.next()){var l=u.value;e[l]=t[l].bind(t)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}})(e.type,this,"create"),e instanceof ec&&(e.hasSnapshotPostProcessor=!!this._processors.postProcessor);var r=e.getSnapshot;e.getSnapshot=function(){return t.postProcessSnapshot(r.call(e),e)},rn(this._subtype)||(e.getReconciliationType=function(){return t})}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){var i=eZ(n)?n:this.preProcessSnapshot(n),a=this._subtype.instantiate(e,t,r,i);return this._fixNode(a),a}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){var i=this._subtype.reconcile(e,eZ(t)?t:this.preProcessSnapshot(t),r,n);return i!==e&&this._fixNode(i),i}}),Object.defineProperty(t.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){void 0===t&&(t=!0);var r=this._subtype.getSnapshot(e);return t?this.postProcessSnapshot(r,e):r}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this.preProcessSnapshotSafe(e);return r===tV?eH(t,e,"Failed to preprocess value"):this._subtype.validate(r,t)}}),Object.defineProperty(t.prototype,"getSubTypes",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._subtype}}),Object.defineProperty(t.prototype,"is",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=ey(e)?this._subtype:eZ(e)?V(e,!1):this.preProcessSnapshotSafe(e);return t!==tV&&0===this._subtype.validate(t,[{path:"",type:this._subtype}]).length}}),Object.defineProperty(t.prototype,"isAssignableFrom",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._subtype.isAssignableFrom(e)}}),Object.defineProperty(t.prototype,"isMatchingSnapshotId",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(!(this._subtype instanceof ed))return!1;var r=this.preProcessSnapshot(t);return this._subtype.isMatchingSnapshotId(e,r)}}),t}(eb),tx="Map.put can only be used to store complex values that have an identifier type attribute";!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.YES=1]="YES",e[e.NO=2]="NO"}(l||(l={}));var tk=function(e){function t(t,r){return e.call(this,t,s.observable.ref.enhancer,r)||this}return y(t,e),Object.defineProperty(t.prototype,"get",{enumerable:!1,configurable:!0,writable:!0,value:function(t){return e.prototype.get.call(this,""+t)}}),Object.defineProperty(t.prototype,"has",{enumerable:!1,configurable:!0,writable:!0,value:function(t){return e.prototype.has.call(this,""+t)}}),Object.defineProperty(t.prototype,"delete",{enumerable:!1,configurable:!0,writable:!0,value:function(t){return e.prototype.delete.call(this,""+t)}}),Object.defineProperty(t.prototype,"set",{enumerable:!1,configurable:!0,writable:!0,value:function(t,r){return e.prototype.set.call(this,""+t,r)}}),Object.defineProperty(t.prototype,"put",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(!e)throw e7("Map.put cannot be used to set empty values");if(eZ(e)){var t=eK(e);if(null===t.identifier)throw e7(tx);return this.set(t.identifier,e),e}if(ta(e)){var r=eK(this),n=r.type;if(n.identifierMode!==l.YES)throw e7(tx);var i=e[n.mapIdentifierAttribute];if(!rE(i)){var a=this.put(n.getChildType().create(e,r.environment));return this.put(V(a))}var o=""+i;return this.set(o,e),this.get(o)}throw e7("Map.put can only be used to store complex values")}}),t}(s.ObservableMap),tz=function(e){function t(t,r,n){void 0===n&&(n=[]);var i=e.call(this,t)||this;return Object.defineProperty(i,"_subType",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(i,"identifierMode",{enumerable:!0,configurable:!0,writable:!0,value:l.UNKNOWN}),Object.defineProperty(i,"mapIdentifierAttribute",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"flags",{enumerable:!0,configurable:!0,writable:!0,value:a.Map}),Object.defineProperty(i,"hookInitializers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),i._determineIdentifierMode(),i.hookInitializers=n,i}return y(t,e),Object.defineProperty(t.prototype,"hooks",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var r=this.hookInitializers.length>0?this.hookInitializers.concat(e):[e];return new t(this.name,this._subType,r)}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){return this._determineIdentifierMode(),eY(this,e,t,r,n)}}),Object.defineProperty(t.prototype,"_determineIdentifierMode",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.identifierMode===l.UNKNOWN){var e=[];if(function e(t,r){var n,i,a=t.getSubTypes();if(a===ep)return!1;if(a){var o=tn(a);try{for(var u=m(o),l=u.next();!l.done;l=u.next()){var s=l.value;if(!e(s,r))return!1}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}return t instanceof tJ&&r.push(t),!0}(this._subType,e)){var t=e.reduce(function(e,t){if(!t.identifierAttribute)return e;if(e&&e!==t.identifierAttribute)throw e7("The objects in a map should all have the same identifier attribute, expected '"+e+"', but child of type '"+t.name+"' declared attribute '"+t.identifierAttribute+"' as identifier");return t.identifierAttribute},void 0);t?(this.identifierMode=l.YES,this.mapIdentifierAttribute=t):this.identifierMode=l.NO}}}}),Object.defineProperty(t.prototype,"initializeChildNodes",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){void 0===t&&(t={});var r=e.type._subType,n={};return Object.keys(t).forEach(function(i){n[i]=r.instantiate(e,i,void 0,t[i])}),n}}),Object.defineProperty(t.prototype,"createNewInstance",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return new tk(e,this.name)}}),Object.defineProperty(t.prototype,"finalizeNewInstance",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){(0,s._interceptReads)(t,e.unbox),e.type.hookInitializers.forEach(function(e){var r=e(t);Object.keys(r).forEach(function(e){var n=r[e],i=eC(t,e,n);tp(t,e,i)})}),(0,s.intercept)(t,this.willChange),(0,s.observe)(t,this.didChange)}}),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.name}}),Object.defineProperty(t.prototype,"getChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,s.values)(e.storedValue)}}),Object.defineProperty(t.prototype,"getChildNode",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=e.storedValue.get(""+t);if(!r)throw e7("Not a child "+t);return r}}),Object.defineProperty(t.prototype,"willChange",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=eK(e.object),r=e.name;t.assertWritable({subpath:r});var n=t.type,i=n._subType;switch(e.type){case"update":var a=e.newValue;if(a===e.object.get(r))return null;eU(i,a),e.newValue=i.reconcile(t.getChildNode(r),e.newValue,t,r),n.processIdentifier(r,e.newValue);break;case"add":eU(i,e.newValue),e.newValue=i.instantiate(t,r,void 0,e.newValue),n.processIdentifier(r,e.newValue)}return e}}),Object.defineProperty(t.prototype,"processIdentifier",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(this.identifierMode===l.YES&&t instanceof ec){var r=t.identifier;if(r!==e)throw e7("A map of objects containing an identifier should always store the object under their own identifier. Trying to store key '"+r+"', but expected: '"+e+"'")}}}),Object.defineProperty(t.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t={};return e.getChildren().forEach(function(e){t[e.subpath]=e.snapshot}),t}}),Object.defineProperty(t.prototype,"processInitialSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t={};return Object.keys(e).forEach(function(r){t[r]=e[r].getSnapshot()}),t}}),Object.defineProperty(t.prototype,"didChange",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=eK(e.object);switch(e.type){case"update":return void t.emitPatch({op:"replace",path:tT(e.name),value:e.newValue.snapshot,oldValue:e.oldValue?e.oldValue.snapshot:void 0},t);case"add":return void t.emitPatch({op:"add",path:tT(e.name),value:e.newValue.snapshot,oldValue:void 0},t);case"delete":var r=e.oldValue.snapshot;return e.oldValue.die(),void t.emitPatch({op:"remove",path:tT(e.name),oldValue:r},t)}}}),Object.defineProperty(t.prototype,"applyPatchLocally",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){var n=e.storedValue;switch(r.op){case"add":case"replace":n.set(t,r.value);break;case"remove":n.delete(t)}}}),Object.defineProperty(t.prototype,"applySnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){eU(this,t);var r=e.storedValue,n={};if(Array.from(r.keys()).forEach(function(e){n[e]=!1}),t)for(var i in t)r.set(i,t[i]),n[""+i]=!0;Object.keys(n).forEach(function(e){!1===n[e]&&r.delete(e)})}}),Object.defineProperty(t.prototype,"getChildType",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._subType}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this;return ti(e)?eL(Object.keys(e).map(function(n){return r._subType.validate(e[n],eM(t,n,r._subType))})):eH(t,e,"Value is not a plain object")}}),Object.defineProperty(t.prototype,"getDefaultSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(){return e8}}),Object.defineProperty(t.prototype,"removeChild",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){e.storedValue.delete(t)}}),t}(ed);function tR(e){return ey(e)&&(e.flags&a.Map)>0}tz.prototype.applySnapshot=(0,s.action)(tz.prototype.applySnapshot);var tF=function(e){function t(t,r,n){void 0===n&&(n=[]);var i=e.call(this,t)||this;return Object.defineProperty(i,"_subType",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(i,"flags",{enumerable:!0,configurable:!0,writable:!0,value:a.Array}),Object.defineProperty(i,"hookInitializers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),i.hookInitializers=n,i}return y(t,e),Object.defineProperty(t.prototype,"hooks",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var r=this.hookInitializers.length>0?this.hookInitializers.concat(e):[e];return new t(this.name,this._subType,r)}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){return eY(this,e,t,r,n)}}),Object.defineProperty(t.prototype,"initializeChildNodes",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){void 0===t&&(t=[]);var r=e.type._subType,n={};return t.forEach(function(t,i){var a=""+i;n[a]=r.instantiate(e,a,void 0,t)}),n}}),Object.defineProperty(t.prototype,"createNewInstance",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=v(v({},e9),{name:this.name});return s.observable.array(e4(e),t)}}),Object.defineProperty(t.prototype,"finalizeNewInstance",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){(0,s._getAdministration)(t).dehancer=e.unbox,e.type.hookInitializers.forEach(function(e){var r=e(t);Object.keys(r).forEach(function(e){var n=r[e],i=eC(t,e,n);tp(t,e,i)})}),(0,s.intercept)(t,this.willChange),(0,s.observe)(t,this.didChange)}}),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.name}}),Object.defineProperty(t.prototype,"getChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e.storedValue.slice()}}),Object.defineProperty(t.prototype,"getChildNode",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=Number(t);if(r<e.storedValue.length)return e.storedValue[r];throw e7("Not a child: "+t)}}),Object.defineProperty(t.prototype,"willChange",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=eK(e.object);t.assertWritable({subpath:""+e.index});var r=t.type._subType,n=t.getChildren();switch(e.type){case"update":if(e.newValue===e.object[e.index])return null;var i=tM(t,r,[n[e.index]],[e.newValue],[e.index]);if(!i)return null;e.newValue=i[0];break;case"splice":var a=e.index,o=e.removedCount,u=e.added,l=tM(t,r,n.slice(a,a+o),u,u.map(function(e,t){return a+t}));if(!l)return null;e.added=l;for(var s=a+o;s<n.length;s++)n[s].setParent(t,""+(s+u.length-o))}return e}}),Object.defineProperty(t.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e.getChildren().map(function(e){return e.snapshot})}}),Object.defineProperty(t.prototype,"processInitialSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=[];return Object.keys(e).forEach(function(r){t.push(e[r].getSnapshot())}),t}}),Object.defineProperty(t.prototype,"didChange",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=eK(e.object);switch(e.type){case"update":return void t.emitPatch({op:"replace",path:""+e.index,value:e.newValue.snapshot,oldValue:e.oldValue?e.oldValue.snapshot:void 0},t);case"splice":for(var r=e.removedCount-1;r>=0;r--)t.emitPatch({op:"remove",path:""+(e.index+r),oldValue:e.removed[r].snapshot},t);for(var r=0;r<e.addedCount;r++)t.emitPatch({op:"add",path:""+(e.index+r),value:t.getChildNode(""+(e.index+r)).snapshot,oldValue:void 0},t);return}}}),Object.defineProperty(t.prototype,"applyPatchLocally",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){var n=e.storedValue,i="-"===t?n.length:Number(t);switch(r.op){case"replace":n[i]=r.value;break;case"add":n.splice(i,0,r.value);break;case"remove":n.splice(i,1)}}}),Object.defineProperty(t.prototype,"applySnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){eU(this,t),e.storedValue.replace(t)}}),Object.defineProperty(t.prototype,"getChildType",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._subType}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this;return tr(e)?eL(e.map(function(e,n){return r._subType.validate(e,eM(t,""+n,r._subType))})):eH(t,e,"Value is not an array")}}),Object.defineProperty(t.prototype,"getDefaultSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(){return e5}}),Object.defineProperty(t.prototype,"removeChild",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){e.storedValue.splice(Number(t),1)}}),t}(ed);function tM(e,t,r,n,i){for(var a=!0,o=0;;o++){var u,l=o<=n.length-1,s=r[o],c=l?n[o]:void 0,p=""+i[o];if(((u=c)instanceof eu||u instanceof ec)&&(c=c.storedValue),s||l)if(l)if(s)if(tL(s,c))r[o]=tH(t,e,p,c,s);else{for(var f=void 0,b=o;b<r.length;b++)if(tL(r[b],c)){f=r.splice(b,1)[0];break}a=!1;var d=tH(t,e,p,c,f);r.splice(o,0,d)}else{if(eZ(c)&&eK(c).parent===e)throw e7("Cannot add an object to a state tree if it is already part of the same or another state tree. Tried to assign an object to '"+e.path+"/"+p+"', but it lives already at '"+eK(c).path+"'");a=!1;var d=tH(t,e,p,c);r.splice(o,0,d)}else a=!1,r.splice(o,1),s instanceof ec&&s.createObservableInstanceIfNeeded(),s.die(),o--;else break}return a?null:r}function tH(e,t,r,n,i){eU(e,n);var a=function(){if(eZ(n)){var a=eK(n);if(a.assertAlive(e8),null!==a.parent&&a.parent===t)return a.setParent(t,r),a}return i?e.reconcile(i,n,t,r):e.instantiate(t,r,void 0,n)}();return i&&i!==a&&(i instanceof ec&&i.createObservableInstanceIfNeeded(),i.die()),a}function tL(e,t){if(!e.isAlive)return!1;if(eZ(t)){var r=eK(t);return r.isAlive&&r===e}if(e.snapshot===t)return!0;if(!(e instanceof ec))return!1;var n=e.getReconciliationType();return null!==e.identifier&&e.identifierAttribute&&ti(t)&&n.is(t)&&n.isMatchingSnapshotId(e,t)}function tU(e){return ey(e)&&(e.flags&a.Array)>0}tF.prototype.applySnapshot=(0,s.action)(tF.prototype.applySnapshot);var t$="preProcessSnapshot",tW="postProcessSnapshot";function tG(){return eK(this).toString()}var tY={name:"AnonymousModel",properties:{},initializers:e5},tJ=function(e){function t(t){var r,i,o,u=e.call(this,t.name||tY.name)||this;return Object.defineProperty(u,"flags",{enumerable:!0,configurable:!0,writable:!0,value:a.Object}),Object.defineProperty(u,"initializers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"properties",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"preProcessor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"postProcessor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"propertyNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"named",{enumerable:!0,configurable:!0,writable:!0,value:function(e){return u.cloneAndEnhance({name:e})}}),Object.defineProperty(u,"props",{enumerable:!0,configurable:!0,writable:!0,value:function(e){return u.cloneAndEnhance({properties:e})}}),Object.defineProperty(u,"preProcessSnapshot",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t=u.preProcessor;return t?u.cloneAndEnhance({preProcessor:function(r){return t(e(r))}}):u.cloneAndEnhance({preProcessor:e})}}),Object.defineProperty(u,"postProcessSnapshot",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t=u.postProcessor;return t?u.cloneAndEnhance({postProcessor:function(r){return e(t(r))}}):u.cloneAndEnhance({postProcessor:e})}}),Object.assign(u,tY,t),i=Object.keys(r=u.properties),o=new Set,i.forEach(function(e){if(o.has(e))throw e7(e+" is declared twice in the model. Model should not contain the same keys");o.add(e)}),u.properties=i.reduce(function(e,t){if(t in n)throw e7("Hook '"+t+"' was defined as property. Hooks should be defined as part of the actions");var i=Object.getOwnPropertyDescriptor(r,t);if("get"in i)throw e7("Getters are not supported as properties. Please use views instead");var a=i.value;if(null==a)throw e7("The default value of an attribute cannot be null or undefined as the type cannot be inferred. Did you mean `types.maybe(someType)`?");if(to(a))e[t]=ra(function(e){switch(typeof e){case"string":return tK;case"number":return tq;case"boolean":return t1;case"object":if(e instanceof Date)return t3}throw e7("Cannot determine primitive type from value "+e)}(a),a);else if(a instanceof tz)e[t]=ra(a,{});else if(a instanceof tF)e[t]=ra(a,[]);else if(ey(a));else if(1)if(1)throw e7("Invalid type definition for property '"+t+"', cannot infer a type from a value like '"+a+"' ("+typeof a+")");else throw e7("Invalid type definition for property '"+t+"', it looks like you passed an object. Try passing another model type or a types.frozen.");else throw e7("Invalid type definition for property '"+t+"', it looks like you passed a function. Did you forget to invoke it, or did you intend to declare a view / action?");return e},v({},r)),tu(u.properties),u.propertyNames=Object.keys(u.properties),u.identifierAttribute=u._getIdentifierAttribute(),u}return y(t,e),Object.defineProperty(t.prototype,"_getIdentifierAttribute",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=void 0;return this.forAllProps(function(t,r){if(r.flags&a.Identifier){if(e)throw e7("Cannot define property '"+t+"' as object identifier, property '"+e+"' is already defined as identifier property");e=t}}),e}}),Object.defineProperty(t.prototype,"cloneAndEnhance",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return new t({name:e.name||this.name,properties:Object.assign({},this.properties,e.properties),initializers:this.initializers.concat(e.initializers||[]),preProcessor:e.preProcessor||this.preProcessor,postProcessor:e.postProcessor||this.postProcessor})}}),Object.defineProperty(t.prototype,"actions",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;return this.cloneAndEnhance({initializers:[function(r){return t.instantiateActions(r,e(r)),r}]})}}),Object.defineProperty(t.prototype,"instantiateActions",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(!ti(t))throw e7("actions initializer should return a plain object containing actions");Object.keys(t).forEach(function(r){if(r===t$)throw e7("Cannot define action '"+t$+"', it should be defined using 'type.preProcessSnapshot(fn)' instead");if(r===tW)throw e7("Cannot define action '"+tW+"', it should be defined using 'type.postProcessSnapshot(fn)' instead");var i=t[r],a=e[r];if(r in n&&a){var o=i;i=function(){a.apply(null,arguments),o.apply(null,arguments)}}var u=i.$mst_middleware,l=i.bind(t);l._isFlowAction=i._isFlowAction||!1,l.$mst_middleware=u;var s=eC(e,r,l);t[r]=s,tp(e,r,s)})}}),Object.defineProperty(t.prototype,"volatile",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;if("function"!=typeof e)throw e7("You passed an "+typeof e+" to volatile state as an argument, when function is expected");return this.cloneAndEnhance({initializers:[function(r){return t.instantiateVolatileState(r,e(r)),r}]})}}),Object.defineProperty(t.prototype,"instantiateVolatileState",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(!ti(t))throw e7("volatile state initializer should return a plain object containing state");(0,s.set)(e,t)}}),Object.defineProperty(t.prototype,"extend",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;return this.cloneAndEnhance({initializers:[function(r){var n=e(r),i=n.actions,a=n.views,o=n.state,u=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}(n,["actions","views","state"]);for(var l in u)throw e7("The `extend` function should return an object with a subset of the fields 'actions', 'views' and 'state'. Found invalid key '"+l+"'");return o&&t.instantiateVolatileState(r,o),a&&t.instantiateViews(r,a),i&&t.instantiateActions(r,i),r}]})}}),Object.defineProperty(t.prototype,"views",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;return this.cloneAndEnhance({initializers:[function(r){return t.instantiateViews(r,e(r)),r}]})}}),Object.defineProperty(t.prototype,"instantiateViews",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(!ti(t))throw e7("views initializer should return a plain object containing views");Object.getOwnPropertyNames(t).forEach(function(r){var n,i=Object.getOwnPropertyDescriptor(t,r);if("get"in i)(0,s.defineProperty)(e,r,i),(0,s.makeObservable)(e,((n={})[r]=s.computed,n));else if("function"==typeof i.value)tp(e,r,i.value);else throw e7("A view member should either be a function or getter based property")})}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){return eY(this,e,t,r,eZ(n)?n:this.applySnapshotPreProcessor(n))}}),Object.defineProperty(t.prototype,"initializeChildNodes",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){void 0===t&&(t={});var r=e.type,n={};return r.forAllProps(function(r,i){n[r]=i.instantiate(e,r,void 0,t[r])}),n}}),Object.defineProperty(t.prototype,"createNewInstance",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=v(v({},e9),{name:this.name});return s.observable.object(e,e8,t)}}),Object.defineProperty(t.prototype,"finalizeNewInstance",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){tp(t,"toString",tG),this.forAllProps(function(r){(0,s._interceptReads)(t,r,e.unbox)}),this.initializers.reduce(function(e,t){return t(e)},t),(0,s.intercept)(t,this.willChange),(0,s.observe)(t,this.didChange)}}),Object.defineProperty(t.prototype,"willChange",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=eK(e.object),r=e.name;t.assertWritable({subpath:r});var n=t.type.properties[r];return n&&(eU(n,e.newValue),e.newValue=n.reconcile(t.getChildNode(r),e.newValue,t,r)),e}}),Object.defineProperty(t.prototype,"didChange",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=eK(e.object);if(t.type.properties[e.name]){var r=e.oldValue?e.oldValue.snapshot:void 0;t.emitPatch({op:"replace",path:tT(e.name),value:e.newValue.snapshot,oldValue:r},t)}}}),Object.defineProperty(t.prototype,"getChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,r=[];return this.forAllProps(function(n){r.push(t.getChildNode(e,n))}),r}}),Object.defineProperty(t.prototype,"getChildNode",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(!(t in this.properties))throw e7("Not a value property: "+t);var r,n=(0,s._getAdministration)(e.storedValue,t),i=null==(r=n.raw)?void 0:r.call(n);if(!i)throw e7("Node not available for property "+t);return i}}),Object.defineProperty(t.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this;void 0===t&&(t=!0);var n={};return(this.forAllProps(function(t,i){try{(0,s.getAtom)(e.storedValue,t).reportObserved()}catch(e){throw e7(t+" property is declared twice")}n[t]=r.getChildNode(e,t).snapshot}),t)?this.applySnapshotPostProcessor(n):n}}),Object.defineProperty(t.prototype,"processInitialSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t={};return Object.keys(e).forEach(function(r){t[r]=e[r].getSnapshot()}),this.applySnapshotPostProcessor(t)}}),Object.defineProperty(t.prototype,"applyPatchLocally",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){if("replace"!==r.op&&"add"!==r.op)throw e7("object does not support operation "+r.op);e.storedValue[t]=r.value}}),Object.defineProperty(t.prototype,"applySnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){eU(this,t);var r=this.applySnapshotPreProcessor(t);this.forAllProps(function(t){e.storedValue[t]=r[t]})}}),Object.defineProperty(t.prototype,"applySnapshotPreProcessor",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.preProcessor;return t?t.call(null,e):e}}),Object.defineProperty(t.prototype,"applySnapshotPostProcessor",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.postProcessor;return t?t.call(null,e):e}}),Object.defineProperty(t.prototype,"getChildType",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return tO(e,1),this.properties[e]}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this,n=this.applySnapshotPreProcessor(e);return ti(n)?eL(this.propertyNames.map(function(e){return r.properties[e].validate(n[e],eM(t,e,r.properties[e]))})):eH(t,n,"Value is not a plain object")}}),Object.defineProperty(t.prototype,"forAllProps",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;this.propertyNames.forEach(function(r){return e(r,t.properties[r])})}}),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;return"{ "+this.propertyNames.map(function(t){return t+": "+e.properties[t].describe()}).join("; ")+" }"}}),Object.defineProperty(t.prototype,"getDefaultSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(){return e8}}),Object.defineProperty(t.prototype,"removeChild",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){e.storedValue[t]=void 0}}),t}(ed);function tZ(e){return ey(e)&&(e.flags&a.Object)>0}tJ.prototype.applySnapshot=(0,s.action)(tJ.prototype.applySnapshot);var tB=function(e){function t(t,r,n,i){void 0===i&&(i=te);var a=e.call(this,t)||this;return Object.defineProperty(a,"flags",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(a,"checker",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(a,"initializer",{enumerable:!0,configurable:!0,writable:!0,value:i}),a.flags=r,a}return y(t,e),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.name}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){return eJ(this,e,t,r,n)}}),Object.defineProperty(t.prototype,"createNewInstance",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.initializer(e)}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return to(e)&&this.checker(e)?e5:eH(t,e,"Value is not a "+("Date"===this.name?"Date or a unix milliseconds timestamp":this.name))}}),t}(eh),tK=new tB("string",a.String,function(e){return"string"==typeof e}),tq=new tB("number",a.Number,function(e){return"number"==typeof e}),tQ=new tB("integer",a.Integer,function(e){return tt(e)}),tX=new tB("float",a.Float,function(e){return Number(e)===e&&e%1!=0}),t0=new tB("finite",a.Finite,function(e){return Number.isFinite(e)}),t1=new tB("boolean",a.Boolean,function(e){return"boolean"==typeof e}),t2=new tB("null",a.Null,function(e){return null===e}),t4=new tB("undefined",a.Undefined,function(e){return void 0===e}),t3=new tB("Date",a.Date,function(e){return"number"==typeof e||e instanceof Date},function(e){return e instanceof Date?e:new Date(e)});function t6(e){return ey(e)&&(e.flags&(a.String|a.Number|a.Integer|a.Boolean|a.Date))>0}t3.getSnapshot=function(e){return e.storedValue.getTime()};var t5=function(e){function t(t){var r=e.call(this,JSON.stringify(t))||this;return Object.defineProperty(r,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"flags",{enumerable:!0,configurable:!0,writable:!0,value:a.Literal}),r.value=t,r}return y(t,e),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){return eJ(this,e,t,r,n)}}),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return JSON.stringify(this.value)}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return to(e)&&e===this.value?e5:eH(t,e,"Value is not a literal "+JSON.stringify(this.value))}}),t}(eh);function t8(e){return tm(e,to,"primitive",1),new t5(e)}function t9(e){return ey(e)&&(e.flags&a.Literal)>0}var t7=function(e){function t(t,r,n,i){var a=e.call(this,t)||this;return Object.defineProperty(a,"_subtype",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(a,"_predicate",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(a,"_message",{enumerable:!0,configurable:!0,writable:!0,value:i}),a}return y(t,e),Object.defineProperty(t.prototype,"flags",{get:function(){return this._subtype.flags|a.Refinement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.name}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){return this._subtype.instantiate(e,t,r,n)}}),Object.defineProperty(t.prototype,"isAssignableFrom",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._subtype.isAssignableFrom(e)}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this._subtype.validate(e,t);if(r.length>0)return r;var n=eZ(e)?eK(e).snapshot:e;return this._predicate(n)?e5:eH(t,e,this._message(e))}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){return this._subtype.reconcile(e,t,r,n)}}),Object.defineProperty(t.prototype,"getSubTypes",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._subtype}}),t}(eb);function re(e){return(e.flags&a.Refinement)>0}var rt=function(e){function t(t,r,n){var i=e.call(this,t)||this;return Object.defineProperty(i,"_types",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(i,"_dispatcher",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"_eager",{enumerable:!0,configurable:!0,writable:!0,value:!0}),i._dispatcher=(n=v({eager:!0,dispatcher:void 0},n)).dispatcher,n.eager||(i._eager=!1),i}return y(t,e),Object.defineProperty(t.prototype,"flags",{get:function(){var e=a.Union;return this._types.forEach(function(t){e|=t.flags}),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAssignableFrom",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._types.some(function(t){return t.isAssignableFrom(e)})}}),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return"("+this._types.map(function(e){return e.describe()}).join(" | ")+")"}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){var i=this.determineType(n,void 0);if(!i)throw e7("No matching type for union "+this.describe());return i.instantiate(e,t,r,n)}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){var i=this.determineType(t,e.getReconciliationType());if(!i)throw e7("No matching type for union "+this.describe());return i.reconcile(e,t,r,n)}}),Object.defineProperty(t.prototype,"determineType",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return this._dispatcher?this._dispatcher(e):t?t.is(e)?t:this._types.filter(function(e){return e!==t}).find(function(t){return t.is(e)}):this._types.find(function(t){return t.is(e)})}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(this._dispatcher)return this._dispatcher(e).validate(e,t);for(var r=[],n=0,i=0;i<this._types.length;i++){var a=this._types[i].validate(e,t);if(0===a.length)if(this._eager)return e5;else n++;else r.push(a)}return 1===n?e5:eH(t,e,"No type is applicable for the union").concat(eL(r))}}),Object.defineProperty(t.prototype,"getSubTypes",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._types}}),t}(eb);function rr(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=ey(e)?void 0:e,i=ey(e)?P([e],t):t;return new rt("("+i.map(function(e){return e.name}).join(" | ")+")",i,n)}function rn(e){return(e.flags&a.Union)>0}var ri=function(e){function t(t,r,n){var i=e.call(this,t.name)||this;return Object.defineProperty(i,"_subtype",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(i,"_defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(i,"optionalValues",{enumerable:!0,configurable:!0,writable:!0,value:n}),i}return y(t,e),Object.defineProperty(t.prototype,"flags",{get:function(){return this._subtype.flags|a.Optional},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._subtype.describe()+"?"}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){if(this.optionalValues.indexOf(n)>=0){var i=this.getDefaultInstanceOrSnapshot();return this._subtype.instantiate(e,t,r,i)}return this._subtype.instantiate(e,t,r,n)}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){return this._subtype.reconcile(e,0>this.optionalValues.indexOf(t)&&this._subtype.is(t)?t:this.getDefaultInstanceOrSnapshot(),r,n)}}),Object.defineProperty(t.prototype,"getDefaultInstanceOrSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e="function"==typeof this._defaultValue?this._defaultValue():this._defaultValue;return"function"==typeof this._defaultValue&&eU(this,e),e}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return this.optionalValues.indexOf(e)>=0?e5:this._subtype.validate(e,t)}}),Object.defineProperty(t.prototype,"isAssignableFrom",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._subtype.isAssignableFrom(e)}}),Object.defineProperty(t.prototype,"getSubTypes",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._subtype}}),t}(eb);function ra(e,t,r){if("function"!=typeof t&&eZ(t))throw e7("default value cannot be an instance, pass a snapshot or a function that creates an instance/snapshot instead");return ev(e,1),new ri(e,t,r||ro)}var ro=[void 0];function ru(e){return ey(e)&&(e.flags&a.Optional)>0}var rl=ra(t4,void 0),rs=ra(t2,null);function rc(e){return ev(e,1),rr(e,rl)}var rp=function(e){function t(t,r){var n=e.call(this,t)||this;return Object.defineProperty(n,"_definition",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(n,"_subType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n}return y(t,e),Object.defineProperty(t.prototype,"flags",{get:function(){return(this._subType?this._subType.flags:0)|a.Late},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"getSubType",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(!this._subType){var t=void 0;try{t=this._definition()}catch(e){if(e instanceof ReferenceError)t=void 0;else throw e}if(e&&void 0===t)throw e7("Late type seems to be used too early, the definition (still) returns undefined");t&&(this._subType=t)}return this._subType}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){return this.getSubType(!0).instantiate(e,t,r,n)}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){return this.getSubType(!0).reconcile(e,t,r,n)}}),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.getSubType(!1);return e?e.name:"<uknown late type>"}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this.getSubType(!1);return r?r.validate(e,t):e5}}),Object.defineProperty(t.prototype,"isAssignableFrom",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.getSubType(!1);return!!t&&t.isAssignableFrom(e)}}),Object.defineProperty(t.prototype,"getSubTypes",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.getSubType(!1)||ep}}),t}(eb);function rf(e){return ey(e)&&(e.flags&a.Late)>0}var rb=function(e){function t(t,r){var n=e.call(this,t)||this;return Object.defineProperty(n,"options",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(n,"flags",{enumerable:!0,configurable:!0,writable:!0,value:a.Lazy}),Object.defineProperty(n,"loadedType",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(n,"pendingNodeList",{enumerable:!0,configurable:!0,writable:!0,value:s.observable.array()}),(0,s.when)(function(){return n.pendingNodeList.length>0&&n.pendingNodeList.some(function(e){return e.isAlive&&n.options.shouldLoadPredicate(e.parent?e.parent.value:null)})},function(){n.options.loadType().then((0,s.action)(function(e){n.loadedType=e,n.pendingNodeList.forEach(function(e){e.parent&&n.loadedType&&e.parent.applyPatches([{op:"replace",path:"/"+e.subpath,value:e.snapshot}])})}))}),n}return y(t,e),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return"<lazy "+this.name+">"}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){var i=this;if(this.loadedType)return this.loadedType.instantiate(e,t,r,n);var a=eJ(this,e,t,r,tl(n));return this.pendingNodeList.push(a),(0,s.when)(function(){return!a.isAlive},function(){return i.pendingNodeList.splice(i.pendingNodeList.indexOf(a),1)}),a}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return this.loadedType?this.loadedType.validate(e,t):ts(e)?e5:eH(t,e,"Value is not serializable and cannot be lazy")}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(t,r,n,i){return this.loadedType?(t.die(),this.loadedType.instantiate(n,i,n.environment,r)):e.prototype.reconcile.call(this,t,r,n,i)}}),t}(eh),rd=function(e){function t(t){var r=e.call(this,t?"frozen("+t.name+")":"frozen")||this;return Object.defineProperty(r,"subType",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(r,"flags",{enumerable:!0,configurable:!0,writable:!0,value:a.Frozen}),r}return y(t,e),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return"<any immutable value>"}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){return eJ(this,e,t,r,tl(n))}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return ts(e)?this.subType?this.subType.validate(e,t):e5:eH(t,e,"Value is not serializable and cannot be frozen")}}),t}(eh),rh=new rd;function ry(e){return ey(e)&&(e.flags&a.Frozen)>0}var rv=function(){function e(e,t){if(Object.defineProperty(this,"targetType",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"identifier",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"node",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resolvedReference",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),rE(e))this.identifier=e;else if(eZ(e)){var r=eK(e);if(!r.identifierAttribute)throw e7("Can only store references with a defined identifier attribute.");var n=r.unnormalizedIdentifier;if(null==n)throw e7("Can only store references to tree nodes with a defined identifier.");this.identifier=n}else throw e7("Can only store references to tree nodes or identifiers, got: '"+e+"'")}return Object.defineProperty(e.prototype,"updateResolvedReference",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=""+this.identifier,r=e.root,n=r.identifierCache.getLastCacheModificationPerId(t);if(!this.resolvedReference||this.resolvedReference.lastCacheModification!==n){var i=this.targetType,a=r.identifierCache.resolve(i,t);if(!a)throw new rg("[mobx-state-tree] Failed to resolve reference '"+this.identifier+"' to type '"+this.targetType.name+"' (from node: "+e.path+")");this.resolvedReference={node:a,lastCacheModification:n}}}}),Object.defineProperty(e.prototype,"resolvedValue",{get:function(){return this.updateResolvedReference(this.node),this.resolvedReference.node.value},enumerable:!1,configurable:!0}),e}(),rg=function(e){function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return y(t,e),t}(Error),rm=function(e){function t(t,r){var n=e.call(this,"reference("+t.name+")")||this;return Object.defineProperty(n,"targetType",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(n,"onInvalidated",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(n,"flags",{enumerable:!0,configurable:!0,writable:!0,value:a.Reference}),n}return y(t,e),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.name}}),Object.defineProperty(t.prototype,"isAssignableFrom",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.targetType.isAssignableFrom(e)}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return rE(e)?e5:eH(t,e,"Value is not a valid identifier, which is a string or a number")}}),Object.defineProperty(t.prototype,"fireInvalidated",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){var i=t.parent;if(i&&i.isAlive){var a=i.storedValue;a&&this.onInvalidated({cause:e,parent:a,invalidTarget:n?n.storedValue:void 0,invalidId:r,replaceRef:function(e){A(t.root.storedValue,{op:"replace",value:e,path:t.path})},removeRef:function(){tZ(i.type)?this.replaceRef(void 0):A(t.root.storedValue,{op:"remove",path:t.path})}})}}}),Object.defineProperty(t.prototype,"addTargetNodeWatcher",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this,i=this.getValue(e);if(i){var a=eK(i),o=function(i,o){var u=function(e){switch(e){case n.beforeDestroy:return"destroy";case n.beforeDetach:return"detach";default:return}}(o);u&&r.fireInvalidated(u,e,t,a)},u=a.registerHook(n.beforeDetach,o),l=a.registerHook(n.beforeDestroy,o);return function(){u(),l()}}}}),Object.defineProperty(t.prototype,"watchTargetNodeForInvalidations",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){var i,a=this;if(this.onInvalidated){e.registerHook(n.beforeDestroy,function(){i&&i()});var o=function(n){i&&i();var o=e.parent,u=o&&o.storedValue;if(o&&o.isAlive&&u){var l=void 0;(r?!!r.get(t,u):e.root.identifierCache.has(a.targetType,""+t))?i=a.addTargetNodeWatcher(e,t):n||a.fireInvalidated("invalidSnapshotReference",e,t,null)}};e.state===u.FINALIZED?o(!0):(e.isRoot||e.root.registerHook(n.afterCreationFinalization,function(){e.parent&&e.parent.createObservableInstanceIfNeeded()}),e.registerHook(n.afterAttach,function(){o(!1)}))}}}),t}(eh),rw=function(e){function t(t,r){return e.call(this,t,r)||this}return y(t,e),Object.defineProperty(t.prototype,"getValue",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(e.isAlive)return e.storedValue.resolvedValue}}),Object.defineProperty(t.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e.storedValue.identifier}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){var i=eZ(n)?$(n):n,a=new rv(n,this.targetType),o=eJ(this,e,t,r,a);return a.node=o,this.watchTargetNodeForInvalidations(o,i,void 0),o}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){if(!e.isDetaching&&e.type===this){var i=eZ(t),a=e.storedValue;if(!i&&a.identifier===t||i&&a.resolvedValue===t)return e.setParent(r,n),e}var o=this.instantiate(r,n,void 0,t);return e.die(),o}}),t}(rm),rP=function(e){function t(t,r,n){var i=e.call(this,t,n)||this;return Object.defineProperty(i,"options",{enumerable:!0,configurable:!0,writable:!0,value:r}),i}return y(t,e),Object.defineProperty(t.prototype,"getValue",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(e.isAlive)return this.options.get(e.storedValue,e.parent?e.parent.storedValue:null)}}),Object.defineProperty(t.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e.storedValue}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){var i=eZ(n)?this.options.set(n,e?e.storedValue:null):n,a=eJ(this,e,t,r,i);return this.watchTargetNodeForInvalidations(a,i,this.options),a}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){var i=eZ(t)?this.options.set(t,e?e.storedValue:null):t;if(!e.isDetaching&&e.type===this&&e.storedValue===i)return e.setParent(r,n),e;var a=this.instantiate(r,n,void 0,i);return e.die(),a}}),t}(rm);function rO(e,t){ev(e,1);var r=t||void 0,n=t?t.onInvalidated:void 0;return r&&(r.get||r.set)?new rP(e,{get:r.get,set:r.set},n):new rw(e,n)}function rj(e){return(e.flags&a.Reference)>0}var r_=function(e){function t(t,r){var n=e.call(this,t)||this;return Object.defineProperty(n,"validType",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(n,"flags",{enumerable:!0,configurable:!0,writable:!0,value:a.Identifier}),n}return y(t,e),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){if(!e||!(e.type instanceof tJ))throw e7("Identifier types can only be instantiated as direct child of a model type");return eJ(this,e,t,r,n)}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){if(e.storedValue!==t)throw e7("Tried to change identifier from '"+e.storedValue+"' to '"+t+"'. Changing identifiers is not allowed.");return e.setParent(r,n),e}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return typeof e!==this.validType?eH(t,e,"Value is not a valid "+this.describe()+", expected a "+this.validType):e5}}),t}(eh),rS=function(e){function t(){var t=e.call(this,"identifier","string")||this;return Object.defineProperty(t,"flags",{enumerable:!0,configurable:!0,writable:!0,value:a.Identifier}),t}return y(t,e),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return"identifier"}}),t}(r_),rA=function(e){function t(){return e.call(this,"identifierNumber","number")||this}return y(t,e),Object.defineProperty(t.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e.storedValue}}),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return"identifierNumber"}}),t}(r_),rI=new rS,rT=new rA;function rC(e){return ey(e)&&(e.flags&a.Identifier)>0}function rE(e){return"string"==typeof e||"number"==typeof e}var rN=function(e){function t(t){var r=e.call(this,t.name)||this;return Object.defineProperty(r,"options",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(r,"flags",{enumerable:!0,configurable:!0,writable:!0,value:a.Custom}),r}return y(t,e),Object.defineProperty(t.prototype,"describe",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.name}}),Object.defineProperty(t.prototype,"isValidSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(this.options.isTargetType(e))return e5;var r=this.options.getValidationMessage(e);return r?eH(t,e,"Invalid value for type '"+this.name+"': "+r):e5}}),Object.defineProperty(t.prototype,"getSnapshot",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.options.toSnapshot(e.storedValue)}}),Object.defineProperty(t.prototype,"instantiate",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){var i=this.options.isTargetType(n)?n:this.options.fromSnapshot(n,e&&e.root.environment);return eJ(this,e,t,r,i)}}),Object.defineProperty(t.prototype,"reconcile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,n){var i=!this.options.isTargetType(t);if(!e.isDetaching&&e.type===this&&(i?t===e.snapshot:t===e.storedValue))return e.setParent(r,n),e;var a=i?this.options.fromSnapshot(t,r.root.environment):t,o=this.instantiate(r,n,void 0,a);return e.die(),o}}),t}(eh),rV={enumeration:function(e,t){var r=rr.apply(void 0,P(("string"==typeof e?t:e).map(function(e){return t8(""+e)})));return"string"==typeof e&&(r.name=e),r},model:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new tJ({name:"string"==typeof e[0]?e.shift():"AnonymousModel",properties:e.shift()||{}})},compose:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="string"==typeof e[0],n=r?e[0]:"AnonymousModel";return r&&e.shift(),e.reduce(function(e,t){return e.cloneAndEnhance({name:e.name+"_"+t.name,properties:t.properties,initializers:t.initializers,preProcessor:function(r){return t.applySnapshotPreProcessor(e.applySnapshotPreProcessor(r))},postProcessor:function(r){return t.applySnapshotPostProcessor(e.applySnapshotPostProcessor(r))}})}).named(n)},custom:function(e){return new rN(e)},reference:rO,safeReference:function(e,t){var r=rO(e,v(v({},t),{onInvalidated:function(e){t&&t.onInvalidated&&t.onInvalidated(e),e.removeRef()}}));return t&&!1===t.acceptsUndefined?r:rc(r)},union:rr,optional:ra,literal:t8,maybe:rc,maybeNull:function(e){return ev(e,1),rr(e,rs)},refinement:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="string"==typeof e[0]?e.shift():ey(e[0])?e[0].name:null,n=e[0],i=e[1],a=e[2]?e[2]:function(e){return"Value does not respect the refinement predicate"};return ev(n,[1,2]),tO(r,1),tw(i,[2,3]),tw(a,[3,4]),new t7(r,n,i,a)},string:tK,boolean:t1,number:tq,integer:tQ,float:tX,finite:t0,Date:t3,map:function(e){return new tz("Map<string, "+e.name+">",e)},array:function(e){return ev(e,1),new tF(e.name+"[]",e)},frozen:function(e){return 0==arguments.length?rh:ey(e)?new rd(e):ra(rh,e)},identifier:rI,identifierNumber:rT,late:function(e,t){var r="string"==typeof e?e:"late("+e.toString()+")",n="string"==typeof e?t:e;return new rp(r,n)},lazy:function(e,t){return new rb(e,t)},undefined:t4,null:t2,snapshotProcessor:function(e,t,r){return ev(e,1),new tD(e,t,r)}}}}]);
//# sourceMappingURL=74efd9f1.2585ff56f7f08396.js.map