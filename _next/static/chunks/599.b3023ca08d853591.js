"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[599],{20209:(e,t,n)=>{function l(e){let t=0;for(let n=0;n<e.length;n++)t+=e.charCodeAt(n);return r(10*t)}function r(e){return`hsl(${e%255}, 50%, 50%)`}n.d(t,{XL:()=>l,qH:()=>r})},30599:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var l=n(95155),r=n(12115),i=n(42086),o=n.n(i),s=n(15715),a=n(64150),c=n(66292),d=n(96358),h=n(74100),u=n(94029),m=n(9670),x=n(95946);let p=(0,h.makeStyles)()({textAreaFont:{fontFamily:"Courier New"}});function f({onClose:e,currLayout:t}){let{classes:n}=p(),[i,o]=(0,r.useState)(""),[s,h]=(0,r.useState)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(a.A,{children:[(0,l.jsx)(m.A,{children:'Paste CSV or TSV. If a header column is present. First line is a header. If a column called "name" is present, it uses that to connect to IDs in the table, otherwise it uses the first column no.'}),s?(0,l.jsx)(u.ErrorMessage,{error:s}):null,(0,l.jsx)(x.A,{variant:"outlined",multiline:!0,minRows:5,placeholder:"name,population\nHG00098,GBR\nHG00101,GBR\nHG00459,CHS\n...",maxRows:10,fullWidth:!0,value:i,onChange:e=>{o(e.target.value)},slotProps:{input:{classes:{input:n.textAreaFont}}}})]}),(0,l.jsxs)(d.A,{children:[(0,l.jsx)(c.A,{variant:"contained",color:"secondary",onClick:()=>{let n=i.split("\n").map(e=>e.trim()).filter(e=>!!e),l=n[0].split(/[,\t]/gm);if(l.includes("name")){h("");let r=Object.fromEntries(t.map(e=>[e.name,e])),i=Object.fromEntries(n.slice(1).map(e=>{let t=Object.fromEntries(e.split(/[,\t]/gm).map((e,t)=>[l[t],e]));return[t.name,{...t,...r[t.name]}]}));e(t.map(e=>({...e,...i[e.name]})))}else h(Error('No "name" column found on line 1'))},children:"Update rows"}),(0,l.jsx)(c.A,{variant:"contained",color:"primary",onClick:()=>{let n=i.split("\n").map(e=>e.trim()).filter(e=>!!e),l=n[0].split(/[,\t]/gm);if(l.includes("name")){h("");let r=Object.fromEntries(t.map(e=>[e.name,e])),i=Object.fromEntries(n.slice(1).map(e=>{let t=Object.fromEntries(e.split(/[,\t]/gm).map((e,t)=>[l[t],e]));return[t.name,{...t,...r[t.name]}]}));e(t.map(e=>({...i[e.name]})))}else h(Error('No "name" column found on line 1'))},children:"Replace rows"}),(0,l.jsx)(c.A,{variant:"contained",color:"inherit",onClick:()=>{e()},children:"Cancel"})]})]})}function j(){return(0,l.jsxs)(l.Fragment,{children:["Helpful tips",(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"You can select rows in the table with the checkboxes"}),(0,l.jsx)("li",{children:"Multi-select is enabled with shift-click and control-click"}),(0,l.jsx)("li",{children:'The "Move selected items up/down" can re-arrange subtracks'}),(0,l.jsx)("li",{children:"Sorting the data grid itself can also re-arrange subtracks"}),(0,l.jsx)("li",{children:"Changes are applied when you hit Submit"}),(0,l.jsx)("li",{children:"You can click and drag the dialog box to move it on the screen"}),(0,l.jsx)("li",{children:"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"})]})]})}var g=n(4671),C=n(20209);function b({setCurrLayout:e,currLayout:t}){var n;return(0,l.jsxs)("div",{children:["Create color palette based on...",Object.keys(null!==(n=t[0])&&void 0!==n?n:[]).filter(e=>"name"!==e&&"color"!==e&&"label"!==e&&"id"!==e&&"HP"!==e).map(n=>(0,l.jsx)(c.A,{variant:"contained",color:"inherit",onClick:()=>{let l=new Map;for(let e of t){let t=l.get(e[n]);t?l.set(e[n],t+1):l.set(e[n],1)}let r=Object.fromEntries([...l.entries()].sort((e,t)=>e[1]-t[1]).map((e,t)=>[e[0],g.set1[t]||(0,C.XL)(e[0])]));e(t.map(e=>({...e,color:r[e[n]]})))},children:n},n)),(0,l.jsx)(c.A,{onClick:()=>{e(t.map(e=>({...e,color:void 0})))},children:"Clear colors"})]})}var v=n(94288),w=n.n(v),k=n(24716);let S=(0,h.makeStyles)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function A({rows:e,onChange:t,setSelected:n}){let{classes:i}=S(),[o,a]=(0,r.useState)({idx:0,field:null});if(!e.length)return(0,l.jsx)("div",{children:"No rows, check sample metadata configuration"});{let{id:r,name:c,label:d,color:h,baseUri:m,HP:x,...p}=e[0];return(0,l.jsx)("div",{style:{height:400,width:"100%"},children:(0,l.jsx)(k.z,{checkboxSelection:!0,disableRowSelectionOnClick:!0,onRowSelectionModelChange:e=>{n(e)},rows:e,rowHeight:25,columnHeaderHeight:33,columns:[{field:"color",headerName:"Color",renderCell:n=>{let{value:r,id:i}=n;return(0,l.jsx)(w(),{color:r||"blue",onChange:n=>{let l=e.find(e=>e.name===i);l&&(l.color=n),t([...e])}})}},{field:"label",headerName:"Name",width:(0,s.measureGridWidth)(e.map(e=>e.label))},...Object.keys(p).map(t=>({field:t,renderCell:({value:e})=>(0,l.jsx)("div",{className:i.cell,children:(0,l.jsx)(u.SanitizedHTML,{html:(0,s.getStr)(e)})}),width:(0,s.measureGridWidth)(e.map(e=>`${e[t]}`))}))],sortModel:[],onSortModelChange:n=>{let l=n[0],r=(o.idx+1)%2,i=l.field||o.field;a({idx:r,field:i}),t(i?[...e].sort((e,t)=>{let n=(0,s.getStr)(e[i]),l=(0,s.getStr)(t[i]);return 1===r?n.localeCompare(l):l.localeCompare(n)}):e)}})})}}var y=n(35710),M=n(30467),E=n(63625),H=n(55604);function N(e,t,n=1){let l=t.map(t=>e.findIndex(e=>e.name===t)).sort((e,t)=>e-t),r=0;for(let t of l){let l=Math.max(r,t-n);l>=r&&e.splice(l,0,e.splice(t,1)[0]),r+=1}return e}function O(e,t,n=1){let l=t.map(t=>e.findIndex(e=>e.name===t)).sort((e,t)=>t-e),r=e.length-1;for(let t of l){let l=Math.min(r,t+n);l<=r&&e.splice(l,0,e.splice(t,1)[0]),r-=1}return e}function F({selected:e,onChange:t,rows:n,showTips:i}){let[o,s]=(0,r.useState)(null),[a,d]=(0,r.useState)("blue");return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.A,{disabled:!e.length,onClick:e=>{s(e.currentTarget)},children:"Change color of selected items"}),(0,l.jsxs)(c.A,{onClick:()=>{t(N([...n],e))},disabled:!e.length,children:[(0,l.jsx)(M.A,{}),i?"Move selected items up":null]}),(0,l.jsxs)(c.A,{onClick:()=>{t(O([...n],e))},disabled:!e.length,children:[(0,l.jsx)(y.A,{}),i?"Move selected items down":null]}),(0,l.jsxs)(c.A,{onClick:()=>{t(N([...n],e,n.length))},disabled:!e.length,children:[(0,l.jsx)(H.A,{}),i?"Move selected items to top":null]}),(0,l.jsxs)(c.A,{onClick:()=>{t(O([...n],e,n.length))},disabled:!e.length,children:[(0,l.jsx)(E.A,{}),i?"Move selected items to bottom":null]}),(0,l.jsx)(v.ColorPopover,{anchorEl:o,color:a,onChange:l=>{for(let t of(d(l),e)){let e=n.find(e=>e.name===t);e&&(e.color=l)}t([...n])},onClose:()=>{s(null)}})]})}let L=function({rows:e,onChange:t,showTips:n}){let[i,o]=(0,r.useState)([]);return(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{selected:i,rows:e,showTips:n,onChange:t}),(0,l.jsx)(A,{rows:e,onChange:t,setSelected:o})]})},G=(0,h.makeStyles)()({content:{minWidth:800},fr:{float:"right",display:"flex",gap:8},textAreaFont:{fontFamily:"Courier New"}});function R({model:e,handleClose:t}){let{classes:n}=G(),{sources:i}=e,[h,u]=(0,r.useState)(!1),[m,x]=(0,r.useState)(i||[]),[p,g]=(0,s.useLocalStorage)("multivariant-showTips",!1);return(0,l.jsx)(o(),{open:!0,onClose:t,maxWidth:"xl",title:"Multi-variant color/arrangement editor",children:h?(0,l.jsx)(f,{currLayout:m,onClose:e=>{e&&x(e),u(!1)}}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(a.A,{className:n.content,children:[(0,l.jsxs)("div",{className:n.fr,children:[(0,l.jsx)(c.A,{variant:"contained",onClick:()=>{g(!p)},children:p?"Hide tips":"Show tips"}),(0,l.jsx)(c.A,{color:"secondary",variant:"contained",onClick:()=>{u(!h)},children:"Show Bulk row editor"})]}),p?(0,l.jsx)(j,{}):null,(0,l.jsx)("br",{}),(0,l.jsx)(b,{currLayout:m,setCurrLayout:x}),(0,l.jsx)(L,{rows:m,onChange:x,showTips:p})]}),(0,l.jsxs)(d.A,{children:[(0,l.jsx)(c.A,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{e.clearLayout(),x(e.sources||[])},children:"Clear custom settings"}),(0,l.jsx)(c.A,{variant:"contained",color:"secondary",onClick:()=>{t(),x([...e.sources||[]])},children:"Cancel"}),(0,l.jsx)(c.A,{variant:"contained",color:"primary",type:"submit",onClick:()=>{e.setLayout(m),t()},children:"Submit"})]})]})})}}}]);
//# sourceMappingURL=599.b3023ca08d853591.js.map