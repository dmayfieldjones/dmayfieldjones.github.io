"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5784],{5504:(e,t)=>{t.UU=function(e){return e.map(e=>`>${e.header}
${e.seq.replaceAll(/(.{1,80})/g,"$1\n").trimEnd()}`).join("\n")}},65784:(e,t,r)=>{r.r(t),r.d(t,{default:()=>k});var s=r(95155),n=r(12115),o=r(53394),l=r(47204),a=r(51846),i=r(54262),c=r(5504);let d=(0,r(22471).A)((0,s.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"GetApp");var u=r(55089),h=r(9561),m=r(9552),f=r(77311),b=r(19293),g=r(88153),p=r(79201),x=r(17386),A=r(93929),j=r(78443),C=r(21079),v=r.n(C),y=r(38003),w=r(67072);let S=(0,r(97771).makeStyles)()({dialogContent:{width:"80em"},textAreaFont:{fontFamily:"Courier New"},ml:{marginLeft:10}});async function q(e,t){let r=(0,i.getSession)(e),{leftOffset:s,rightOffset:n}=e;if(!s||!n)throw Error("no offsets on model to use for range");if(s.assemblyName!==n.assemblyName)throw Error("not able to fetch sequences from multiple assemblies");let{rpcManager:l,assemblyManager:a}=r,c=s.assemblyName||n.assemblyName||"",d=a.get(c);if(!d)throw Error(`assembly ${c} not found`);let u=(0,o.getConf)(d,["sequence","adapter"]),h="getSequence";return l.call(h,"CoreGetFeatures",{adapterConfig:u,regions:t,sessionId:h})}let k=(0,w.observer)(function({model:e,handleClose:t}){let{classes:r}=S(),[o,C]=(0,n.useState)(),[w,k]=(0,n.useState)(),[N,$]=(0,n.useState)(!1),[E,R]=(0,n.useState)(!1),[F,_]=(0,n.useState)(!1),{leftOffset:U,rightOffset:z}=e,L=void 0===w;(0,n.useEffect)(()=>{let t=new AbortController;return(async()=>{try{let t=e.getSelectedRegions(U,z);if(0===t.length)throw Error("Selected region is out of bounds");let r=await q(e,t);k(r)}catch(e){console.error(e),C(e)}})(),()=>{t.abort()}},[e,U,z]);let T=w?(0,c.UU)(w.map(e=>{let t=e.get("seq"),r=e.get("refName"),s=e.get("start")+1,n=e.get("end"),o=`${r}:${s}-${n}`;if((null==t?void 0:t.length)!==n-s+1)throw Error(`${o} returned ${t.length.toLocaleString()} bases, but should have returned ${(n-s).toLocaleString()}`);return N&&(t=(0,i.reverse)(t)),F&&(t=(0,i.complement)(t)),{header:o+(N?"-rev":"")+(F?"-comp":""),seq:t}})):"",D=!!T&&T.length>1e6;return(0,s.jsxs)(l.Dialog,{maxWidth:"xl",open:!0,onClose:()=>{t(),e.setOffsets()},title:"Reference sequence",children:[(0,s.jsxs)(u.A,{children:[o?(0,s.jsx)(h.A,{color:"error",children:`${o}`}):L?(0,s.jsxs)(m.A,{children:["Retrieving reference sequence...",(0,s.jsx)(f.A,{className:r.ml,size:20,disableShrink:!0})]}):null,(0,s.jsx)(b.A,{"data-testid":"rubberband-sequence",variant:"outlined",multiline:!0,minRows:5,maxRows:10,disabled:D,className:r.dialogContent,fullWidth:!0,value:D?"Reference sequence too large to display, use the download FASTA button":T,slotProps:{input:{readOnly:!0,classes:{input:r.textAreaFont}}}}),(0,s.jsxs)(g.A,{children:[(0,s.jsx)(p.A,{control:(0,s.jsx)(x.A,{value:N,onChange:e=>{$(e.target.checked)}}),label:"Reverse sequence"}),(0,s.jsx)(p.A,{control:(0,s.jsx)(x.A,{value:F,onChange:e=>{_(e.target.checked)}}),label:"Complement sequence"})]}),(0,s.jsx)(h.A,{style:{margin:10},children:'Note: Check both boxes for the "reverse complement"'})]}),(0,s.jsxs)(A.A,{children:[(0,s.jsx)(j.A,{onClick:()=>{v()(T),R(!0),setTimeout(()=>{R(!1)},500)},disabled:L||!!o||D,color:"primary",startIcon:(0,s.jsx)(a.ContentCopy,{}),children:E?"Copied":"Copy to clipboard"}),(0,s.jsx)(j.A,{onClick:()=>{(0,y.saveAs)(new Blob([T||""],{type:"text/x-fasta;charset=utf-8"}),"jbrowse_ref_seq.fa")},disabled:L||!!o,color:"primary",startIcon:(0,s.jsx)(d,{}),children:"Download FASTA"}),(0,s.jsx)(j.A,{onClick:t,variant:"contained",children:"Close"})]})]})})}}]);
//# sourceMappingURL=5784.c5a3f68272fdb3b2.js.map