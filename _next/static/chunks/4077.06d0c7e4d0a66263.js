"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4077],{64077:(e,t,l)=>{l.r(t),l.d(t,{default:()=>$});var n=l(12115),a=l(47204),r=l(55089),i=l(67072),o=l(94116),c=l.n(o),m=l(54262),s=l(27742),d=l(33803),u=l(37725),h=l(2848),f=l(97771),p=l(77740),E=l(10702),v=l(24861),g=l(33177),w=l(47821),k=l(70625),b=l(9561),C=l(83371);let S=(0,f.makeStyles)()(e=>({facet:{margin:0,marginLeft:e.spacing(2)},select:{marginBottom:e.spacing(2)}}));function A({onClick:e}){return n.createElement(g.A,{title:"Clear selection on this facet filter"},n.createElement(w.A,{onClick:()=>{e()},size:"small"},n.createElement(E.A,null)))}function y({visible:e,onClick:t}){return n.createElement(g.A,{title:"Minimize/expand this facet filter"},n.createElement(w.A,{onClick:()=>{t()},size:"small"},e?n.createElement(v.A,null):n.createElement(p.A,null)))}let x=(0,i.observer)(function({column:e,vals:t,model:l}){let{classes:a}=S(),[r,i]=(0,n.useState)(!0),{faceted:o}=l,{filters:c}=o,{field:s}=e;return n.createElement(k.A,{className:a.facet,fullWidth:!0},n.createElement("div",null,n.createElement(b.A,{component:"span"},s),n.createElement(A,{onClick:()=>{o.setFilter(s,[])}}),n.createElement(y,{visible:r,onClick:()=>{i(!r)}})),r?n.createElement(C.A,{multiple:!0,native:!0,className:a.select,value:c.get(e.field)||[],onChange:t=>{o.setFilter(e.field,[...t.target.options].filter(e=>e.selected).map(e=>e.value))}},t.sort((e,t)=>e[0].localeCompare(t[0])).map(([e,t])=>n.createElement("option",{key:e,value:e},(0,m.coarseStripHTML)(e)," (",t,")"))):null)});var M=l(93946);let T=(0,i.observer)(function({rows:e,columns:t,model:l}){var a,r;let{faceted:i}=l,{filters:o}=i,c=t.slice(1),m=new Map(c.map(e=>[e.field,new Map])),s=i.filters.keys(),d=c.map(e=>e.field),u=new Set;for(let e of s)(null===(a=o.get(e))||void 0===a?void 0:a.length)&&u.add(e);for(let e of d)u.add(e);let h=e;for(let e of u){let t=m.get(e);for(let l of h){let n=(0,M.a)(e,l),a=t.get(n);n&&(void 0===a?t.set(n,1):t.set(n,a+1))}let l=(null===(r=o.get(e))||void 0===r?void 0:r.length)?new Set(o.get(e)):void 0;h=h.filter(t=>void 0===l||l.has((0,M.a)(e,t)))}return n.createElement("div",null,c.map(e=>n.createElement(x,{key:e.field,vals:[...m.get(e.field)],column:e,model:l})))});var H=l(77159),W=l(88552),N=l(19293),F=l(70503),z=l(63433);function O({model:e}){let{faceted:t}=e,[l,r]=(0,n.useState)(null),{showOptions:i,showFilters:o,showSparse:c,useShoppingCart:m}=t;return n.createElement(n.Fragment,null,n.createElement(W.Ay,{container:!0,spacing:4,alignItems:"center"},n.createElement(W.Ay,{item:!0},n.createElement(N.A,{label:"Search...",value:t.filterText,onChange:e=>{t.setFilterText(e.target.value)},slotProps:{input:{endAdornment:n.createElement(F.A,{position:"end"},n.createElement(w.A,{onClick:()=>{t.setFilterText("")}},n.createElement(E.A,null)))}}})),n.createElement(W.Ay,{item:!0},n.createElement(w.A,{onClick:e=>{r(e.currentTarget)}},n.createElement(H.A,null))),n.createElement(W.Ay,{item:!0},n.createElement(z.A,{model:e}))),n.createElement(a.Menu,{anchorEl:l,open:!!l,onClose:()=>{r(null)},onMenuItemClick:(e,t)=>{t(),r(null)},menuItems:[{label:"Add tracks to selection instead of turning them on/off",onClick:()=>{t.setUseShoppingCart(!m)},type:"checkbox",checked:m},{label:"Show sparse metadata columns",onClick:()=>{t.setShowSparse(!c)},checked:c,type:"checkbox"},{label:"Show facet filters",onClick:()=>{t.setShowFilters(!o)},checked:o,type:"checkbox"},{label:"Show extra table options",onClick:()=>{t.setShowOptions(!i)},checked:i,type:"checkbox"}]}))}var I=l(58267);let L=(0,f.makeStyles)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},resizeHandle:{marginLeft:5,background:"grey",width:5}}),R=(0,i.observer)(function({model:e}){var t;let{classes:l}=L(),{view:r,selection:i,shownTrackIds:o,faceted:f}=e,{rows:p,panelWidth:E,showFilters:v,useShoppingCart:g,showOptions:w,filteredRows:k,filteredNonMetadataKeys:b,filteredMetadataKeys:C,visible:S}=f,{pluginManager:A}=(0,m.getEnv)(e),[y,x]=(0,n.useState)({name:(0,m.measureGridWidth)(p.map(e=>e.name),{maxWidth:500,stripHTML:!0})+15,...Object.fromEntries(b.filter(e=>S[e]).map(e=>[e,(0,m.measureGridWidth)(p.map(t=>t[e]),{maxWidth:400,stripHTML:!0})])),...Object.fromEntries(C.filter(e=>S[`metadata.${e}`]).map(e=>[`metadata.${e}`,(0,m.measureGridWidth)(p.map(t=>t.metadata[e]),{maxWidth:400,stripHTML:!0})]))}),M=[{field:"name",hideable:!1,renderCell:t=>{let{value:a,row:r}=t,{id:i,conf:o}=r;return n.createElement("div",{className:l.cell},n.createElement(c(),{html:a}),n.createElement(I.A,{id:i,conf:o,trackId:i,model:e}))},width:null!==(t=y.name)&&void 0!==t?t:100},...b.map(e=>{var t;return{field:e,width:null!==(t=y[e])&&void 0!==t?t:100,renderCell:e=>{let t=e.value;return t?n.createElement(c(),{className:l.cell,html:t}):""}}}),...C.map(e=>{var t;return{field:`metadata.${e}`,headerName:["name",...b].includes(e)?`${e} (from metadata)`:e,width:null!==(t=y[`metadata.${e}`])&&void 0!==t?t:100,valueGetter:(t,l)=>{var n;return`${null!==(n=l.metadata[e])&&void 0!==n?n:""}`},renderCell:e=>{let t=e.value;return t?n.createElement(c(),{className:l.cell,html:t}):""}}})];return n.createElement(n.Fragment,null,n.createElement(O,{model:e}),n.createElement("div",{style:{display:"flex",overflow:"hidden",height:.75*window.innerHeight,width:.75*window.innerWidth}},n.createElement("div",{style:{height:.75*window.innerHeight,width:.75*window.innerWidth-(v?E:0)}},n.createElement(s.z,{rows:k,onColumnWidthChange:e=>{x({...y,[e.colDef.field]:e.width})},columnVisibilityModel:S,onColumnVisibilityModelChange:e=>{f.setVisible(e)},columnHeaderHeight:35,checkboxSelection:!0,disableRowSelectionOnClick:!0,keepNonExistentRowsSelected:!0,onRowSelectionModelChange:t=>{if(g){let l=(0,h.getRoot)(e),n=A.pluggableConfigSchemaType("track");e.setSelection(t.map(e=>(0,h.resolveIdentifier)(n,l,e)))}else{let l=new Set(t);(0,u.transaction)(()=>{[...o].filter(e=>!l.has(e)).map(e=>r.hideTrack(e)),[...l].filter(e=>!o.has(e)).map(t=>{r.showTrack(t),e.addToRecentlyUsed(t)})})}},rowSelectionModel:g?i.map(e=>e.trackId):[...o],slots:{toolbar:w?d.O:null},slotProps:{toolbar:{printOptions:{disableToolbarButton:!0}}},columns:M,rowHeight:25})),v?n.createElement(n.Fragment,null,n.createElement(a.ResizeHandle,{vertical:!0,onDrag:e=>f.setPanelWidth(E-e),className:l.resizeHandle}),n.createElement("div",{style:{width:E,overflow:"auto"}},n.createElement(T,{model:e,rows:p,columns:M}))):null))}),$=(0,i.observer)(function(e){let{handleClose:t}=e;return n.createElement(a.Dialog,{open:!0,onClose:t,maxWidth:"xl",title:"Faceted track selector"},n.createElement(r.A,null,n.createElement(R,{...e})))})}}]);
//# sourceMappingURL=4077.06d0c7e4d0a66263.js.map