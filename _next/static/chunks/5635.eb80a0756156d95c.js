"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5635],{15635:(e,t,l)=>{l.r(t),l.d(t,{default:()=>D});var n=l(12115),a=l(54262),r=l(55089),o=l(78443),i=l(93929),c=l(97771),s=l(6327),m=l(20109),u=l(58671),d=l(40561),h=l(36417),p=l(47821),E=l(2241),f=l(67072),g=l(46296),C=l.n(g);let v=(0,c.makeStyles)()(e=>({closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}));function b(e){let t=(0,n.useRef)(null);return n.createElement(C(),{nodeRef:t,cancel:'[class*="MuiDialogContent-root"]',onStart:e=>{var t,l;return null===(l=null===(t=e.target)||void 0===t?void 0:t.className)||void 0===l?void 0:l.includes("MuiDialogTitle")}},n.createElement(m.A,{ref:t,...e}))}let w=(0,f.observer)(function(e){let{classes:t}=v(),{title:l,children:a,onClose:r}=e;return n.createElement(u.A,{...e,PaperComponent:b},n.createElement(d.A,null,n.createElement(h.A,{style:{cursor:"move"}},l,r?n.createElement(p.A,{className:t.closeButton,onClick:()=>{r()}},n.createElement(s.A,null)):null),n.createElement(E.A,null),a))});var k=l(47204),A=l(51657),S=l.n(A),y=l(36941),M=l(71024),x=l(77770),N=l(92791),H=l(27742);function R(e,t,l=1){let n=t.map(t=>e.findIndex(e=>e.name===t)).sort((e,t)=>e-t),a=0;for(let t of n){let n=Math.max(a,t-l);n>=a&&e.splice(n,0,e.splice(t,1)[0]),a+=1}return e}function L(e,t,l=1){let n=t.map(t=>e.findIndex(e=>e.name===t)).sort((e,t)=>t-e),a=e.length-1;for(let t of n){let n=Math.min(a,t+l);n<=a&&e.splice(n,0,e.splice(t,1)[0]),a-=1}return e}let O=(0,c.makeStyles)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function F({selected:e,onChange:t,rows:l,showTips:a}){let[r,i]=(0,n.useState)(null),[c,s]=(0,n.useState)("blue");return n.createElement(n.Fragment,null,n.createElement(o.A,{disabled:!e.length,onClick:e=>{i(e.currentTarget)}},"Change color of selected items"),n.createElement(o.A,{onClick:()=>{t(R([...l],e))},disabled:!e.length},n.createElement(M.A,null),a?"Move selected items up":null),n.createElement(o.A,{onClick:()=>{t(L([...l],e))},disabled:!e.length},n.createElement(y.A,null),a?"Move selected items down":null),n.createElement(o.A,{onClick:()=>{t(R([...l],e,l.length))},disabled:!e.length},n.createElement(N.A,null),a?"Move selected items to top":null),n.createElement(o.A,{onClick:()=>{t(L([...l],e,l.length))},disabled:!e.length},n.createElement(x.A,null),a?"Move selected items to bottom":null),n.createElement(A.ColorPopover,{anchorEl:r,color:c,onChange:n=>{s(n),e.forEach(e=>{let t=l.find(t=>t.name===e);t&&(t.color=n)}),t([...l])},onClose:()=>{i(null)}}))}let T=function({rows:e,onChange:t,showTips:l}){let{classes:r}=O(),[o,i]=(0,n.useState)([]),{name:c,color:s,baseUri:m,...u}=e[0],[d,h]=(0,n.useState)({idx:0,field:null});return n.createElement("div",null,n.createElement(F,{selected:o,rows:e,showTips:l,onChange:t}),n.createElement("div",{style:{height:400,width:"100%"}},n.createElement(H.z,{getRowId:e=>e.name,checkboxSelection:!0,disableRowSelectionOnClick:!0,onRowSelectionModelChange:e=>{i(e)},rows:e,rowHeight:25,columnHeaderHeight:33,columns:[{field:"color",headerName:"Color",renderCell:l=>{let{value:a,id:r}=l;return n.createElement(S(),{color:a||"blue",onChange:l=>{let n=e.find(e=>e.name===r);n&&(n.color=l),t([...e])}})}},{field:"name",headerName:"Name",width:(0,a.measureGridWidth)(e.map(e=>e.name))},...Object.keys(u).map(t=>({field:t,renderCell:({value:e})=>n.createElement("div",{className:r.cell},n.createElement(k.SanitizedHTML,{html:(0,a.getStr)(e)})),width:(0,a.measureGridWidth)(e.map(e=>`${e[t]}`))}))],sortModel:[],onSortModelChange:l=>{let n=l[0],r=(d.idx+1)%2,o=n.field||d.field;h({idx:r,field:o}),t(o?[...e].sort((e,t)=>{let l=(0,a.getStr)(e[o]),n=(0,a.getStr)(t[o]);return 1===r?l.localeCompare(n):n.localeCompare(l)}):e)}})))};var j=l(9561),G=l(19293);let I=(0,c.makeStyles)()({textAreaFont:{fontFamily:"Courier New"}});function B({setCurrLayout:e,currLayout:t}){let{classes:l}=I(),[a,r]=(0,n.useState)(""),[i,c]=(0,n.useState)();return n.createElement("div",null,n.createElement(j.A,null,'Paste CSV or TSV. If a header column is present. First line is a header. If a column called "name" is present, it uses that to connect to IDs in the table, otherwise it uses the first column no.'),n.createElement(G.A,{variant:"outlined",multiline:!0,minRows:5,placeholder:"name,population\nHG00098,GBR\nHG00101,GBR\nHG00459,CHS\n...",maxRows:10,fullWidth:!0,value:a,onChange:e=>{r(e.target.value)},slotProps:{input:{classes:{input:l.textAreaFont}}}}),n.createElement(o.A,{variant:"contained",onClick:()=>{let l=a.split("\n").map(e=>e.trim()).filter(e=>!!e),n=l[0].split(/[,\t]/gm);if(n.includes("name")){c("");let a=t.map(e=>[e.name,e]),r=Object.fromEntries(l.slice(1).map(e=>{let t=Object.fromEntries(e.split(/[,\t]/gm).map((e,t)=>[n[t],e]));return[t.name,{...t,...a[t.name]}]}));e(t.map(e=>({...e,...r[e.name]})))}else c(Error('No "name" column found on line 1'))}},"Update rows"),n.createElement(o.A,{variant:"contained",onClick:()=>{let l=a.split("\n").map(e=>e.trim()).filter(e=>!!e),n=l[0].split(/[,\t]/gm);if(n.includes("name")){c("");let a=t.map(e=>[e.name,e]),r=Object.fromEntries(l.slice(1).map(e=>{let t=Object.fromEntries(e.split(/[,\t]/gm).map((e,t)=>[n[t],e]));return[t.name,{...t,...a[t.name]}]}));e(t.map(e=>({...r[e.name]})))}else c(Error('No "name" column found on line 1'))}},"Replace rows"),i?n.createElement(k.ErrorMessage,{error:i}):null)}var P=l(32672),W=l(86298);function _({setCurrLayout:e,currLayout:t}){var l;return n.createElement("div",null,Object.keys(null!==(l=t[0])&&void 0!==l?l:[]).filter(e=>"name"!==e&&"color"!==e).map(l=>n.createElement(o.A,{key:l,onClick:()=>{let n=new Map;for(let e of t){let t=n.get(e[l]);t?n.set(e[l],t+1):n.set(e[l],1)}let a=Object.fromEntries([...n.entries()].sort((e,t)=>e[1]-t[1]).map((e,t)=>[e[0],P.set1[t]||(0,W.XL)(e[0])]));e(t.map(e=>({...e,color:a[e[l]]})))}},"Palettize ",l)))}let z=(0,c.makeStyles)()({content:{minWidth:800},fr:{float:"right"},textAreaFont:{fontFamily:"Courier New"}});function D({model:e,handleClose:t}){let{classes:l}=z(),{sources:c}=e,[s,m]=(0,n.useState)(!1),[u,d]=(0,n.useState)(c||[]),[h,p]=(0,a.useLocalStorage)("multivariant-showTips",!1);return n.createElement(w,{open:!0,onClose:t,maxWidth:"xl",title:"Multi-variant color/arrangement editor"},n.createElement(r.A,{className:l.content},n.createElement("div",{className:l.fr},n.createElement(o.A,{variant:"contained",onClick:()=>{p(!h)}},h?"Hide tips":"Show tips"),n.createElement(o.A,{color:"secondary",variant:"contained",onClick:()=>{m(!s)}},s?"Hide bulk row editor":"Show Bulk row editor")),n.createElement("br",null),h?n.createElement(U,null):null,s?n.createElement(B,{currLayout:u,setCurrLayout:d}):null,n.createElement(_,{currLayout:u,setCurrLayout:d}),n.createElement(T,{rows:u,onChange:d,showTips:h})),n.createElement(i.A,null,n.createElement(o.A,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{e.clearLayout(),d(e.sources||[])}},"Clear custom settings"),n.createElement(o.A,{variant:"contained",color:"secondary",onClick:()=>{t(),d([...e.sources||[]])}},"Cancel"),n.createElement(o.A,{variant:"contained",color:"primary",type:"submit",onClick:()=>{e.setLayout(u),t()}},"Submit")))}function U(){return n.createElement(n.Fragment,null,"Helpful tips",n.createElement("ul",null,n.createElement("li",null,"You can select rows in the table with the checkboxes"),n.createElement("li",null,"Multi-select is enabled with shift-click and control-click"),n.createElement("li",null,'The "Move selected items up/down" can re-arrange subtracks'),n.createElement("li",null,"Sorting the data grid itself can also re-arrange subtracks"),n.createElement("li",null,"Changes are applied when you hit Submit"),n.createElement("li",null,"You can click and drag the dialog box to move it on the screen"),n.createElement("li",null,"Columns in the table can be hidden using a vertical '...' menu on the right side of each column")))}}}]);
//# sourceMappingURL=5635.eb80a0756156d95c.js.map