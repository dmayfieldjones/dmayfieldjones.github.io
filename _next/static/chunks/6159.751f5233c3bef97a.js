"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6159],{66159:(e,t,l)=>{l.r(t),l.d(t,{default:()=>G});var i=l(95155),n=l(47204),s=l(55089),a=l(67072),r=l(94116),o=l.n(r),d=l(97771),c=l(12115),h=l(54262),m=l(77740),u=l(10702),f=l(24861),x=l(33177),p=l(47821),j=l(70625),g=l(9561),v=l(83371);let w=(0,d.makeStyles)()(e=>({facet:{margin:0,marginLeft:e.spacing(2)},select:{marginBottom:e.spacing(2)}}));function k({onClick:e}){return(0,i.jsx)(x.A,{title:"Clear selection on this facet filter",children:(0,i.jsx)(p.A,{onClick:()=>{e()},size:"small",children:(0,i.jsx)(u.A,{})})})}function b({visible:e,onClick:t}){return(0,i.jsx)(x.A,{title:"Minimize/expand this facet filter",children:(0,i.jsx)(p.A,{onClick:()=>{t()},size:"small",children:e?(0,i.jsx)(f.A,{}):(0,i.jsx)(m.A,{})})})}let C=(0,a.observer)(function({column:e,vals:t,model:l}){let{classes:n}=w(),[s,a]=(0,c.useState)(!0),{faceted:r}=l,{filters:o}=r,{field:d}=e;return(0,i.jsxs)(j.A,{className:n.facet,fullWidth:!0,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(g.A,{component:"span",children:d}),(0,i.jsx)(k,{onClick:()=>{r.setFilter(d,[])}}),(0,i.jsx)(b,{visible:s,onClick:()=>{a(!s)}})]}),s?(0,i.jsx)(v.A,{multiple:!0,native:!0,className:n.select,value:o.get(e.field)||[],onChange:t=>{r.setFilter(e.field,[...t.target.options].filter(e=>e.selected).map(e=>e.value))},children:t.sort((e,t)=>e[0].localeCompare(t[0])).map(([e,t])=>(0,i.jsxs)("option",{value:e,children:[(0,h.coarseStripHTML)(e)," (",t,")"]},e))}):null]})});var S=l(93946);let A=(0,a.observer)(function({rows:e,columns:t,model:l}){var n,s;let{faceted:a}=l,{filters:r}=a,o=t.slice(1),d=new Map(t.slice(1).map(e=>[e.field,new Map])),c=a.filters.keys(),h=o.map(e=>e.field),m=new Set;for(let e of c)(null===(n=r.get(e))||void 0===n?void 0:n.length)&&m.add(e);for(let e of h)m.add(e);let u=e;for(let e of m){let t=d.get(e);if(t)for(let l of u){let i=(0,S.a)(e,l),n=t.get(i);i&&(void 0===n?t.set(i,1):t.set(i,n+1))}let l=(null===(s=r.get(e))||void 0===s?void 0:s.length)?new Set(r.get(e)):void 0;u=u.filter(t=>void 0===l||l.has((0,S.a)(e,t)))}return(0,i.jsx)("div",{children:o.map(e=>(0,i.jsx)(C,{vals:[...d.get(e.field)],column:e,model:l},e.field))})});var y=l(27742),T=l(33803),M=l(37725),H=l(2848);let W=(0,a.observer)(function({model:e,columns:t,shownTrackIds:l,selection:n}){let{pluginManager:s}=(0,h.getEnv)(e),{view:a,faceted:r}=e,{rows:o,useShoppingCart:d,showOptions:m,filteredRows:u,filteredNonMetadataKeys:f,filteredMetadataKeys:x,visible:p}=r,[j,g]=(0,c.useState)({name:(0,h.measureGridWidth)(o.map(e=>e.name),{maxWidth:500,stripHTML:!0})+15,...Object.fromEntries(f.filter(e=>p[e]).map(e=>[e,(0,h.measureGridWidth)(o.map(t=>t[e]),{maxWidth:400,stripHTML:!0})])),...Object.fromEntries(x.filter(e=>p[`metadata.${e}`]).map(e=>[`metadata.${e}`,(0,h.measureGridWidth)(o.map(t=>t.metadata[e]),{maxWidth:400,stripHTML:!0})]))});return(0,i.jsx)(y.z,{rows:u,onColumnWidthChange:e=>{g({...j,[e.colDef.field]:e.width})},columnVisibilityModel:p,onColumnVisibilityModelChange:t=>{e.faceted.setVisible(t)},columnHeaderHeight:35,checkboxSelection:!0,disableRowSelectionOnClick:!0,keepNonExistentRowsSelected:!0,onRowSelectionModelChange:t=>{if(d){let l=(0,H.getRoot)(e),i=s.pluggableConfigSchemaType("track");e.setSelection(t.map(e=>(0,H.resolveIdentifier)(i,l,e)))}else{let i=new Set(t);(0,M.transaction)(()=>{[...l].filter(e=>!i.has(e)).map(e=>a.hideTrack(e)),[...i].filter(e=>!l.has(e)).map(t=>{a.showTrack(t),e.addToRecentlyUsed(t)})})}},rowSelectionModel:d?n.map(e=>e.trackId):[...l],slots:{toolbar:m?T.O:null},slotProps:{toolbar:{printOptions:{disableToolbarButton:!0}}},columns:t.map(e=>({...e,width:j[e.field]})),rowHeight:25})});var N=l(77159),F=l(88552),z=l(19293),E=l(70503),I=l(63433);function O({model:e}){let{faceted:t}=e,[l,s]=(0,c.useState)(null),{showOptions:a,showFilters:r,showSparse:o,useShoppingCart:d}=t;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(F.Ay,{container:!0,spacing:4,alignItems:"center",children:[(0,i.jsx)(F.Ay,{item:!0,children:(0,i.jsx)(z.A,{label:"Search...",value:t.filterText,onChange:e=>{t.setFilterText(e.target.value)},slotProps:{input:{endAdornment:(0,i.jsx)(E.A,{position:"end",children:(0,i.jsx)(p.A,{onClick:()=>{t.setFilterText("")},children:(0,i.jsx)(u.A,{})})})}}})}),(0,i.jsx)(F.Ay,{item:!0,children:(0,i.jsx)(p.A,{onClick:e=>{s(e.currentTarget)},children:(0,i.jsx)(N.A,{})})}),(0,i.jsx)(F.Ay,{item:!0,children:(0,i.jsx)(I.A,{model:e})})]}),(0,i.jsx)(n.Menu,{anchorEl:l,open:!!l,onClose:()=>{s(null)},onMenuItemClick:(e,t)=>{t(),s(null)},menuItems:[{label:"Add tracks to selection instead of turning them on/off",onClick:()=>{t.setUseShoppingCart(!d)},type:"checkbox",checked:d},{label:"Show sparse metadata columns",onClick:()=>{t.setShowSparse(!o)},checked:o,type:"checkbox"},{label:"Show facet filters",onClick:()=>{t.setShowFilters(!r)},checked:r,type:"checkbox"},{label:"Show extra table options",onClick:()=>{t.setShowOptions(!a)},checked:a,type:"checkbox"}]})]})}var L=l(58267);let R=(0,d.makeStyles)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},resizeHandle:{marginLeft:5,background:"grey",width:5}}),$=(0,a.observer)(function({model:e}){let{classes:t}=R(),{selection:l,shownTrackIds:s,faceted:a}=e,{rows:r,panelWidth:d,showFilters:c,filteredNonMetadataKeys:h,filteredMetadataKeys:m}=a,u=[{field:"name",hideable:!1,renderCell:l=>{let{value:n,row:s}=l,{id:a,conf:r}=s;return(0,i.jsxs)("div",{className:t.cell,children:[(0,i.jsx)(o(),{html:n}),(0,i.jsx)(L.A,{id:a,conf:r,trackId:a,model:e})]})}},...h.map(e=>({field:e,renderCell:e=>{let l=e.value;return l?(0,i.jsx)(o(),{className:t.cell,html:l}):""}})),...m.map(e=>({field:`metadata.${e}`,headerName:["name",...h].includes(e)?`${e} (from metadata)`:e,valueGetter:(t,l)=>{var i;return`${null!==(i=l.metadata[e])&&void 0!==i?i:""}`},renderCell:e=>{let l=e.value;return l?(0,i.jsx)(o(),{className:t.cell,html:l}):""}}))];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(O,{model:e}),(0,i.jsxs)("div",{style:{display:"flex",overflow:"hidden",height:.75*window.innerHeight,width:.75*window.innerWidth},children:[(0,i.jsx)("div",{style:{height:.75*window.innerHeight,width:.75*window.innerWidth-(c?d:0)},children:(0,i.jsx)(W,{model:e,columns:u,shownTrackIds:s,selection:l})}),c?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.ResizeHandle,{vertical:!0,onDrag:e=>a.setPanelWidth(d-e),className:t.resizeHandle}),(0,i.jsx)("div",{style:{width:d,overflow:"auto"},children:(0,i.jsx)(A,{model:e,rows:r,columns:u})})]}):null]})]})}),G=(0,a.observer)(function(e){let{handleClose:t}=e;return(0,i.jsx)(n.Dialog,{open:!0,onClose:t,maxWidth:"xl",title:"Faceted track selector",children:(0,i.jsx)(s.A,{children:(0,i.jsx)($,{...e})})})})}}]);
//# sourceMappingURL=6159.751f5233c3bef97a.js.map