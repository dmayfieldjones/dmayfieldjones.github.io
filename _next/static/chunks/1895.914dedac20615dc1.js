"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1895],{21895:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h});var r=a(25927),s=a(31448),n=a(92766),i=a(54262),l=a(31177),c=a(72471),u=a(38378);class o extends n.BaseFeatureDataAdapter{constructor(){super(...arguments),this.calculatedIntervalTreeMap={}}async getHeader(){let{header:e}=await this.setup();return e}async getMetadata(){let{header:e}=await this.setup();return new s.A({header:e}).getMetadata()}async setupP(e){let{statusCallback:t=()=>{}}=e||{},a=(0,l.openLocation)(this.getConf("vcfLocation"),this.pluginManager),n=await (0,i.fetchAndMaybeUnzip)(a,e),c=[],o={},h=0,p=new TextDecoder("utf8"),f=0;for(;h<n.length;){let e=n.indexOf("\n",h),a=-1===e?n.subarray(h):n.subarray(h,e),r=p.decode(a).trim();if(r){if(r.startsWith("#"))c.push(r);else{let e=r.indexOf("	"),t=r.slice(0,e);o[t]||(o[t]=[]),o[t].push(r)}}f++%1e4==0&&t(`Loading ${Math.floor(h/1e6).toLocaleString("en-US")}/${Math.floor(n.length/1e6).toLocaleString("en-US")} MB`),h=e+1}let d=c.join("\n"),g=new s.A({header:d});return{header:d,intervalTreeMap:Object.fromEntries(Object.entries(o).map(([e,t])=>[e,a=>{if(!this.calculatedIntervalTreeMap[e]){null==a||a("Parsing VCF data");let s=0,n=new r.Ay;for(let a of t){let t=new u.A({variant:g.parseLine(a),parser:g,id:`${this.id}-${e}-${s++}`});n.insert([t.get("start"),t.get("end")],t)}this.calculatedIntervalTreeMap[e]=n}return this.calculatedIntervalTreeMap[e]}]))}}async setup(){return this.vcfFeatures||(this.vcfFeatures=this.setupP().catch(e=>{throw this.vcfFeatures=void 0,e})),this.vcfFeatures}async getRefNames(e={}){let{intervalTreeMap:t}=await this.setup();return Object.keys(t)}getFeatures(e,t={}){return(0,c.ObservableCreate)(async a=>{var r;try{let{start:s,end:n,refName:i}=e,{intervalTreeMap:l}=await this.setup();null===(r=l[i])||void 0===r||r.call(l,t.statusCallback).search([s,n]).forEach(e=>{a.next(e)}),a.complete()}catch(e){a.error(e)}},t.stopToken)}freeResources(){}}o.capabilities=["getFeatures","getRefNames"];let h=o}}]);
//# sourceMappingURL=1895.914dedac20615dc1.js.map