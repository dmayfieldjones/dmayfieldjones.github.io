"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1045],{61045:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var r=a(25927),s=a(92766),l=a(54262),n=a(31177),i=a(72471),c=a(61550),o=a(93818),h=a(89476);class u extends s.BaseFeatureDataAdapter{constructor(){super(...arguments),this.calculatedIntervalTreeMap={}}async loadDataP(e){let{statusCallback:t=()=>{}}=e||{},a=await (0,l.fetchAndMaybeUnzip)((0,n.openLocation)(this.getConf("gffLocation"),this.pluginManager)),s=[],i={},u=new TextDecoder("utf8"),d=0,f=0;for(;d<a.length;){let e=a.indexOf(10,d),r=-1===e?a.subarray(d):a.subarray(d,e),l=u.decode(r).trim();if(l){if(l.startsWith("#"))s.push(l);else if(l.startsWith(">"))break;else{let e=l.indexOf("	"),t=l.slice(0,e);i[t]||(i[t]=""),i[t]+=`${l}
`}}f++%1e4==0&&t(`Loading ${Math.floor(d/1e6).toLocaleString("en-US")}/${Math.floor(a.length/1e6).toLocaleString("en-US")} MB`),d=e+1}let g=Object.fromEntries(Object.entries(i).map(([e,t])=>[e,a=>{if(!this.calculatedIntervalTreeMap[e]){null==a||a("Parsing GFF data");let s=new r.Ay;(0,o.g)(t).flat().map((t,a)=>new c.default({data:(0,h.d)(t),id:`${this.id}-${e}-${a}`})).forEach(e=>s.insert([e.get("start"),e.get("end")],e)),this.calculatedIntervalTreeMap[e]=s}return this.calculatedIntervalTreeMap[e]}]));return{header:s.join("\n"),intervalTreeMap:g}}async loadData(e){return this.gffFeatures||(this.gffFeatures=this.loadDataP(e).catch(e=>{throw this.gffFeatures=void 0,e})),this.gffFeatures}async getRefNames(e={}){let{intervalTreeMap:t}=await this.loadData(e);return Object.keys(t)}async getHeader(e={}){let{header:t}=await this.loadData(e);return t}getFeatures(e,t={}){return(0,i.ObservableCreate)(async a=>{var r;try{let{start:s,end:l,refName:n}=e,{intervalTreeMap:i}=await this.loadData(t);null===(r=i[n])||void 0===r||r.call(i,t.statusCallback).search([s,l]).forEach(e=>{a.next(e)}),a.complete()}catch(e){a.error(e)}},t.stopToken)}freeResources(){}}}}]);
//# sourceMappingURL=1045.69b135bc0937b5b8.js.map