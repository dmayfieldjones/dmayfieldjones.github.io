{"version":3,"file":"static/chunks/9483.cf2ca76830df67ed.js","mappings":"+LAMA,iBAA4B,wBAAsB,CAClD,kBACA,mBAAgB,UAA6B,MAC7C,qBACA,MAA2B,GAAM,EACjC,WAAwB,kBAAY,kCACpC,CAAS,EACT,OACA,SACA,aAA0B,kBAAY,kDACtC,CACA,CACA,eAOA,OANA,aACA,wCAEA,MADA,mBACA,CACA,EAAa,EAEb,YAEA,qBACA,WAAgB,GAAS,oBACzB,gCACA,CACA,qBACA,MACA,WAAgB,GAAS,mBACzB,8DAEA,wBACA,WAAgB,GAAS,oBACzB,MAAe,kBAAY,gBAC3B,CACA,kBAAiC,EACjC,YAAgB,iBAAsB,EACtC,SAAgB,sDAAkE,EAAI,EACtF,MAAe,sBAAgB,WAC/B,6BACA,uCACA,QAAoB,GAAS,oBAK7B,YAJA,OAAgC,kBAAY,sDAC5C,KACA,kBACA,CAAa,IACb,CACA,GACA,aAEA,SAAoC,EAAO,GAAG,UAAe,GAAG,QAAW,GAAG,MAAS,EACvF,YACA,aACA,QACA,YACA,SACA,YACA,CAAiB,CACjB,CACA,YACA,CAAS,GACT,CACA,2CACA,OACA,gBACA,CACA,CACA,iBACA,CACA,gBACA,gBACA,gBACA,iBACA,CACA,MAAe","sources":["webpack://_N_E/./node_modules/@jbrowse/plugin-wiggle/esm/BigWigAdapter/BigWigAdapter.js"],"sourcesContent":["import { BigWig } from '@gmod/bbi';\nimport { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter';\nimport { updateStatus } from '@jbrowse/core/util';\nimport { openLocation } from '@jbrowse/core/util/io';\nimport { ObservableCreate } from '@jbrowse/core/util/rxjs';\nimport { rectifyStats } from '@jbrowse/core/util/stats';\nclass BigWigAdapter extends BaseFeatureDataAdapter {\n    async setupPre(opts) {\n        const { statusCallback = () => { } } = opts || {};\n        const pluginManager = this.pluginManager;\n        const bigwig = new BigWig({\n            filehandle: openLocation(this.getConf('bigWigLocation'), pluginManager),\n        });\n        return {\n            bigwig,\n            header: await updateStatus('Downloading bigwig header', statusCallback, () => bigwig.getHeader(opts)),\n        };\n    }\n    async setup(opts) {\n        if (!this.setupP) {\n            this.setupP = this.setupPre(opts).catch((e) => {\n                this.setupP = undefined;\n                throw e;\n            });\n        }\n        return this.setupP;\n    }\n    async getRefNames(opts) {\n        const { header } = await this.setup(opts);\n        return Object.keys(header.refsByName);\n    }\n    async refIdToName(refId) {\n        var _a;\n        const { header } = await this.setup();\n        return (_a = header.refsByNumber[refId]) === null || _a === void 0 ? void 0 : _a.name;\n    }\n    async getGlobalStats(opts) {\n        const { header } = await this.setup(opts);\n        return rectifyStats(header.totalSummary);\n    }\n    getFeatures(region, opts = {}) {\n        const { refName, start, end } = region;\n        const { bpPerPx = 0, resolution = 1, stopToken, statusCallback = () => { }, } = opts;\n        return ObservableCreate(async (observer) => {\n            const source = this.getConf('source');\n            const resolutionMultiplier = this.getConf('resolutionMultiplier');\n            const { bigwig } = await this.setup(opts);\n            const feats = await updateStatus('Downloading bigwig data', statusCallback, () => bigwig.getFeatures(refName, start, end, {\n                ...opts,\n                basesPerSpan: (bpPerPx / resolution) * resolutionMultiplier,\n            }));\n            for (const data of feats) {\n                if (source) {\n                    data.source = source;\n                }\n                const uniqueId = `${source}:${region.refName}:${data.start}-${data.end}`;\n                data.refName = refName;\n                data.uniqueId = uniqueId;\n                observer.next({\n                    get: (str) => data[str],\n                    id: () => uniqueId,\n                    toJSON: () => data,\n                });\n            }\n            observer.complete();\n        }, stopToken);\n    }\n    async getMultiRegionFeatureDensityStats(_regions) {\n        return {\n            featureDensity: 0,\n        };\n    }\n    freeResources() { }\n}\nBigWigAdapter.capabilities = [\n    'hasResolution',\n    'hasLocalStats',\n    'hasGlobalStats',\n];\nexport default BigWigAdapter;\n"],"names":[],"sourceRoot":"","ignoreList":[0]}