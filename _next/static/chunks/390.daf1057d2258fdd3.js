"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[390],{10390:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ea});var s=a(95155),r=a(12115),n=a(15715),l=a(57926),i=a(48795),o=a(2360),c=a(64534),d=a(19468),p=a(9670),u=a(42718),h=a(3060),m=a(9934),x=a(82182),g=a(66292),f=a(74100),k=a(94029),j=a(70473),v=a(95946),A=a(54102),y=a(59886);let b=(0,f.makeStyles)()(e=>({spacing:{marginBottom:e.spacing(3)}}));function S({trackAdapter:e,trackType:t}){let{classes:a}=b(),{type:r,subadapter:n}=e;return"SNPCoverageAdapter"===r?(0,s.jsxs)(p.A,{className:a.spacing,children:["Selected ",(0,s.jsx)("code",{children:t}),". Using adapter ",(0,s.jsx)("code",{children:r})," with subadapter ",(0,s.jsx)("code",{children:null==n?void 0:n.type}),". Please enter a track name and, if necessary, update the track type."]}):(0,s.jsxs)(p.A,{className:a.spacing,children:["Using adapter ",(0,s.jsx)("code",{children:r})," and guessing track type"," ",(0,s.jsx)("code",{children:t}),". Please enter a track name and, if necessary, update the track type."]})}var w=a(2440),N=a(76710);let T=(0,d.observer)(({model:e})=>{let{trackAdapter:t}=e,{pluginManager:a}=(0,n.getEnv)(e);return(0,s.jsx)(v.A,{value:(null==t?void 0:t.type)!=="UNKNOWN"?null==t?void 0:t.type:"",label:"Adapter type",variant:"outlined",select:!0,fullWidth:!0,onChange:t=>{e.setAdapterHint(t.target.value)},slotProps:{select:{SelectDisplayProps:{"data-testid":"adapterTypeSelect"}}},children:Object.entries(function(e){var t;let a={};for(let s of e){let e=(null===(t=s.adapterMetadata)||void 0===t?void 0:t.category)||"Default";a[e]||(a[e]=[]),a[e].push(s)}return a}(a.getAdapterElements().filter(e=>{var t;return!(null===(t=e.adapterMetadata)||void 0===t?void 0:t.hiddenFromGUI)}))).map(([e,t])=>[(0,s.jsx)(N.A,{children:e},e),t.map(e=>(0,s.jsx)(o.A,{value:e.name,children:e.displayName},e.name))])})}),C=(0,f.makeStyles)()(e=>({spacing:{marginBottom:e.spacing(3)}}));function D({model:e}){let{classes:t}=C();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(p.A,{className:t.spacing,children:["JBrowse was not able to guess the adapter type for this data, but it may be in the list below. If not, you can"," ",(0,s.jsx)(w.A,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer",children:"check for new releases"})," ","of JBrowse to see if they support this data type or"," ",(0,s.jsx)(w.A,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer",children:"file an issue"})," ","and add a feature request for this data type."]}),(0,s.jsx)(T,{model:e})]})}var E=a(15843),I=a(71023),P=a(84762),M=a(78880),W=a(67144),O=a(16614),B=a(99136),F=a(80910),J=a(73816),U=a(53494);let _=(0,f.makeStyles)()(e=>({paper:{display:"flex",flexDirection:"column",padding:e.spacing(1)},card:{marginTop:e.spacing(1)}})),G=(0,d.observer)(function({model:e}){let{classes:t}=_(),[a,n]=(0,r.useState)(""),[l,i]=(0,r.useState)(""),[o,c]=(0,r.useState)(["Name","ID"]),[d,p]=(0,r.useState)(["CDS","exon"]),u=[{label:"Indexing attributes",values:o},{label:"Feature types to exclude",values:d}];return(0,r.useEffect)(()=>{e.setTextIndexingConf({attributes:o,exclude:d})},[e,o,d]),(0,s.jsxs)(P.A,{className:t.paper,children:[(0,s.jsx)(M.A,{children:"Indexing configuration"}),u.map((e,r)=>(0,s.jsx)(W.A,{raised:!0,className:t.card,children:(0,s.jsxs)(O.A,{children:[(0,s.jsx)(M.A,{children:e.label}),(0,s.jsxs)(B.A,{disablePadding:!0,children:[e.values.map((t,a)=>(0,s.jsx)(F.Ay,{disableGutters:!0,children:(0,s.jsx)(v.A,{value:t,slotProps:{input:{endAdornment:(0,s.jsx)(J.A,{position:"end",children:(0,s.jsx)(U.A,{onClick:()=>{let t=e.values.filter((e,t)=>t!==a);0===r?c(t):p(t)},children:(0,s.jsx)(I.A,{})})})}}})},`${t}-${a}`)),(0,s.jsx)(F.Ay,{disableGutters:!0,children:(0,s.jsx)(v.A,{value:0===r?a:l,placeholder:"add new",onChange:e=>{0===r?n(e.target.value):i(e.target.value)},slotProps:{input:{endAdornment:(0,s.jsx)(J.A,{position:"end",children:(0,s.jsx)(U.A,{onClick:()=>{0===r?(c([...o,a]),n("")):(p([...d,l]),i(""))},disabled:0===r?""===a:""===l,"data-testid":"stringArrayAdd-Feat",children:(0,s.jsx)(E.A,{})})})}}})})]})]})},e.label))]})}),R=(0,d.observer)(function({model:e}){let{pluginManager:t}=(0,n.getEnv)(e),{trackType:a}=e,r=t.getTrackElements();return(0,s.jsx)(v.A,{value:a,variant:"outlined",label:"Track type",select:!0,fullWidth:!0,onChange:t=>{e.setTrackType(t.target.value)},slotProps:{select:{SelectDisplayProps:{"data-testid":"trackTypeSelect"}}},children:r.map(({name:e,displayName:t})=>(0,s.jsx)(o.A,{value:e,children:t},e))})}),$=(0,f.makeStyles)()(e=>({spacing:{marginBottom:e.spacing(3)}}));function H(){let{classes:e}=$();return(0,s.jsxs)(p.A,{className:e.spacing,children:["This version of JBrowse cannot display data of this type. It is possible, however, that there is a newer version that can display them. You can"," ",(0,s.jsx)(w.A,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer",children:"check for new releases"})," ","of JBrowse or"," ",(0,s.jsx)(w.A,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer",children:"file an issue"})," ","and add a feature request for this data type."]})}let L=(0,f.makeStyles)()(e=>({spacing:{marginBottom:e.spacing(3)}})),q=(0,d.observer)(function({model:e}){let{classes:t}=L(),[a,i]=(0,r.useState)(!0),o=(0,n.getSession)(e),{trackName:c,unsupported:d,trackAdapter:u,trackType:h,warningMessage:m,adapterHint:x}=e;if((0,r.useEffect)(()=>{""===x&&u&&e.setAdapterHint(u.type)},[x,u,null==u?void 0:u.type,e]),d)return(0,s.jsx)(H,{});if((null==u?void 0:u.type)===j.UNKNOWN)return(0,s.jsx)(D,{model:e});if(!(null==u?void 0:u.type))return(0,s.jsx)(p.A,{children:"Could not recognize this data type."});{let d=(0,n.isSupportedIndexingAdapter)(u.type),{pluginManager:x}=(0,n.getEnv)(e),g=x.evaluateExtensionPoint("Core-addTrackComponent",({model:e})=>(0,s.jsx)(k.AssemblySelector,{session:o,helperText:"Select assembly to add track to",selected:e.assembly,onChange:t=>{e.setAssembly(t)},TextFieldProps:{fullWidth:!0,SelectProps:{SelectDisplayProps:{"data-testid":"assemblyNameSelect"}}}}),{model:e});return(0,s.jsxs)("div",{children:[(0,s.jsx)(S,{trackAdapter:u,trackType:h}),m?(0,s.jsx)(p.A,{color:"warning",children:m}):null,(0,s.jsx)(v.A,{className:t.spacing,label:"trackName",helperText:"A name for this track",fullWidth:!0,value:c,onChange:t=>{e.setTrackName(t.target.value)},slotProps:{htmlInput:{"data-testid":"trackNameInput"}}}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[(0,s.jsx)(T,{model:e}),(0,s.jsx)(R,{model:e}),(0,s.jsx)(r.Suspense,{fallback:null,children:(0,s.jsx)(g,{model:e})})]}),n.isElectron&&d&&(0,s.jsx)(l.A,{children:(0,s.jsx)(A.A,{label:"Index track for text searching?",control:(0,s.jsx)(y.A,{checked:a,onChange:t=>{i(t.target.checked),e.setTextIndexTrack(t.target.checked)}})})}),n.isElectron&&a&&d?(0,s.jsx)(G,{model:e}):null]})}});var z=a(51539);let K=(0,f.makeStyles)()(e=>({paper:{padding:e.spacing(2)},spacer:{height:e.spacing(8)}})),V=(0,d.observer)(function({model:e}){let{classes:t}=K(),a=(0,z.getRoot)(e);return(0,s.jsxs)(P.A,{className:t.paper,children:[(0,s.jsx)(k.FileSelector,{name:"Main file",description:"",location:e.trackData,setLocation:e.setTrackData,setName:e.setTrackName,rootModel:a}),(0,s.jsx)("div",{className:t.spacer}),(0,s.jsx)(k.FileSelector,{name:"Index file",description:"(Optional) The URL of the index file is automatically inferred from the URL of the main file if it is not supplied.",location:e.indexTrackData,setLocation:e.setIndexTrackData,setName:e.setTrackName,rootModel:a})]})}),Y=(0,f.makeStyles)()(e=>({root:{marginTop:e.spacing(1)},stepper:{backgroundColor:e.palette.background.default},button:{marginRight:e.spacing(1)},actionsContainer:{marginTop:e.spacing(10),marginBottom:e.spacing(2)},alertContainer:{padding:`${e.spacing(2)}px 0px ${e.spacing(2)}px 0px`}})),Q=["Enter track data","Confirm track type"],X=(0,d.observer)(function({model:e}){let[t,a]=(0,r.useState)(0),{classes:l}=Y(),{assembly:i,trackAdapter:o,trackData:c,trackName:d,trackType:f}=e;return(0,s.jsx)("div",{className:l.root,children:(0,s.jsx)(u.A,{className:l.stepper,activeStep:t,orientation:"vertical",children:Q.map((r,u)=>(0,s.jsxs)(h.A,{children:[(0,s.jsx)(m.A,{children:r}),(0,s.jsxs)(x.A,{children:[function(t){switch(t){case 0:return(0,s.jsx)(V,{model:e});case 1:return(0,s.jsx)(q,{model:e});default:return(0,s.jsx)(p.A,{children:"Unknown step"})}}(u),(0,s.jsxs)("div",{className:l.actionsContainer,children:[(0,s.jsx)(g.A,{disabled:0===t,className:l.button,onClick:()=>{a(t-1)},children:"Back"}),(0,s.jsx)(g.A,{disabled:function(){switch(t){case 0:return!c;case 1:return!(d&&f&&(null==o?void 0:o.type)&&i);default:return!0}}(),variant:"contained",color:"primary",onClick:()=>{if(t!==Q.length-1)a(t+1);else try{!function({model:e}){var t;let{textIndexTrack:a,trackAdapter:s,view:r}=e,l=(0,n.getSession)(e),i=e.getTrackConfig(Date.now());if((0,n.isSessionWithAddTracks)(l)){if(i&&s){let{trackId:o}=i;l.addTrackConf(i),null===(t=null==r?void 0:r.showTrack)||void 0===t||t.call(r,o),n.isElectron&&a&&(0,n.isSupportedIndexingAdapter)(s.type)&&function({trackId:e,model:t}){let{textIndexingConf:a,trackName:s,assembly:r}=t,{jobsManager:n}=(0,z.getRoot)(t),l=`${s}-index`;n.queueJob({indexingParams:{...a||{attributes:["Name","ID"],exclude:["CDS","exon"]},assemblies:[r],tracks:[e],indexType:"perTrack",name:l,timestamp:new Date().toISOString()},name:l,cancelCallback:()=>n.abortJob()})}({model:e,trackId:o}),e.clearData(),(0,n.isSessionModelWithWidgets)(l)&&l.hideWidget(e)}else throw Error("Failed to add track.\nThe configuration of this file is not currently supported.")}else throw Error("Can't add tracks to this session")}({model:e})}catch(t){(0,n.getSession)(e).notifyError(`${t}`,t)}},className:l.button,"data-testid":"addTrackNextButton",children:t===Q.length-1?"Add":"Next"})]})]})]},r))})})});var Z=a(29543);let ee=(0,f.makeStyles)()({textbox:{width:"100%"},submit:{marginTop:25,marginBottom:100,display:"block"}}),et=(0,d.observer)(function({model:e}){let{classes:t}=ee(),[a,l]=(0,r.useState)(""),[i,o]=(0,r.useState)();return(0,s.jsxs)("div",{children:[i?(0,s.jsx)(k.ErrorMessage,{error:i}):null,(0,s.jsx)(v.A,{multiline:!0,rows:10,value:a,placeholder:"Paste track config or array of track configs in JSON format",variant:"outlined",className:t.textbox,onChange:e=>{l(e.target.value)}}),(0,s.jsx)(g.A,{variant:"contained",className:t.submit,onClick:()=>{try{o(void 0);let t=(0,n.getSession)(e),s=JSON.parse(a),r=Array.isArray(s)?s:[s];(0,n.isSessionWithAddTracks)(t)&&(0,n.isSessionModelWithWidgets)(t)&&((0,Z.transaction)(()=>{for(let e of r)t.addTrackConf(e);for(let t of r)e.view.showTrack(t.trackId);e.clearData()}),t.hideWidget(e))}catch(e){console.error(e),o(e)}},children:"Submit"})]})}),ea=(0,d.observer)(function({model:e}){let[t,a]=(0,r.useState)("Default add track workflow"),d={"Default add track workflow":X,"Add track JSON":et,...Object.fromEntries((0,n.getEnv)(e).pluginManager.getAddTrackWorkflowElements().map(e=>[e.name,e.ReactComponent]))},p=d[t]?t:"Default add track workflow",u=d[p];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.A,{children:[(0,s.jsx)(i.A,{value:p,onChange:e=>{a(e.target.value)},children:Object.keys(d).map(e=>(0,s.jsx)(o.A,{value:e,children:e},e))}),(0,s.jsx)(c.A,{children:"Type of add track workflow"})]}),(0,s.jsx)(r.Suspense,{fallback:null,children:(0,s.jsx)(u,{model:e})})]})})},71023:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(76856),r=a(95155);let n=(0,s.A)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")}}]);
//# sourceMappingURL=390.daf1057d2258fdd3.js.map