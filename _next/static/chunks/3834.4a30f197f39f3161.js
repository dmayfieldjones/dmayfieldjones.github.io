"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3834],{73834:(e,t,l)=>{l.r(t),l.d(t,{default:()=>R});var n=l(95155),i=l(12115),r=l(87723),o=l.n(r),s=l(54262),a=l(55089),c=l(78443),d=l(93929),h=l(97771),m=l(47204),u=l(9561),x=l(19293);let p=(0,h.makeStyles)()({textAreaFont:{fontFamily:"Courier New"}});function j({onClose:e,currLayout:t}){let{classes:l}=p(),[r,o]=(0,i.useState)(""),[s,h]=(0,i.useState)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.A,{children:[(0,n.jsx)(u.A,{children:'Paste CSV or TSV. If a header column is present. First line is a header. If a column called "name" is present, it uses that to connect to IDs in the table, otherwise it uses the first column no.'}),s?(0,n.jsx)(m.ErrorMessage,{error:s}):null,(0,n.jsx)(x.A,{variant:"outlined",multiline:!0,minRows:5,placeholder:"name,population\nHG00098,GBR\nHG00101,GBR\nHG00459,CHS\n...",maxRows:10,fullWidth:!0,value:r,onChange:e=>{o(e.target.value)},slotProps:{input:{classes:{input:l.textAreaFont}}}})]}),(0,n.jsxs)(d.A,{children:[(0,n.jsx)(c.A,{variant:"contained",color:"secondary",onClick:()=>{let l=r.split("\n").map(e=>e.trim()).filter(e=>!!e),n=l[0].split(/[,\t]/gm);if(n.includes("name")){h("");let i=Object.fromEntries(t.map(e=>[e.name,e])),r=Object.fromEntries(l.slice(1).map(e=>{let t=Object.fromEntries(e.split(/[,\t]/gm).map((e,t)=>[n[t],e]));return[t.name,{...t,...i[t.name]}]}));e(t.map(e=>({...e,...r[e.name]})))}else h(Error('No "name" column found on line 1'))},children:"Update rows"}),(0,n.jsx)(c.A,{variant:"contained",color:"primary",onClick:()=>{let l=r.split("\n").map(e=>e.trim()).filter(e=>!!e),n=l[0].split(/[,\t]/gm);if(n.includes("name")){h("");let i=Object.fromEntries(t.map(e=>[e.name,e])),r=Object.fromEntries(l.slice(1).map(e=>{let t=Object.fromEntries(e.split(/[,\t]/gm).map((e,t)=>[n[t],e]));return[t.name,{...t,...i[t.name]}]}));e(t.map(e=>({...r[e.name]})))}else h(Error('No "name" column found on line 1'))},children:"Replace rows"}),(0,n.jsx)(c.A,{variant:"contained",color:"inherit",onClick:()=>{e()},children:"Cancel"})]})]})}function f(){return(0,n.jsxs)(n.Fragment,{children:["Helpful tips",(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:"You can select rows in the table with the checkboxes"}),(0,n.jsx)("li",{children:"Multi-select is enabled with shift-click and control-click"}),(0,n.jsx)("li",{children:'The "Move selected items up/down" can re-arrange subtracks'}),(0,n.jsx)("li",{children:"Sorting the data grid itself can also re-arrange subtracks"}),(0,n.jsx)("li",{children:"Changes are applied when you hit Submit"}),(0,n.jsx)("li",{children:"You can click and drag the dialog box to move it on the screen"}),(0,n.jsx)("li",{children:"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"})]})]})}var g=l(32672),C=l(86298);function b({setCurrLayout:e,currLayout:t}){var l;return(0,n.jsxs)("div",{children:["Create color palette based on...",Object.keys(null!==(l=t[0])&&void 0!==l?l:[]).filter(e=>"name"!==e&&"color"!==e&&"label"!==e&&"id"!==e&&"HP"!==e).map(l=>(0,n.jsx)(c.A,{variant:"contained",color:"inherit",onClick:()=>{let n=new Map;for(let e of t){let t=n.get(e[l]);t?n.set(e[l],t+1):n.set(e[l],1)}let i=Object.fromEntries([...n.entries()].sort((e,t)=>e[1]-t[1]).map((e,t)=>[e[0],g.set1[t]||(0,C.XL)(e[0])]));e(t.map(e=>({...e,color:i[e[l]]})))},children:l},l)),(0,n.jsx)(c.A,{onClick:()=>{e(t.map(e=>({...e,color:void 0})))},children:"Clear colors"})]})}var v=l(51657),w=l.n(v),k=l(27742);let S=(0,h.makeStyles)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function A({rows:e,onChange:t,setSelected:l}){let{classes:r}=S(),{id:o,name:a,label:c,color:d,baseUri:h,HP:u,...x}=e[0],[p,j]=(0,i.useState)({idx:0,field:null});return(0,n.jsx)("div",{style:{height:400,width:"100%"},children:(0,n.jsx)(k.z,{checkboxSelection:!0,disableRowSelectionOnClick:!0,onRowSelectionModelChange:e=>{l(e)},rows:e,rowHeight:25,columnHeaderHeight:33,columns:[{field:"color",headerName:"Color",renderCell:l=>{let{value:i,id:r}=l;return(0,n.jsx)(w(),{color:i||"blue",onChange:l=>{let n=e.find(e=>e.name===r);n&&(n.color=l),t([...e])}})}},{field:"label",headerName:"Name",width:(0,s.measureGridWidth)(e.map(e=>e.label))},...Object.keys(x).map(t=>({field:t,renderCell:({value:e})=>(0,n.jsx)("div",{className:r.cell,children:(0,n.jsx)(m.SanitizedHTML,{html:(0,s.getStr)(e)})}),width:(0,s.measureGridWidth)(e.map(e=>`${e[t]}`))}))],sortModel:[],onSortModelChange:l=>{let n=l[0],i=(p.idx+1)%2,r=n.field||p.field;j({idx:i,field:r}),t(r?[...e].sort((e,t)=>{let l=(0,s.getStr)(e[r]),n=(0,s.getStr)(t[r]);return 1===i?l.localeCompare(n):n.localeCompare(l)}):e)}})})}var y=l(36941),M=l(71024),E=l(77770),H=l(92791);function N(e,t,l=1){let n=t.map(t=>e.findIndex(e=>e.name===t)).sort((e,t)=>e-t),i=0;for(let t of n){let n=Math.max(i,t-l);n>=i&&e.splice(n,0,e.splice(t,1)[0]),i+=1}return e}function O(e,t,l=1){let n=t.map(t=>e.findIndex(e=>e.name===t)).sort((e,t)=>t-e),i=e.length-1;for(let t of n){let n=Math.min(i,t+l);n<=i&&e.splice(n,0,e.splice(t,1)[0]),i-=1}return e}function F({selected:e,onChange:t,rows:l,showTips:r}){let[o,s]=(0,i.useState)(null),[a,d]=(0,i.useState)("blue");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.A,{disabled:!e.length,onClick:e=>{s(e.currentTarget)},children:"Change color of selected items"}),(0,n.jsxs)(c.A,{onClick:()=>{t(N([...l],e))},disabled:!e.length,children:[(0,n.jsx)(M.A,{}),r?"Move selected items up":null]}),(0,n.jsxs)(c.A,{onClick:()=>{t(O([...l],e))},disabled:!e.length,children:[(0,n.jsx)(y.A,{}),r?"Move selected items down":null]}),(0,n.jsxs)(c.A,{onClick:()=>{t(N([...l],e,l.length))},disabled:!e.length,children:[(0,n.jsx)(H.A,{}),r?"Move selected items to top":null]}),(0,n.jsxs)(c.A,{onClick:()=>{t(O([...l],e,l.length))},disabled:!e.length,children:[(0,n.jsx)(E.A,{}),r?"Move selected items to bottom":null]}),(0,n.jsx)(v.ColorPopover,{anchorEl:o,color:a,onChange:n=>{d(n),e.forEach(e=>{let t=l.find(t=>t.name===e);t&&(t.color=n)}),t([...l])},onClose:()=>{s(null)}})]})}let L=function({rows:e,onChange:t,showTips:l}){let[r,o]=(0,i.useState)([]);return(0,n.jsxs)("div",{children:[(0,n.jsx)(F,{selected:r,rows:e,showTips:l,onChange:t}),(0,n.jsx)(A,{rows:e,onChange:t,setSelected:o})]})},G=(0,h.makeStyles)()({content:{minWidth:800},fr:{float:"right",display:"flex",gap:8},textAreaFont:{fontFamily:"Courier New"}});function R({model:e,handleClose:t}){let{classes:l}=G(),{sources:r}=e,[h,m]=(0,i.useState)(!1),[u,x]=(0,i.useState)(r||[]),[p,g]=(0,s.useLocalStorage)("multivariant-showTips",!1);return(0,n.jsx)(o(),{open:!0,onClose:t,maxWidth:"xl",title:"Multi-variant color/arrangement editor",children:h?(0,n.jsx)(j,{currLayout:u,onClose:e=>{e&&x(e),m(!1)}}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.A,{className:l.content,children:[(0,n.jsxs)("div",{className:l.fr,children:[(0,n.jsx)(c.A,{variant:"contained",onClick:()=>{g(!p)},children:p?"Hide tips":"Show tips"}),(0,n.jsx)(c.A,{color:"secondary",variant:"contained",onClick:()=>{m(!h)},children:"Show Bulk row editor"})]}),p?(0,n.jsx)(f,{}):null,(0,n.jsx)("br",{}),(0,n.jsx)(b,{currLayout:u,setCurrLayout:x}),(0,n.jsx)(L,{rows:u,onChange:x,showTips:p})]}),(0,n.jsxs)(d.A,{children:[(0,n.jsx)(c.A,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{e.clearLayout(),x(e.sources||[])},children:"Clear custom settings"}),(0,n.jsx)(c.A,{variant:"contained",color:"secondary",onClick:()=>{t(),x([...e.sources||[]])},children:"Cancel"}),(0,n.jsx)(c.A,{variant:"contained",color:"primary",type:"submit",onClick:()=>{e.setLayout(u),t()},children:"Submit"})]})]})})}}}]);
//# sourceMappingURL=3834.4a30f197f39f3161.js.map