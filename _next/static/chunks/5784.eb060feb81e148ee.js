"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5784],{5504:(e,t)=>{t.UU=function(e){return e.map(e=>`>${e.header}
${e.seq.replaceAll(/(.{1,80})/g,"$1\n").trimEnd()}`).join("\n")}},65784:(e,t,l)=>{l.r(t),l.d(t,{default:()=>$});var r=l(12115),n=l(53394),a=l(47204),o=l(51846),s=l(54262),c=l(5504),i=l(22471),u=l(95155);let m=(0,i.A)((0,u.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"GetApp");var d=l(55089),f=l(9561),h=l(9552),b=l(77311),g=l(19293),p=l(88153),E=l(79201),A=l(17386),C=l(93929),v=l(78443),y=l(21079),w=l.n(y),S=l(38003),q=l(67072);let k=(0,l(97771).makeStyles)()({dialogContent:{width:"80em"},textAreaFont:{fontFamily:"Courier New"},ml:{marginLeft:10}});async function N(e,t){let l=(0,s.getSession)(e),{leftOffset:r,rightOffset:a}=e;if(!r||!a)throw Error("no offsets on model to use for range");if(r.assemblyName!==a.assemblyName)throw Error("not able to fetch sequences from multiple assemblies");let{rpcManager:o,assemblyManager:c}=l,i=r.assemblyName||a.assemblyName||"",u=c.get(i);if(!u)throw Error(`assembly ${i} not found`);let m=(0,n.getConf)(u,["sequence","adapter"]),d="getSequence";return o.call(d,"CoreGetFeatures",{adapterConfig:m,regions:t,sessionId:d})}let $=(0,q.observer)(function({model:e,handleClose:t}){let{classes:l}=k(),[n,i]=(0,r.useState)(),[u,y]=(0,r.useState)(),[q,$]=(0,r.useState)(!1),[x,R]=(0,r.useState)(!1),[F,_]=(0,r.useState)(!1),{leftOffset:U,rightOffset:j}=e,z=void 0===u;(0,r.useEffect)(()=>{let t=new AbortController;return(async()=>{try{let t=e.getSelectedRegions(U,j);if(0===t.length)throw Error("Selected region is out of bounds");let l=await N(e,t);y(l)}catch(e){console.error(e),i(e)}})(),()=>{t.abort()}},[e,U,j]);let L=u?(0,c.UU)(u.map(e=>{let t=e.get("seq"),l=e.get("refName"),r=e.get("start")+1,n=e.get("end"),a=`${l}:${r}-${n}`;if((null==t?void 0:t.length)!==n-r+1)throw Error(`${a} returned ${t.length.toLocaleString()} bases, but should have returned ${(n-r).toLocaleString()}`);return q&&(t=(0,s.reverse)(t)),F&&(t=(0,s.complement)(t)),{header:a+(q?"-rev":"")+(F?"-comp":""),seq:t}})):"",T=!!L&&L.length>1e6;return r.createElement(a.Dialog,{maxWidth:"xl",open:!0,onClose:()=>{t(),e.setOffsets()},title:"Reference sequence"},r.createElement(d.A,null,n?r.createElement(f.A,{color:"error"},`${n}`):z?r.createElement(h.A,null,"Retrieving reference sequence...",r.createElement(b.A,{className:l.ml,size:20,disableShrink:!0})):null,r.createElement(g.A,{"data-testid":"rubberband-sequence",variant:"outlined",multiline:!0,minRows:5,maxRows:10,disabled:T,className:l.dialogContent,fullWidth:!0,value:T?"Reference sequence too large to display, use the download FASTA button":L,slotProps:{input:{readOnly:!0,classes:{input:l.textAreaFont}}}}),r.createElement(p.A,null,r.createElement(E.A,{control:r.createElement(A.A,{value:q,onChange:e=>{$(e.target.checked)}}),label:"Reverse sequence"}),r.createElement(E.A,{control:r.createElement(A.A,{value:F,onChange:e=>{_(e.target.checked)}}),label:"Complement sequence"})),r.createElement(f.A,{style:{margin:10}},'Note: Check both boxes for the "reverse complement"')),r.createElement(C.A,null,r.createElement(v.A,{onClick:()=>{w()(L),R(!0),setTimeout(()=>{R(!1)},500)},disabled:z||!!n||T,color:"primary",startIcon:r.createElement(o.ContentCopy,null)},x?"Copied":"Copy to clipboard"),r.createElement(v.A,{onClick:()=>{(0,S.saveAs)(new Blob([L||""],{type:"text/x-fasta;charset=utf-8"}),"jbrowse_ref_seq.fa")},disabled:z||!!n,color:"primary",startIcon:r.createElement(m,null)},"Download FASTA"),r.createElement(v.A,{onClick:t,variant:"contained"},"Close")))})}}]);
//# sourceMappingURL=5784.eb060feb81e148ee.js.map