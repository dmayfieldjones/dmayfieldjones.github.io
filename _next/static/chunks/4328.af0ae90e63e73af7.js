"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4328],{14328:(e,t,i)=>{i.r(t),i.d(t,{default:()=>c});var a=i(98434),n=i(29269),s=i(15715),r=i(64446),o=i(90806),l=i(31232),d=i(91603),u=i(33057),f=i(70177);class c extends n.BaseFeatureDataAdapter{async configurePre(e){let t=this.getConf("gffGzLocation"),i=this.getConf(["index","indexType"]),n=this.getConf(["index","location"]),s=this.getConf("dontRedispatch")||["chromosome","contig","region"],o=new a.wD({filehandle:(0,r.openLocation)(t,this.pluginManager),csiFilehandle:"CSI"===i?(0,r.openLocation)(n,this.pluginManager):void 0,tbiFilehandle:"CSI"!==i?(0,r.openLocation)(n,this.pluginManager):void 0,chunkCacheSize:0x3200000,renameRefSeqs:e=>e});return{gff:o,dontRedispatch:s,header:await o.getHeader()}}async configurePre2(){return this.configured||(this.configured=this.configurePre().catch(e=>{throw this.configured=void 0,e})),this.configured}async configure(e){let{statusCallback:t=()=>{}}=e||{};return(0,s.updateStatus)("Downloading index",t,()=>this.configurePre2())}async getRefNames(e={}){let{gff:t}=await this.configure(e);return t.getReferenceSequenceNames(e)}async getHeader(e={}){let{gff:t}=await this.configure(e);return t.getHeader()}getFeatures(e,t={}){return(0,l.ObservableCreate)(async i=>{let{gff:a}=await this.configure(t),n=await a.getMetadata();await this.getFeaturesHelper(e,t,n,i,!0)},t.stopToken)}async getFeaturesHelper(e,t,i,a,n,r=e){var l,c;let{statusCallback:h=()=>{}}=t;try{let g=[],{dontRedispatch:p,gff:w}=await this.configure(t);if(await (0,s.updateStatus)("Downloading features",h,()=>w.getLines(e.refName,e.start,e.end,(e,t)=>{g.push(this.parseLine(i.columnNumbers,e,t))})),n&&g.length){let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(let e of g){let t=e.fields[2];if(!p.includes(t)){let t=e.start-1;t<n&&(n=t),e.end>s&&(s=e.end)}}if(s>e.end||n<e.start)return void await this.getFeaturesHelper({...e,start:n,end:s},t,i,a,!1,e)}let H=g.map(e=>(e.fields[8]&&"."!==e.fields[8]?e.fields[8].includes("_lineHash")||(e.fields[8]+=`;_lineHash=${e.lineHash}`):e.fields[8]=`_lineHash=${e.lineHash}`,e.fields.join("	"))).join("\n");for(let e of(0,u.g)(H))for(let t of e){let e=new d.default({data:(0,f.d)(t),id:`${this.id}-offset-${null==(c=null==(l=t.attributes)?void 0:l._lineHash)?void 0:c[0]}`});(0,o.doesIntersect2)(e.get("start"),e.get("end"),r.start,r.end)&&a.next(e)}a.complete()}catch(e){a.error(e)}}parseLine(e,t,i){let a=t.split("	");return{start:+a[e.start-1],end:+a[e.end-1],lineHash:i,fields:a}}freeResources(){}}}}]);
//# sourceMappingURL=4328.af0ae90e63e73af7.js.map