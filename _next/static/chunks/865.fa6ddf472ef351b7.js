"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[865],{50865:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var i=a(16342),n=a(31448),s=a(92766),r=a(54262),o=a(31177),c=a(72471),u=a(38378);class l extends s.BaseFeatureDataAdapter{async configurePre(e){let{statusCallback:t=()=>{}}=e||{},a=this.getConf("vcfGzLocation"),s=this.getConf(["index","location"]),c=this.getConf(["index","indexType"]),u=(0,o.openLocation)(a,this.pluginManager),l="CSI"===c,g=new i.wD({filehandle:u,csiFilehandle:l?(0,o.openLocation)(s,this.pluginManager):void 0,tbiFilehandle:l?void 0:(0,o.openLocation)(s,this.pluginManager),chunkCacheSize:0x3200000}),h=await (0,r.updateStatus)("Downloading index",t,()=>g.getHeader());return{vcf:g,parser:new n.A({header:h})}}async configure(){return this.configured||(this.configured=this.configurePre().catch(e=>{throw this.configured=void 0,e})),this.configured}async getRefNames(e={}){let{vcf:t}=await this.configure();return t.getReferenceSequenceNames(e)}async getHeader(){let{vcf:e}=await this.configure();return e.getHeader()}async getMetadata(){let{parser:e}=await this.configure();return e.getMetadata()}getFeatures(e,t={}){return(0,c.ObservableCreate)(async a=>{let{refName:i,start:n,end:s}=e,{statusCallback:o=()=>{}}=t,{vcf:c,parser:l}=await this.configure();await (0,r.updateStatus)("Downloading variants",o,()=>c.getLines(i,n,s,{lineCallback:(e,t)=>{a.next(new u.A({variant:l.parseLine(e),parser:l,id:`${this.id}-vcf-${t}`}))},...t})),a.complete()},t.stopToken)}async getSources(){let e=this.getConf("samplesTsvLocation");if(""===e.uri||"/path/to/samples.tsv"===e.uri){let{parser:e}=await this.configure();return e.samples.map(e=>({name:e}))}{let t=(await (0,r.fetchAndMaybeUnzipText)((0,o.openLocation)(e,this.pluginManager))).split(/\n|\r\n|\r/),a=t[0].split("	"),{parser:i}=await this.configure(),n=new Set(i.samples);return t.slice(1).map(e=>{let t=e.split("	");return{name:t[0],...Object.fromEntries(t.slice(1).map((e,t)=>[a[t+1],e]))}}).filter(e=>n.has(e.name))}}freeResources(){}}}}]);
//# sourceMappingURL=865.fa6ddf472ef351b7.js.map