"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8998],{8998:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var n=a(98434),i=a(86168),s=a(29269),r=a(15715),o=a(64446),c=a(31232),l=a(14974);class p extends s.BaseFeatureDataAdapter{async configurePre(e){let t=this.getConf("indexType"),a=this.getConf("vcfGzLocationMap")[e],s=this.getConf("indexLocationMap")[e]||{uri:`${a.uri}.${t.toLowerCase()}`},r=(0,o.openLocation)(a,this.pluginManager),c="CSI"===t,l=new n.wD({filehandle:r,csiFilehandle:c?(0,o.openLocation)(s,this.pluginManager):void 0,tbiFilehandle:c?void 0:(0,o.openLocation)(s,this.pluginManager),chunkCacheSize:0x3200000});return{vcf:l,parser:new i.A({header:await l.getHeader()})}}async configure(e,t){let{statusCallback:a=()=>{}}=t||{};return(0,r.updateStatus)("Downloading index",a,()=>this.configurePre(e))}async getRefNames(){return Object.keys(this.getConf("vcfGzLocationMap"))}getFeatures(e,t={}){return(0,c.ObservableCreate)(async a=>{let{refName:n,start:i,end:s}=e,{statusCallback:o=()=>{}}=t,{vcf:c,parser:p}=await this.configure(e.refName,t);await (0,r.updateStatus)("Downloading variants",o,()=>c.getLines(n,i,s,{lineCallback:(e,t)=>{a.next(new l.A({variant:p.parseLine(e),parser:p,id:`${this.id}-vcf-${t}`}))},...t})),a.complete()},t.stopToken)}async getSources(){let e=this.getConf("samplesTsvLocation"),t=Object.keys(this.getConf("vcfGzLocationMap"))[0];if(""===e.uri||"/path/to/samples.tsv"===e.uri){let{parser:e}=await this.configure(t);return e.samples.map(e=>({name:e}))}{let a=(await (0,r.fetchAndMaybeUnzipText)((0,o.openLocation)(e,this.pluginManager))).split(/\n|\r\n|\r/),n=a[0].split("	"),{parser:i}=await this.configure(t),s=new Set(i.samples);return a.slice(1).map(e=>{let t=e.split("	");return{name:t[0],...Object.fromEntries(t.slice(1).map((e,t)=>[n[t+1],e]))}}).filter(e=>s.has(e.name))}}freeResources(){}}}}]);
//# sourceMappingURL=8998.7b23f942ec0b0624.js.map