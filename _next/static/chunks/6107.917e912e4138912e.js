"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6107],{56107:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ee});var r=a(12115),n=a(54262),l=a(70625),s=a(83371),c=a(80583),o=a(74501),i=a(67072),d=a(53394),m=a(9561),p=a(73518),u=a(79643),g=a(74905),f=a(29793),E=a(78443),h=a(99819),k=a(2848),y=a(97771),A=a(47204),v=a(23806),b=a(28254),S=a(19293),N=a(79201),w=a(17386),T=a(77740),x=a(450),C=a(20109),D=a(86307),I=a(53259),M=a(48289),P=a(55023),W=a(60673),O=a(70503),B=a(47821);let U=(0,y.makeStyles)()(e=>({paper:{display:"flex",flexDirection:"column",padding:e.spacing(1)},card:{marginTop:e.spacing(1)}})),j=(0,i.observer)(function({model:e}){let{classes:t}=U(),[a,n]=(0,r.useState)(""),[l,s]=(0,r.useState)(""),[c,o]=(0,r.useState)(["Name","ID"]),[i,d]=(0,r.useState)(["CDS","exon"]),m=[{label:"Indexing attributes",values:c},{label:"Feature types to exclude",values:i}];return(0,r.useEffect)(()=>{e.setTextIndexingConf({attributes:c,exclude:i})},[e,c,i]),r.createElement(C.A,{className:t.paper},r.createElement(D.A,null,"Indexing configuration"),m.map((e,m)=>r.createElement(I.A,{raised:!0,key:e.label,className:t.card},r.createElement(M.A,null,r.createElement(D.A,null,e.label),r.createElement(P.A,{disablePadding:!0},e.values.map((t,a)=>r.createElement(W.Ay,{key:`${t}-${a}`,disableGutters:!0},r.createElement(S.A,{value:t,slotProps:{input:{endAdornment:r.createElement(O.A,{position:"end"},r.createElement(B.A,{onClick:()=>{let t=e.values.filter((e,t)=>t!==a);0===m?o(t):d(t)}},r.createElement(x.A,null)))}}}))),r.createElement(W.Ay,{disableGutters:!0},r.createElement(S.A,{value:0===m?a:l,placeholder:"add new",onChange:e=>{0===m?n(e.target.value):s(e.target.value)},slotProps:{input:{endAdornment:r.createElement(O.A,{position:"end"},r.createElement(B.A,{onClick:()=>{0===m?(o([...c,a]),n("")):(d([...i,l]),s(""))},disabled:0===m?""===a:""===l,"data-testid":"stringArrayAdd-Feat"},r.createElement(T.A,null)))}}})))))))});var F=a(92353);let J=(0,y.makeStyles)()(e=>({spacing:{marginBottom:e.spacing(3)}})),_=(0,i.observer)(({model:e})=>{let{classes:t}=J(),{trackAdapter:a}=e,{pluginManager:l}=(0,n.getEnv)(e);return r.createElement(S.A,{className:t.spacing,value:(null==a?void 0:a.type)!=="UNKNOWN"?null==a?void 0:a.type:"",label:"Adapter type",variant:"outlined",helperText:"Select an adapter type",select:!0,fullWidth:!0,onChange:t=>{e.setAdapterHint(t.target.value)},slotProps:{select:{SelectDisplayProps:{"data-testid":"adapterTypeSelect"}}}},Object.entries(function(e){let t={};return e.forEach(e=>{var a;let r=(null===(a=e.adapterMetadata)||void 0===a?void 0:a.category)||"Default";t[r]||(t[r]=[]),t[r].push(e)}),t}(l.getAdapterElements().filter(e=>{var t;return!(null===(t=e.adapterMetadata)||void 0===t?void 0:t.hiddenFromGUI)}))).map(([e,t])=>[r.createElement(F.A,{key:e},e),t.map(e=>r.createElement(c.A,{key:e.name,value:e.name},e.displayName))]))}),G=(0,y.makeStyles)()(e=>({spacing:{marginBottom:e.spacing(3)}})),$=(0,i.observer)(({model:e})=>{let{classes:t}=G(),{pluginManager:a}=(0,n.getEnv)(e),{trackType:l}=e,s=a.getTrackElements();return r.createElement(S.A,{className:t.spacing,value:l,variant:"outlined",label:"Track type",helperText:"Select track type",select:!0,fullWidth:!0,onChange:t=>{e.setTrackType(t.target.value)},slotProps:{select:{SelectDisplayProps:{"data-testid":"trackTypeSelect"}}}},s.map(({name:e,displayName:t})=>r.createElement(c.A,{key:e,value:e},t)))}),R=(0,y.makeStyles)()(e=>({spacing:{marginBottom:e.spacing(3)}}));function q({trackAdapter:e,trackType:t}){let{classes:a}=R(),{type:n,subadapter:l}=e;return"SNPCoverageAdapter"===n?r.createElement(m.A,{className:a.spacing},"Selected ",r.createElement("code",null,t),". Using adapter ",r.createElement("code",null,n)," with subadapter ",r.createElement("code",null,null==l?void 0:l.type),". Please enter a track name and, if necessary, update the track type."):r.createElement(m.A,{className:a.spacing},"Using adapter ",r.createElement("code",null,n)," and guessing track type"," ",r.createElement("code",null,t),". Please enter a track name and, if necessary, update the track type.")}function L({model:e}){let{classes:t}=R();return r.createElement(r.Fragment,null,r.createElement(m.A,{className:t.spacing},"JBrowse was not able to guess the adapter type for this data, but it may be in the list below. If not, you can"," ",r.createElement(b.A,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer"},"check for new releases")," ","of JBrowse to see if they support this data type or"," ",r.createElement(b.A,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer"},"file an issue")," ","and add a feature request for this data type."),r.createElement(_,{model:e}))}let H=(0,i.observer)(function({model:e}){let{classes:t}=R(),[a,s]=(0,r.useState)(!0),c=(0,n.getSession)(e),{trackName:o,unsupported:i,trackAdapter:d,trackType:p,warningMessage:u,adapterHint:g}=e;if((0,r.useEffect)(()=>{""===g&&d&&e.setAdapterHint(d.type)},[g,d,null==d?void 0:d.type,e]),i)return r.createElement(m.A,{className:t.spacing},"This version of JBrowse cannot display data of this type. It is possible, however, that there is a newer version that can display them. You can"," ",r.createElement(b.A,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer"},"check for new releases")," ","of JBrowse or"," ",r.createElement(b.A,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer"},"file an issue")," ","and add a feature request for this data type.");if((null==d?void 0:d.type)===v.UNKNOWN)return r.createElement(L,{model:e});if(!(null==d?void 0:d.type))return r.createElement(m.A,null,"Could not recognize this data type.");let f=(0,n.isSupportedIndexingAdapter)(d.type);return r.createElement("div",null,r.createElement(q,{trackAdapter:d,trackType:p}),u?r.createElement(m.A,{style:{color:"orange"}},u):null,r.createElement(S.A,{className:t.spacing,label:"trackName",helperText:"A name for this track",fullWidth:!0,value:o,onChange:t=>{e.setTrackName(t.target.value)},slotProps:{htmlInput:{"data-testid":"trackNameInput"}}}),r.createElement(_,{model:e}),r.createElement($,{model:e}),r.createElement(A.AssemblySelector,{session:c,helperText:"Select assembly to add track to",selected:e.assembly,onChange:t=>{e.setAssembly(t)},TextFieldProps:{fullWidth:!0,SelectProps:{SelectDisplayProps:{"data-testid":"assemblyNameSelect"}}}}),n.isElectron&&f&&r.createElement(l.A,null,r.createElement(N.A,{label:"Index track for text searching?",control:r.createElement(w.A,{checked:a,onChange:t=>{s(t.target.checked),e.setTextIndexTrack(t.target.checked)}})})),n.isElectron&&a&&f?r.createElement(j,{model:e}):null)}),z=(0,y.makeStyles)()(e=>({paper:{padding:e.spacing(2)},spacer:{height:e.spacing(8)}})),K=(0,i.observer)(function({model:e}){let{classes:t}=z(),a=(0,k.getRoot)(e);return r.createElement(C.A,{className:t.paper},r.createElement(A.FileSelector,{name:"Main file",description:"",location:e.trackData,setLocation:e.setTrackData,setName:e.setTrackName,rootModel:a}),r.createElement("div",{className:t.spacer}),r.createElement(A.FileSelector,{name:"Index file",description:"(Optional) The URL of the index file is automatically inferred from the URL of the main file if it is not supplied.",location:e.indexTrackData,setLocation:e.setIndexTrackData,setName:e.setTrackName,rootModel:a}))}),V=(0,y.makeStyles)()(e=>({root:{marginTop:e.spacing(1)},stepper:{backgroundColor:e.palette.background.default},button:{marginRight:e.spacing(1)},actionsContainer:{marginTop:e.spacing(10),marginBottom:e.spacing(2)},alertContainer:{padding:`${e.spacing(2)}px 0px ${e.spacing(2)}px 0px`}})),Y=["Enter track data","Confirm track type"],Q=(0,i.observer)(function({model:e}){let[t,a]=(0,r.useState)(0),{classes:l}=V(),{jobsManager:s}=(0,k.getRoot)(e),c=(0,n.getSession)(e),{assembly:o,trackAdapter:i,trackData:y,trackName:A,trackType:v,textIndexTrack:b,textIndexingConf:S}=e,[N,w]=(0,r.useState)();async function T(){var r,l;if(t!==Y.length-1){a(t+1);return}let m=[`${A.toLowerCase().replaceAll(" ","_")}-${Date.now()}`,c.adminMode?"":"-sessionTrack"].join(""),p=c.assemblyManager.get(o);if(!(0,n.isSessionWithAddTracks)(c)){w("Unable to add tracks to this model");return}if(p&&i&&"UNKNOWN"!==i.type){if(c.addTrackConf({trackId:m,type:v,name:A,assemblyNames:[o],adapter:{...i,sequenceAdapter:(0,d.getConf)(p,["sequence","adapter"])}}),null===(l=(r=e.view).showTrack)||void 0===l||l.call(r,m),n.isElectron&&b&&(0,n.isSupportedIndexingAdapter)(i.type)){let e=`${A}-index`,t={indexingParams:{...S||{attributes:["Name","ID"],exclude:["CDS","exon"]},assemblies:[o],tracks:[m],indexType:"perTrack",name:e,timestamp:new Date().toISOString()},name:e,cancelCallback:()=>s.abortJob()};s.queueJob(t)}e.clearData(),(0,n.isSessionModelWithWidgets)(c)&&c.hideWidget(e)}else w("Failed to add track.\nThe configuration of this file is not currently supported.")}return r.createElement("div",{className:l.root},r.createElement(p.A,{className:l.stepper,activeStep:t,orientation:"vertical"},Y.map((n,s)=>r.createElement(u.A,{key:n},r.createElement(g.A,null,n),r.createElement(f.A,null,function(t){switch(t){case 0:return r.createElement(K,{model:e});case 1:return r.createElement(H,{model:e});default:return r.createElement(m.A,null,"Unknown step")}}(s),r.createElement("div",{className:l.actionsContainer},r.createElement(E.A,{disabled:0===t,onClick:()=>{w(void 0),a(t-1)},className:l.button},"Back"),r.createElement(E.A,{disabled:function(){switch(t){case 0:return!y;case 1:return!(A&&v&&(null==i?void 0:i.type)&&o);default:return!0}}(),variant:"contained",color:"primary",onClick:T,className:l.button,"data-testid":"addTrackNextButton"},t===Y.length-1?"Add":"Next")),N?r.createElement("div",{className:l.alertContainer},r.createElement(h.A,{severity:"error"},N)):null)))))}),X=(0,y.makeStyles)()({textbox:{width:"100%"},submit:{marginTop:25,marginBottom:100,display:"block"}}),Z=(0,i.observer)(function({model:e}){let{classes:t}=X(),[a,l]=(0,r.useState)(""),[s,c]=(0,r.useState)();return r.createElement("div",null,s?r.createElement(A.ErrorMessage,{error:s}):null,r.createElement(S.A,{multiline:!0,rows:10,value:a,onChange:e=>{l(e.target.value)},placeholder:"Paste track config or array of track configs in JSON format",variant:"outlined",className:t.textbox}),r.createElement(E.A,{variant:"contained",className:t.submit,onClick:()=>{try{c(void 0);let t=(0,n.getSession)(e),r=JSON.parse(a),l=Array.isArray(r)?r:[r];(0,n.isSessionWithAddTracks)(t)&&(0,n.isSessionModelWithWidgets)(t)&&(l.forEach(e=>{t.addTrackConf(e)}),l.forEach(t=>e.view.showTrack(t.trackId)),e.clearData(),t.hideWidget(e))}catch(e){console.error(e),c(e)}}},"Submit"))}),ee=(0,i.observer)(function({model:e}){let[t,a]=(0,r.useState)("Default add track workflow"),i={"Default add track workflow":Q,"Add track JSON":Z,...Object.fromEntries((0,n.getEnv)(e).pluginManager.getAddTrackWorkflowElements().map(e=>[e.name,e.ReactComponent]))},d=i[t]?t:"Default add track workflow",m=i[d];return r.createElement(r.Fragment,null,r.createElement(l.A,null,r.createElement(s.A,{value:d,onChange:e=>{a(e.target.value)}},Object.keys(i).map(e=>r.createElement(c.A,{key:e,value:e},e))),r.createElement(o.A,null,"Type of add track workflow")),r.createElement(r.Suspense,{fallback:null},r.createElement(m,{model:e})))})},450:(e,t,a)=>{a.d(t,{A:()=>l});var r=a(22471),n=a(95155);let l=(0,r.A)((0,n.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")}}]);
//# sourceMappingURL=6107.917e912e4138912e.js.map