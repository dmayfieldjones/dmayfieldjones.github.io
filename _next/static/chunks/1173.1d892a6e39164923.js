"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1173],{61173:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h});var s=a(40488),n=a(98434),i=a(29269),r=a(15715),o=a(64446),c=a(31232),u=a(64294),l=a(72796);class d extends i.BaseFeatureDataAdapter{constructor(e,t,a){super(e,t,a);let i=this.getConf("bedGzLocation"),r=this.getConf(["index","indexType"]),c=this.getConf(["index","location"]),u=this.getConf("autoSql"),l=this.pluginManager;this.bed=new n.wD({filehandle:(0,o.openLocation)(i,l),csiFilehandle:"CSI"===r?(0,o.openLocation)(c,l):void 0,tbiFilehandle:"CSI"!==r?(0,o.openLocation)(c,l):void 0,chunkCacheSize:0x3200000}),this.columnNames=this.getConf("columnNames"),this.scoreColumn=this.getConf("scoreColumn"),this.parser=new s.A({autoSql:u})}async getRefNames(e={}){return this.bed.getReferenceSequenceNames(e)}async getHeader(e){return this.bed.getHeader(e)}async getMetadataPre2(e){return this.setupP||(this.setupP=this.getMetadataPre().catch(e=>{throw this.setupP=void 0,e})),this.setupP}async getMetadataPre(){return{meta:await this.bed.getMetadata()}}async getMetadata(e){let{statusCallback:t=()=>{}}=e||{};return(0,r.updateStatus)("Downloading index",t,()=>this.getMetadataPre2(e))}async getNames(){if(this.columnNames.length)return this.columnNames;let e=(await this.getHeader()).split(/\n|\r\n|\r/).filter(e=>!!e).at(-1);return(null==e?void 0:e.includes("	"))?e.slice(1).split("	").map(e=>e.trim()):void 0}getFeatures(e,t){let{stopToken:a,statusCallback:s=()=>{}}=t||{};return(0,c.ObservableCreate)(async t=>{let{meta:n}=await this.getMetadata(),{columnNumbers:i}=n,o=i.ref-1,c=i.start-1,d=i.end-1,h=await this.getNames(),p=performance.now();(0,u.checkStopToken)(a),await (0,r.updateStatus)("Downloading features",s,()=>this.bed.getLines(e.refName,e.start,e.end,{lineCallback:(e,s)=>{performance.now()-p>200&&((0,u.checkStopToken)(a),p=performance.now()),t.next(new r.SimpleFeature((0,l.dE)({line:e,colRef:o,colStart:c,colEnd:d,scoreColumn:this.scoreColumn,parser:this.parser,uniqueId:`${this.id}-${s}`,names:h})))},stopToken:a})),t.complete()},a)}freeResources(){}}d.capabilities=["getFeatures","getRefNames"];let h=d}}]);
//# sourceMappingURL=1173.1d892a6e39164923.js.map